{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../src/Animation/AnimationManager.ts","webpack:///../src/Animation/CommandDispatch.ts","webpack:///../src/Animation/Commands.ts","webpack:///../src/Animation/Key.ts","webpack:///../src/Animation/Track.ts","webpack:///../src/Animation/TrackInstance.ts","webpack:///../src/Behaviour/AnimatedTexture.ts","webpack:///../src/Behaviour/BasicControl.ts","webpack:///../src/Behaviour/Behaviour.ts","webpack:///../src/Behaviour/BehaviourManager.ts","webpack:///../src/Behaviour/CutScene.ts","webpack:///../src/Behaviour/CutSceneControl.ts","webpack:///../src/Behaviour/CutSceneHelper.ts","webpack:///../src/Behaviour/CutSceneTR4.ts","webpack:///../src/Behaviour/DynamicLight.ts","webpack:///../src/Behaviour/Fade.ts","webpack:///../src/Behaviour/FadeUniformColor.ts","webpack:///../src/Behaviour/Lara.ts","webpack:///../src/Behaviour/Light.ts","webpack:///../src/Behaviour/MakeLayeredMesh.ts","webpack:///../src/Behaviour/MuzzleFlash.ts","webpack:///../src/Behaviour/Ponytail.ts","webpack:///../src/Behaviour/PulsingLight.ts","webpack:///../src/Behaviour/RemoveObject.ts","webpack:///../src/Behaviour/ScrollTexture.ts","webpack:///../src/Behaviour/SetAnimation.ts","webpack:///../src/Behaviour/Sky.ts","webpack:///../src/Behaviour/Skydome.ts","webpack:///../src/Behaviour/Sprite.ts","webpack:///../src/Behaviour/UVRotate.ts","webpack:///../src/Behaviour/Zbias.ts","webpack:///../src/ConfigManager.ts","webpack:///../src/Constants.ts","webpack:///../src/Loading/LevelConverter.ts","webpack:///../src/Loading/LevelConverterHelper.ts","webpack:///../src/Loading/LevelDescription/TR1.ts","webpack:///../src/Loading/LevelDescription/TR1Tub.ts","webpack:///../src/Loading/LevelDescription/TR2.ts","webpack:///../src/Loading/LevelDescription/TR3.ts","webpack:///../src/Loading/LevelDescription/TR4.ts","webpack:///../src/Loading/LevelLoader.ts","webpack:///../src/Loading/MasterLoader.ts","webpack:///../src/Main.ts","webpack:///../src/Player/Basis.ts","webpack:///../src/Player/Braid.ts","webpack:///../src/Player/Layer.ts","webpack:///../src/Player/MaterialManager.ts","webpack:///../src/Player/ObjectManager.ts","webpack:///../src/Player/Play.ts","webpack:///../src/Player/Sequence.ts","webpack:///../src/Player/Skeleton.ts","webpack:///../src/Player/SystemLight.ts","webpack:///../src/Player/TRLevel.ts","webpack:///../src/Proxy/Engine.ts","webpack:///../src/Proxy/IMesh.ts","webpack:///../src/ShaderManager.ts","webpack:///../src/Utils/BinaryBuffer.ts","webpack:///../src/Utils/Box3.ts","webpack:///../src/Utils/Browser.ts","webpack:///../src/Utils/Misc.ts","webpack:///../src/Utils/Panel.ts","webpack:///../src/Utils/ProgressBar.ts","webpack:///../src/Utils/SkyDome.ts","webpack:///./src/Behaviour/BasicControl.ts","webpack:///./src/Behaviour/ParticleSystem.ts","webpack:///./src/Behaviours.ts","webpack:///./src/Camera.ts","webpack:///./src/Material.ts","webpack:///./src/Mesh.ts","webpack:///./src/MeshBuilder.ts","webpack:///./src/Node.ts","webpack:///./src/Renderer.ts","webpack:///./src/Scene.ts","webpack:///./src/SceneParser.ts","webpack:///./src/Shader.ts","webpack:///./src/ShaderManager.ts","webpack:///./src/TRN.ts","webpack:///external \"BABYLON\"","webpack:///external \"jQuery\"","webpack:///external \"pako\""],"names":[],"mappings":"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CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3D,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3D,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAE3D,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAEtC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtC,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QACtC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3D,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3D,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,C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AC,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YAC/E,GAAG,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YAE/E,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YACpK,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;YACpK,EAAE,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAA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","file":"trn_babylon.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/TRN.ts\");\n","import IGameData from \"../Player/IGameData\";\r\nimport { ObjectManager, MeshList } from \"../Player/ObjectManager\";\r\nimport { MaterialManager } from \"../Player/MaterialManager\";\r\nimport Track from \"../Animation/Track\";\r\nimport TrackInstance from \"../Animation/TrackInstance\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { Commands } from \"./Commands\";\r\nimport CommandDispatch, { CommandDispatchMode } from \"./CommandDispatch\";\r\n\r\nexport class AnimationManager {\r\n\r\n    protected paused: boolean;\r\n    protected gameData: IGameData;\r\n    protected sceneData: any;\r\n    protected matMgr: MaterialManager;\r\n    protected objMgr: ObjectManager;\r\n    protected _commandDispatch: CommandDispatch;\r\n    protected _animatedObjects: MeshList | null;\r\n\r\n    constructor() {\r\n        this.paused = false;\r\n        this.gameData = <any>null;\r\n        this.matMgr = <any>null;\r\n        this.objMgr = <any>null;\r\n        this._commandDispatch = <any>null;\r\n        this._animatedObjects = null;\r\n    }\r\n\r\n    public initialize(gameData: IGameData): void {\r\n        this.gameData = gameData;\r\n        this.sceneData = gameData.sceneData;\r\n        this.matMgr = gameData.matMgr;\r\n        this.objMgr = gameData.objMgr;\r\n\r\n        this._commandDispatch = new CommandDispatch(gameData, gameData.confMgr.trversion);\r\n\r\n        this.makeTracks();\r\n    }\r\n\r\n    public pause(pause: boolean): void {\r\n        this.paused = pause;\r\n    }\r\n\r\n    public makeTracks(): void {\r\n        const animTracks = [];\r\n\r\n        // create one track per animation\r\n        for (let t = 0; t < this.sceneData.animTracks.length; ++t) {\r\n            const track = Track.createTrack(this.sceneData.animTracks[t]);\r\n\r\n            animTracks.push(track);\r\n        }\r\n\r\n        this.sceneData.animTracks = animTracks;\r\n    }\r\n\r\n    public setAnimation(obj: IMesh, animIndex: number, desynchro: boolean = false): TrackInstance | null {\r\n        const data = this.sceneData.objects[obj.name],\r\n              track = this.sceneData.animTracks[animIndex + data.animationStartIndex],\r\n              trackInstance = track ? new TrackInstance(track, data.skeleton) : null;\r\n\r\n        if (trackInstance) {\r\n            trackInstance.setNextTrackInstance(trackInstance, track.nextTrackFrame);\r\n\r\n            trackInstance.runForward(desynchro ? Math.random() * track.getLength() : 0);\r\n            trackInstance.interpolate();\r\n\r\n            data.trackInstance = trackInstance;\r\n            data.prevTrackInstance = data.trackInstance;\r\n            data.prevTrackInstanceFrame = 0;\r\n        }\r\n\r\n        return trackInstance;\r\n    }\r\n\r\n    public setAnimatedObjects(objs: { [name: string]: IMesh }): void {\r\n        const meshes: Array<IMesh> = [];\r\n        this._animatedObjects = { 0: meshes };\r\n        for (const name in objs) {\r\n            meshes.push(objs[name]);\r\n        }\r\n    }\r\n\r\n    public animateObjects(delta: number): void {\r\n        if (this.paused) {\r\n            return;\r\n        }\r\n\r\n        const animatables = this._animatedObjects || this.objMgr.objectList['moveable'];\r\n        let numAnimatedObjects = 0;\r\n\r\n        for (const objID in animatables) {\r\n            const lstObj = animatables[objID] as Array<IMesh>;\r\n\r\n            for (let i = 0; i < lstObj.length; ++i) {\r\n                const obj = lstObj[i],\r\n                      data = this.sceneData.objects[obj.name];\r\n\r\n                if (data.has_anims && data.trackInstance && (obj.visible || this.gameData.isCutscene)) {\r\n                    numAnimatedObjects++;\r\n\r\n                    const nextTrackFrame = data.trackInstance.track.nextTrackFrame;\r\n\r\n                    if (!data.trackInstance.runForward(delta)) {\r\n                        if (data.trackInstance.track.nextTrack == -1) {\r\n                            continue;\r\n                        }\r\n\r\n                        // it's the end of the current track and we are in a cut scene (because animations that are not in a cutscene loop on themselves, and so .runFoward won't return false for them) => we link to the next track\r\n                        let trackInstance = data.trackInstance as TrackInstance,\r\n                            curTrackInstance = trackInstance;\r\n\r\n                        trackInstance = data.allTrackInstances[trackInstance.track.nextTrack];\r\n                        data.trackInstance = trackInstance;\r\n\r\n                        if (trackInstance.track.nextTrack != -1) {\r\n                            trackInstance.setNextTrackInstance(data.allTrackInstances[trackInstance.track.nextTrack], trackInstance.track.nextTrackFrame);\r\n                        }\r\n                        trackInstance.setCurrentFrame(nextTrackFrame + curTrackInstance.param.curFrame - curTrackInstance.track.numFrames);\r\n                    }\r\n\r\n                    if (data.trackInstance != data.prevTrackInstance) {\r\n                        this.processAnimCommands(data.prevTrackInstance, data.prevTrackInstanceFrame, 1e10, obj);\r\n                        this.processAnimCommands(data.trackInstance, nextTrackFrame, data.trackInstance.param.curFrame, obj);\r\n                    } else {\r\n                        const frm1 = data.prevTrackInstanceFrame,\r\n                              frm2 = data.trackInstance.param.curFrame;\r\n\r\n                        if (frm1 > frm2) {\r\n                            // we have looped in the same animation\r\n                            this.processAnimCommands(data.trackInstance, frm1, 1e10, obj);\r\n                            this.processAnimCommands(data.trackInstance, nextTrackFrame, frm2, obj);\r\n                        } else {\r\n                            this.processAnimCommands(data.trackInstance, frm1, frm2, obj);\r\n                        }\r\n                    }\r\n\r\n                    data.visible = obj.visible;\r\n\r\n                    data.prevTrackInstance = data.trackInstance;\r\n                    data.prevTrackInstanceFrame = data.trackInstance.param.curFrame;\r\n\r\n                    data.trackInstance.interpolate();\r\n\r\n                    const boundingBox = data.trackInstance.track.keys[data.trackInstance.param.curKey].boundingBox;\r\n\r\n                    obj.setBoundingBox(boundingBox);\r\n\r\n                    if (data.layer) {\r\n                        data.layer.update();\r\n                        data.layer.setBoundingObjects();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.gameData.numAnimatedObjects = numAnimatedObjects;\r\n    }\r\n\r\n    // Undo animation commands that have been done up to the 'futureFrame' point in time\r\n    public undoAnimCommands(futureFrame: number, objects: { [name: string]: IMesh }): void {\r\n        this._commandDispatch.startUndoMode();\r\n\r\n        for (let objID in objects) {\r\n            const obj = objects[objID],\r\n                  data = this.sceneData.objects[obj.name],\r\n                  allTrackInstances = data.allTrackInstances as { [id: number] : TrackInstance };\r\n\r\n            let trackInstance = data.trackInstance as TrackInstance;\r\n            let frame = 0, nextTrackFrame = 0;\r\n\r\n            while (frame < futureFrame) {\r\n                if (frame - nextTrackFrame + trackInstance.track.numFrames >= futureFrame) {\r\n                    this.processAnimCommands(trackInstance, nextTrackFrame, futureFrame - frame + nextTrackFrame, obj, CommandDispatchMode.UNDO);\r\n                    break;\r\n                }\r\n\r\n                this.processAnimCommands(trackInstance, nextTrackFrame, trackInstance.track.numFrames, obj, CommandDispatchMode.UNDO);\r\n\r\n                frame += trackInstance.track.numFrames;\r\n\r\n                if (trackInstance.track.nextTrack == -1) {\r\n                    break;\r\n                }\r\n\r\n                nextTrackFrame = trackInstance.track.nextTrackFrame;\r\n\r\n                trackInstance = allTrackInstances[trackInstance.track.nextTrack];\r\n            }\r\n        }\r\n\r\n        this._commandDispatch.endUndoMode();\r\n    }\r\n\r\n    // replay animations up to 'futureFrame' point in time\r\n    public fastForward(futureFrame: number, objects: { [name: string]: IMesh }): void {\r\n        for (let objID in objects) {\r\n            const obj = objects[objID],\r\n                  data = this.sceneData.objects[obj.name],\r\n                  allTrackInstances = data.allTrackInstances as { [id: number] : TrackInstance };\r\n\r\n            let trackInstance = data.trackInstance as TrackInstance;\r\n            let frame = 0, nextTrackFrame = 0;\r\n\r\n            while (frame < futureFrame) {\r\n                if (frame - nextTrackFrame + trackInstance.track.numFrames >= futureFrame) {\r\n                    trackInstance.setCurrentFrame(futureFrame - frame + nextTrackFrame);\r\n                    this.processAnimCommands(trackInstance, nextTrackFrame, futureFrame - frame + nextTrackFrame, obj, CommandDispatchMode.FAST);\r\n                    break;\r\n                }\r\n\r\n                this.processAnimCommands(trackInstance, nextTrackFrame, trackInstance.track.numFrames, obj, CommandDispatchMode.FAST);\r\n\r\n                frame += trackInstance.track.numFrames;\r\n\r\n                if (trackInstance.track.nextTrack == -1) {\r\n                    break;\r\n                }\r\n\r\n                nextTrackFrame = trackInstance.track.nextTrackFrame;\r\n\r\n                trackInstance = allTrackInstances[trackInstance.track.nextTrack];\r\n                data.trackInstance = trackInstance;\r\n\r\n                trackInstance.setCurrentFrame(nextTrackFrame);\r\n                if (trackInstance.track.nextTrack != -1) {\r\n                    trackInstance.setNextTrackInstance(allTrackInstances[trackInstance.track.nextTrack], trackInstance.track.nextTrackFrame);\r\n                }\r\n\r\n                trackInstance.noInterpolationToNextTrack = this.gameData.isCutscene;\r\n            }\r\n\r\n            data.prevTrackInstance = trackInstance;\r\n            data.prevTrackInstanceFrame = data.trackInstance.param.curFrame;\r\n\r\n            trackInstance.interpolate();\r\n\r\n            const boundingBox = trackInstance.track.keys[trackInstance.param.curKey].boundingBox;\r\n\r\n            obj.setBoundingBox(boundingBox);\r\n\r\n            if (data.layer) {\r\n                data.layer.update();\r\n                data.layer.setBoundingObjects();\r\n            }\r\n        }\r\n    }\r\n\r\n    public processAnimCommands(trackInstance: TrackInstance, prevFrame: number, curFrame: number, obj: IMesh, mode: CommandDispatchMode = CommandDispatchMode.NORMAL): void {\r\n        const commands = trackInstance.track.commands;\r\n\r\n        for (let i = 0; i < commands.length; ++i) {\r\n            const command = commands[i];\r\n\r\n            switch (command.cmd) {\r\n\r\n                case Commands.ANIMCMD_MISCACTIONONFRAME: {\r\n\r\n                    const frame = command.params[0] - trackInstance.track.commandsFrameStart, action = command.params[1], customParam = command.params[2];\r\n                    if (frame < prevFrame || frame >= curFrame) { continue; }\r\n\r\n                    //console.log(action,'done for frame',frame,obj.name)\r\n\r\n                    this._commandDispatch.dispatch(action, customParam, obj, mode, trackInstance);\r\n\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import IGameData from \"../Player/IGameData\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { Commands } from \"./Commands\";\r\nimport { ObjectID } from \"../Constants\";\r\nimport { Ponytail } from \"../Behaviour/Ponytail\";\r\nimport { LAYER } from \"../Player/Layer\";\r\nimport { MASK, BONE } from \"../Player/Skeleton\";\r\nimport { DynamicLight } from \"../Behaviour/DynamicLight\";\r\nimport TrackInstance from \"./TrackInstance\";\r\n\r\nexport enum CommandDispatchMode {\r\n    NORMAL = 0,\r\n    UNDO,\r\n    FAST,\r\n    UNDO_END,\r\n}\r\n\r\nexport default class CommandDispatch {\r\n\r\n    protected sceneData: any;\r\n    protected objMgr: any;\r\n    protected dispatchMap: { [id: number]: (action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance) => void };\r\n    protected undoMap: { [id: number]: any };\r\n    protected dynLight: DynamicLight;\r\n\r\n    constructor(public gameData: IGameData, public trversion: string) {\r\n        this.sceneData = gameData.sceneData;\r\n        this.objMgr = gameData.objMgr;\r\n\r\n        gameData.bhvMgr.addBehaviour(\"DynamicLight\");\r\n\r\n        this.dynLight = (gameData.bhvMgr.getBehaviour(\"DynamicLight\") as Array<DynamicLight>)![0];\r\n        this.dynLight.color = [0, 0, 0];\r\n        this.dynLight.fadeout = 4096;\r\n\r\n        this.dispatchMap = {};\r\n        this.undoMap = {};\r\n\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_COLORFLASH]         = this.colorFlash.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_GETLEFTGUN]         = this.getLeftGun.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_GETRIGHTGUN]        = this.getRightGun.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN]        = this.fireLeftGun.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN]       = this.fireRightGun.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_MESHSWAP1]          = this.meshSwap.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_MESHSWAP2]          = this.meshSwap.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_MESHSWAP3]          = this.meshSwap.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_HIDEOBJECT]         = this.hideObject.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_SHOWOBJECT]         = this.showObject.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_DYN_ON]             = this.dynamicLightOn.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_DYN_OFF]            = this.dynamicLightOff.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_RESETHAIR]          = this.resetHair.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION]     = this.customFunction.bind(this);\r\n        this.dispatchMap[Commands.Misc.ANIMCMD_MISC_SETINTERPOLATION]   = this.setInterpolation.bind(this);\r\n    }\r\n\r\n    public startUndoMode(): void {\r\n        this.undoMap = {};\r\n\r\n        for (const id in this.dispatchMap) {\r\n            this.undoMap[id] = {\r\n                \"count\": 0,\r\n                \"firstAction\": -1,\r\n            };\r\n        }\r\n    }\r\n\r\n    public endUndoMode(): void {\r\n        for (const id in this.dispatchMap) {\r\n            this.dispatchMap[id].call(this, parseInt(id), undefined, <any>undefined, CommandDispatchMode.UNDO_END, <any>undefined);\r\n        }\r\n    }\r\n\r\n    public dispatch(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance) {\r\n        const func = this.dispatchMap[action];\r\n\r\n        if (!func) {\r\n            //console.log(`Misc anim command \"${action}\" not implemented`, obj);\r\n        } else {\r\n            func(action, customParam, obj, mode, trackInstance);\r\n        }\r\n    }\r\n\r\n    protected colorFlash(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO_END: {\r\n                break;\r\n            }\r\n\r\n            default: {\r\n                this.gameData.globalTintColor[0] =\r\n                this.gameData.globalTintColor[1] =\r\n                this.gameData.globalTintColor[2] =\r\n                (this.gameData.globalTintColor[0] < 0.5 ? 1.0 : 0.1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected getLeftGun(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO_END: {\r\n                break;\r\n            }\r\n\r\n            default: {\r\n                this.getGun(MASK.LEG_L1, MASK.ARM_L3, obj, trackInstance);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected getRightGun(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO_END: {\r\n                break;\r\n            }\r\n\r\n            default: {\r\n                this.getGun(MASK.LEG_R1, MASK.ARM_R3, obj, trackInstance);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected getGun(maskLeg: number, maskArm: number, obj: IMesh, trackInstance: TrackInstance): void {\r\n        const layer = this.sceneData.objects[obj.name].layer;\r\n\r\n        if (this.trversion == 'TR4') {\r\n            layer.updateMask(LAYER.HOLSTER_EMPTY, maskLeg);\r\n            layer.updateMask(LAYER.HOLSTER_FULL,  maskLeg);\r\n            layer.updateMask(LAYER.WEAPON,        maskArm);\r\n        } else {\r\n            layer.updateMask(LAYER.WEAPON, maskLeg | maskArm);\r\n            layer.updateMask(LAYER.MAIN,   maskLeg | maskArm);\r\n        }\r\n\r\n        layer.setRoom(this.gameData.sceneData.objects[obj.name].roomIndex);\r\n    }\r\n\r\n    protected fireLeftGun(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        if (mode === CommandDispatchMode.NORMAL) {\r\n            this.gameData.bhvMgr.addBehaviour('MuzzleFlash', { \"bone\": BONE.ARM_L3 });\r\n        }\r\n    }\r\n\r\n    protected fireRightGun(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        if (mode === CommandDispatchMode.NORMAL) {\r\n            this.gameData.bhvMgr.addBehaviour('MuzzleFlash', { \"bone\": BONE.ARM_R3 });\r\n        }\r\n    }\r\n\r\n    protected meshSwap(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO_END: {\r\n                break;\r\n            }\r\n\r\n            default: {\r\n                const idx = action - Commands.Misc.ANIMCMD_MISC_MESHSWAP1 + 1;\r\n\r\n                const oswap = this.objMgr.objectList['moveable'][ObjectID['meshswap' + idx]];\r\n\r\n                if (oswap && Array.isArray(oswap)) {\r\n                    const layer = this.sceneData.objects[obj.name].layer;\r\n\r\n                    if (layer.isEmpty(LAYER.MESHSWAP) || layer.getMesh(LAYER.MESHSWAP) != oswap[0]) {\r\n                        layer.setMesh(LAYER.MESHSWAP, oswap[0], 0);\r\n                    }\r\n\r\n                    layer.updateMask(LAYER.MESHSWAP,  MASK.ALL);\r\n                    layer.updateMask(LAYER.MAIN,      MASK.ALL);\r\n\r\n                    layer.setRoom(this.gameData.sceneData.objects[obj.name].roomIndex);\r\n                } else {\r\n                    console.log('Could not apply anim command meshswap (' , action, '): object meshswap' + idx + ' not found.');\r\n                }\r\n\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected hideObject(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO: {\r\n                let counters = this.undoMap[action].counters;\r\n                if (!counters) {\r\n                    counters = {};\r\n                    this.undoMap[action].counters = counters;\r\n                }\r\n                let counter = counters[obj.name];\r\n                if (!counter) {\r\n                    counter = counters[obj.name] = {\r\n                        \"obj\": obj,\r\n                        \"count\": 0,\r\n                        \"firstAction\": -1,\r\n                    };\r\n                }\r\n                counter.count++;\r\n                if (counter.firstAction < 0) {\r\n                    counter.firstAction = 0;\r\n                }\r\n                break;\r\n            }\r\n\r\n            case CommandDispatchMode.UNDO_END: {\r\n                for (const name in this.undoMap[action].counters) {\r\n                    const counter = this.undoMap[action].counters[name];\r\n                    if (counter.count > 0) {\r\n                        counter.obj.visible = counter.firstAction === 0;\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n\r\n            default: {\r\n                obj.visible = false;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected showObject(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO: {\r\n                let counters = this.undoMap[action].counters;\r\n                if (!counters) {\r\n                    counters = {};\r\n                    this.undoMap[action].counters = counters;\r\n                }\r\n                let counter = counters[obj.name];\r\n                if (!counter) {\r\n                    counter = counters[obj.name] = {\r\n                        \"obj\": obj,\r\n                        \"count\": 0,\r\n                        \"firstAction\": -1,\r\n                    };\r\n                }\r\n                counter.count++;\r\n                if (counter.firstAction < 0) {\r\n                    counter.firstAction = 1;\r\n                }\r\n                break;\r\n            }\r\n\r\n            case CommandDispatchMode.NORMAL:\r\n            case CommandDispatchMode.FAST: {\r\n                obj.visible = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected resetHair(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        const ponytail = this.gameData.bhvMgr.getBehaviour(\"Ponytail\") as Array<Ponytail>;\r\n\r\n        if (ponytail && ponytail.length > 0 && mode === CommandDispatchMode.NORMAL) {\r\n            ponytail[0].reset();\r\n            ponytail[0].preWarm();\r\n        }\r\n    }\r\n\r\n    protected dynamicLightOn(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO: {\r\n                this.undoMap[action].count++;\r\n                if (this.undoMap[action].firstAction < 0) {\r\n                    this.undoMap[action].firstAction = 0;\r\n                }\r\n                break;\r\n            }\r\n\r\n            case CommandDispatchMode.UNDO_END: {\r\n                if (this.undoMap[action].count > 0) {\r\n                    this.dynLight.color = this.undoMap[action].firstAction === 0 ? [0, 0, 0] : [2.8, 2.8, 2.8];\r\n                }\r\n                break;\r\n            }\r\n\r\n            default: {\r\n                this.dynLight.color = [2.8, 2.8, 2.8];\r\n                this.dynLight.position = obj.position;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected dynamicLightOff(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO: {\r\n                this.undoMap[Commands.Misc.ANIMCMD_MISC_DYN_ON].count++;\r\n                if (this.undoMap[Commands.Misc.ANIMCMD_MISC_DYN_ON].firstAction < 0) {\r\n                    this.undoMap[Commands.Misc.ANIMCMD_MISC_DYN_ON].firstAction = 1;\r\n                }\r\n                break;\r\n            }\r\n\r\n            case CommandDispatchMode.NORMAL:\r\n            case CommandDispatchMode.FAST: {\r\n                this.dynLight.color = [0, 0, 0];\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected customFunction(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        if (customParam) {\r\n            customParam(action, obj, mode);\r\n        }\r\n    }\r\n\r\n    protected setInterpolation(action: number, customParam: any, obj: IMesh, mode: CommandDispatchMode, trackInstance: TrackInstance): void {\r\n        if (mode === CommandDispatchMode.NORMAL || mode === CommandDispatchMode.FAST) {\r\n            trackInstance.activateInterpolation = customParam as boolean;\r\n        }\r\n    }\r\n}\r\n","export var Commands: any = {\r\n    ANIMCMD_POSITIONREF3: \t\t1,\r\n    ANIMCMD_POSITIONREF2: \t\t2,\r\n    ANIMCMD_SLAVEANIM: \t\t\t3,\r\n    ANIMCMD_DEATHANIM: \t\t\t4,\r\n    ANIMCMD_PLAYSOUNDONFRAME: \t5,\r\n    ANIMCMD_MISCACTIONONFRAME: \t6\r\n};\r\n\r\nCommands.numParams = {\r\n    1:\t3,\r\n    2:\t2,\r\n    3:\t0,\r\n    4:\t0,\r\n    5: \t2,\r\n    6: \t2\r\n};\r\n\r\nCommands.Misc = {\r\n    ANIMCMD_MISC_REVERTCAMERA:                      0,\r\n    ANIMCMD_MISC_SHAKESCREEN_SOFT:                  1,\r\n    ANIMCMD_MISC_UNK6:                              2,\r\n    ANIMCMD_MISC_MAKEBUBBLE:                        3,\r\n    ANIMCMD_MISC_UNK7:                              4,\r\n    ANIMCMD_MISC_UNK13:                             5,\r\n    ANIMCMD_MISC_UNK14:                             6,\r\n    ANIMCMD_MISC_SHAKESCREEN_HARD:                  7,\r\n    ANIMCMD_MISC_GETCROWBAR:                        8,\r\n    ANIMCMD_MISC_REACTIVATEACTIONKEY:               12,\r\n    ANIMCMD_MISC_COLORFLASH:                        13,\r\n    ANIMCMD_MISC_GETRIGHTGUN:                       14,\r\n    ANIMCMD_MISC_GETLEFTGUN:                        15,\r\n    ANIMCMD_MISC_FIRERIGHTGUN:                      16,\r\n    ANIMCMD_MISC_FIRELEFTGUN:                       17,\r\n    ANIMCMD_MISC_MESHSWAP1:                         18,\r\n    ANIMCMD_MISC_MESHSWAP2:                         19,\r\n    ANIMCMD_MISC_MESHSWAP3:\t\t\t\t\t\t\t20,\r\n    ANIMCMD_MISC_HIDEOBJECT:                        21,\r\n    ANIMCMD_MISC_SHOWOBJECT:                        22,\r\n    ANIMCMD_MISC_DYN_ON:                            23,\r\n    ANIMCMD_MISC_DYN_OFF:                           24,\r\n    ANIMCMD_MISC_RESETHAIR:                         26,\r\n    ANIMCMD_MISC_ADDITIONALSOUND1:                  -32736,\r\n    ANIMCMD_MISC_PLAYSTEPSOUND:                     32,\r\n    ANIMCMD_MISC_GETWATERSKIN:                      43,\r\n    ANIMCMD_MISC_PUTBACKWATERSKIN:                  44,\r\n    ANIMCMD_MISC_ADDITIONALSOUND2:                  16416,\r\n\r\n    ANIMCMD_MISC_CUSTOMFUNCTION:                    -1,\r\n    ANIMCMD_MISC_SETINTERPOLATION:                  -2,\r\n};\r\n","import { Position, Quaternion } from \"../Proxy/INode\";\r\nimport { Box3 } from \"../Utils/Box3\";\r\n\r\ninterface KeyData {\r\n    \"position\":     Position;\r\n    \"quaternion\":   Quaternion;\r\n}\r\n\r\nexport default class Key {\r\n\r\n    public data: Array<KeyData>;\r\n\r\n    constructor(public time: number, public boundingBox: Box3) {\r\n        this.data = [];\r\n    }\r\n\r\n    public addData(pos: Position, rot: Quaternion): void {\r\n        this.data.push({\r\n            \"position\": \tpos,\r\n            \"quaternion\":   rot,\r\n        });\r\n    }\r\n}\r\n","import { Box3 } from \"../Utils/Box3\";\r\n\r\nimport Key from \"./Key\";\r\n\r\nexport default class Track {\r\n\r\n    private static _counter: number = 0;\r\n\r\n    public keys: Array<Key>;\r\n    public remainingFrames: number;\r\n    public numDataPerKey: number;\r\n    public commandsFrameStart: number;\r\n    public nextTrack: number;\r\n    public nextTrackFrame: number;\r\n\r\n    private boundingBox: Box3;\r\n    private _commands: Array<any>;\r\n\r\n    public static createTrack(trackJSON: any): Track {\r\n        const keys = trackJSON.keys;\r\n\r\n        const track = new Track(trackJSON.numKeys, trackJSON.numFrames, trackJSON.frameRate, trackJSON.fps, trackJSON.name);\r\n\r\n        track.setNextTrack(trackJSON.nextTrack, trackJSON.nextTrackFrame);\r\n        track.setCommands(trackJSON.commands, trackJSON.frameStart);\r\n\r\n        for (let k = 0; k < keys.length; ++k) {\r\n            const keyJSON = keys[k], dataJSON = keyJSON.data, bbox = keyJSON.boundingBox;\r\n\r\n            const boundingBox = new Box3([bbox.xmin, bbox.ymin, bbox.zmin], [bbox.xmax, bbox.ymax, bbox.zmax]);\r\n\r\n            const key = new Key(keyJSON.time, boundingBox);\r\n\r\n            for (let d = 0; d < dataJSON.length; ++d) {\r\n                key.addData(\r\n                    [dataJSON[d].position.x, dataJSON[d].position.y, dataJSON[d].position.z],\r\n                    [dataJSON[d].quaternion.x, dataJSON[d].quaternion.y, dataJSON[d].quaternion.z, dataJSON[d].quaternion.w]\r\n                );\r\n            }\r\n\r\n            track.addKey(key);\r\n        }\r\n\r\n        return track;\r\n    }\r\n\r\n    constructor(public numKeys: number, public numFrames: number, public frameRate: number, public animFPS: number, public id?: string) {\r\n\r\n        this.nextTrack = 0;\r\n        this.nextTrackFrame = 0;\r\n        this.remainingFrames = numFrames - Math.floor((numFrames - 1) / frameRate) * frameRate;\r\n        this.numDataPerKey = 99999;\r\n        this.boundingBox = new Box3();\r\n        this.commandsFrameStart = 0;\r\n\r\n        if (typeof(id) == 'undefined') {\r\n            this.id = 'track' + (++Track._counter);\r\n        }\r\n\r\n        this.keys = [];\r\n        this._commands = [];\r\n    }\r\n\r\n    get commands(): Array<any> {\r\n        return this._commands;\r\n    }\r\n\r\n    public addKey(key: Key): void {\r\n        this.keys.push(key);\r\n\r\n        this.numDataPerKey = Math.min(this.numDataPerKey, key.data.length);\r\n\r\n        this.boundingBox.union(key.boundingBox);\r\n    }\r\n\r\n    public getLength(): number {\r\n        return this.numFrames / this.animFPS;\r\n    }\r\n\r\n    public setNextTrack(track: number, frame: number): void {\r\n        this.nextTrack = track;\r\n        this.nextTrackFrame = frame;\r\n    }\r\n\r\n    public setCommands(commands: Array<any>, frameStart: number): void {\r\n        this._commands = commands;\r\n        this.commandsFrameStart = frameStart;\r\n    }\r\n\r\n}\r\n","import Engine from \"../Proxy/Engine\";\r\nimport { INode, Position } from \"../Proxy/INode\";\r\n\r\nimport { Skeleton } from \"../Player/Skeleton\";\r\nimport Track from \"./Track\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\ninterface IParam {\r\n    curKey : number;\r\n    curFrame : number;\r\n    interpFactor : number;\r\n    nextKeyIsInCurrentTrack : boolean;\r\n}\r\n\r\nexport default class TrackInstance {\r\n\r\n    public param: IParam;\r\n    public noInterpolationToNextTrack: boolean;\r\n    public activateInterpolation: boolean;\r\n\r\n    private _track: Track;\r\n    private skeleton: Skeleton;\r\n    private overallSpeed: number;\r\n    private nextTrackInstance: TrackInstance;\r\n    private nextTrackInstanceFrame: number;\r\n    private noInterpolationToNextTrackValue: number;\r\n    private interpolatedData: Array<INode>;\r\n    private paramSave: IParam;\r\n\r\n    constructor(track: Track, skeleton: Skeleton) {\r\n\r\n        this._track = track;\r\n        this.skeleton = skeleton;\r\n\r\n        this.overallSpeed = 1.0;\r\n        this.activateInterpolation = true;\r\n\r\n        this.nextTrackInstance = <any>null;\r\n        this.nextTrackInstanceFrame = 0;\r\n\r\n        this.noInterpolationToNextTrack = false;\r\n        this.noInterpolationToNextTrackValue = 0.0;\r\n\r\n        this.interpolatedData = <any>null;\r\n\r\n        this.param = this.paramSave = {\r\n            curKey : 0,\r\n            curFrame : 0.0,\r\n            interpFactor : 0.0,\r\n            nextKeyIsInCurrentTrack : true\r\n        };\r\n\r\n        this.pushState();\r\n    }\r\n\r\n    get track(): Track {\r\n        return this._track;\r\n    }\r\n\r\n    private pushState(): void {\r\n        this.paramSave = jQuery.extend(true, {}, this.param);\r\n    }\r\n\r\n    private popState(): void {\r\n        this.param = jQuery.extend(true, {}, this.paramSave);\r\n    }\r\n\r\n    public setNextTrackInstance(trackInstance: TrackInstance, frame: number): void {\r\n        if (frame >= trackInstance._track.numFrames) {\r\n            frame = 0;\r\n        }\r\n\r\n        this.nextTrackInstance = trackInstance;\r\n        this.nextTrackInstanceFrame = frame;\r\n    }\r\n\r\n    private makeCache(): void {\r\n        this.interpolatedData = [];\r\n        for (let numData = 0; numData < this._track.numDataPerKey; ++numData) {\r\n            this.interpolatedData.push(Engine.makeNode(\"TrackInstance cache node\", Engine.activeScene));\r\n        }\r\n    }\r\n\r\n    public runForward(elapsedTime: number): boolean {\r\n        this.param.curFrame += (elapsedTime * this._track.animFPS) * this.overallSpeed;\r\n\r\n        return this.setCurrentFrame(this.param.curFrame);\r\n    }\r\n\r\n    public setCurrentFrame(frame: number): boolean {\r\n        this.param.curFrame = frame;\r\n\r\n        // Have we reached the end of the animation ?\r\n        if (this.param.curFrame >= this._track.numFrames) {\r\n\r\n            // Yes. Is the next animation not the current one ?\r\n            if (!this.nextTrackInstance || this.nextTrackInstance._track.id != this._track.id) {\r\n\r\n                // Yes. The caller must handle this situation\r\n                const curKey = this.param.curFrame / this._track.frameRate;\r\n\r\n                this.param.interpFactor = this.activateInterpolation ? curKey - Math.floor(curKey) : 0.0;\r\n                this.noInterpolationToNextTrack = false;\r\n\r\n                return false;\r\n            }\r\n\r\n            // The next animation is the current one (looping). Reset internal variables\r\n            this.param.curFrame -= this._track.numFrames;\r\n            this.param.curFrame += this.nextTrackInstanceFrame;\r\n\r\n            // The next test should always fail, but if the frame rate is *very* bad\r\n            // (elapsedTime is huge), it could succeed\r\n            if (this.param.curFrame >= this._track.numFrames) { this.param.curFrame = this._track.numFrames - 1; }\r\n\r\n            this.noInterpolationToNextTrack = false;\r\n        }\r\n\r\n        // Calculate the current key\r\n        const curKey = this.param.curFrame / this._track.frameRate;\r\n\r\n        this.param.curKey = Math.floor(curKey);\r\n\r\n        // Use the next key for the interpolation. Handle the case where the\r\n        // next key is in the next animation and not in the current one\r\n        const nextFrame = Math.floor((this.param.curKey + 1) * this._track.frameRate);\r\n        let speedFactor = 1.0;\r\n\r\n        if (nextFrame < this._track.numFrames || (!this.nextTrackInstance && nextFrame >= this._track.numFrames)) {\r\n            // The key to use for the interpolation is the next one in the current animation\r\n            this.param.nextKeyIsInCurrentTrack = true;\r\n        } else {\r\n            // The next key is in the next animation\r\n            this.param.nextKeyIsInCurrentTrack = false;\r\n\r\n            // speedFactor is used to correctly interpolate the last key of the animation with\r\n            // the first one of the next animation. Indeed, interpolation would fail if the number\r\n            // of frames after the last key of the current animation is not equal to the animation\r\n            // frameRate (which is possible)\r\n            speedFactor = this._track.frameRate / this._track.remainingFrames;\r\n        }\r\n\r\n        this.param.interpFactor = this.activateInterpolation ? (curKey - this.param.curKey) * speedFactor : 0.0;\r\n\r\n        if (!this.param.nextKeyIsInCurrentTrack && this.noInterpolationToNextTrack) {\r\n            if (this.param.curFrame + this.param.interpFactor >= this._track.numFrames) {\r\n                // the interpolation would be done for a frame outside of the current animation,\r\n                // so return false to notify caller to link to the next animation\r\n                this.param.curFrame += this.param.interpFactor;\r\n                return false;\r\n            }\r\n\r\n            this.param.interpFactor = this.noInterpolationToNextTrackValue;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public interpolate(buffer?: Array<INode>, detectRecursInfinite: boolean = false): void {\r\n        this._interpolate(buffer, detectRecursInfinite);\r\n        this.skeleton.updateBoneMatrices();\r\n    }\r\n\r\n    private _interpolate(buffer?: Array<INode>, detectRecursInfinite: boolean = false): void {\r\n        if (!this.interpolatedData) {\r\n            this.makeCache();\r\n        }\r\n\r\n        const curKey = this.param.curKey;\r\n        let internalBuffer = !buffer;\r\n\r\n        if (!buffer) {\r\n            buffer = this.skeleton.bones;\r\n        }\r\n\r\n        if (this.param.nextKeyIsInCurrentTrack || this._track.numKeys == 1 || detectRecursInfinite) {\r\n            let nextKey = curKey + 1;\r\n\r\n            if (nextKey >= this._track.numKeys) { nextKey = this._track.numKeys - 1; }\r\n\r\n            if (detectRecursInfinite && !this.param.nextKeyIsInCurrentTrack && this._track.numKeys != 1) {\r\n                nextKey = this._track.numKeys - 1;\r\n            }\r\n\r\n            for (let numData = 0; numData < this._track.numDataPerKey; ++numData) {\r\n\r\n                const dataCurKey  = this._track.keys[curKey].data[numData];\r\n                const dataNextKey = this._track.keys[nextKey].data[numData];\r\n\r\n                if (!buffer[numData] || !dataCurKey || !dataNextKey) { continue; } // without this line, the lost artifact TR3 levels bug\r\n\r\n                const newpos: Position = [\r\n                    dataCurKey.position[0] + (dataNextKey.position[0] - dataCurKey.position[0]) * this.param.interpFactor,\r\n                    dataCurKey.position[1] + (dataNextKey.position[1] - dataCurKey.position[1]) * this.param.interpFactor,\r\n                    dataCurKey.position[2] + (dataNextKey.position[2] - dataCurKey.position[2]) * this.param.interpFactor\r\n                ];\r\n\r\n                if (internalBuffer) {\r\n                    buffer[numData].setPosition([\r\n                        newpos[0] + this.skeleton.bonesStartingPos[numData].pos_init[0],\r\n                        newpos[1] + this.skeleton.bonesStartingPos[numData].pos_init[1],\r\n                        newpos[2] + this.skeleton.bonesStartingPos[numData].pos_init[2]\r\n                    ]);\r\n                } else {\r\n                    buffer[numData].setPosition(newpos);\r\n                }\r\n\r\n                const q = buffer[numData].quaternion;\r\n                glMatrix.quat.slerp(q, dataCurKey.quaternion, dataNextKey.quaternion, this.param.interpFactor);\r\n                buffer[numData].setQuaternion(q);\r\n            }\r\n        } else {\r\n            this.nextTrackInstance.pushState();\r\n            this.nextTrackInstance.setCurrentFrame(this.nextTrackInstanceFrame);\r\n\r\n            this.nextTrackInstance._interpolate(this.interpolatedData, true);\r\n\r\n            this.nextTrackInstance.popState();\r\n\r\n            for (let numData = 0; numData < this._track.numDataPerKey; ++numData) {\r\n                const dataCurKey  = this._track.keys[curKey].data[numData];\r\n                const dataNextKey = this.interpolatedData[numData];\r\n\r\n                if (!buffer[numData] || !dataCurKey || !dataNextKey) { continue; } // without this line, the lost artifact TR3 levels bug\r\n\r\n                const newpos: Position = [\r\n                    dataCurKey.position[0] + (dataNextKey.position[0] - dataCurKey.position[0]) * this.param.interpFactor,\r\n                    dataCurKey.position[1] + (dataNextKey.position[1] - dataCurKey.position[1]) * this.param.interpFactor,\r\n                    dataCurKey.position[2] + (dataNextKey.position[2] - dataCurKey.position[2]) * this.param.interpFactor\r\n                ];\r\n\r\n                if (internalBuffer) {\r\n                    buffer[numData].setPosition([\r\n                        newpos[0] + this.skeleton.bonesStartingPos[numData].pos_init[0],\r\n                        newpos[1] + this.skeleton.bonesStartingPos[numData].pos_init[1],\r\n                        newpos[2] + this.skeleton.bonesStartingPos[numData].pos_init[2]\r\n                    ]);\r\n                } else {\r\n                    buffer[numData].setPosition(newpos);\r\n                }\r\n\r\n                const q = buffer[numData].quaternion;\r\n                glMatrix.quat.slerp(q, dataCurKey.quaternion, dataNextKey.quaternion, this.param.interpFactor);\r\n                buffer[numData].setQuaternion(q);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { IMaterial } from \"../Proxy/IMaterial\";\r\nimport { TextureList } from \"../Proxy/IScene\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport Sequence from \"../Player/Sequence\";\r\n\r\nexport class AnimatedTexture extends Behaviour {\r\n\r\n    public name: string = AnimatedTexture.name;\r\n\r\n    protected animatedTextures: any;\r\n    protected textures: TextureList;\r\n    protected matList: Array<IMaterial>;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.animatedTextures = gameData.sceneData.animatedTextures;\r\n        this.textures = gameData.sceneData.textures;\r\n        this.matList = <any>null;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (lstObjs == null || lstObjs.length == 0 || !this.animatedTextures) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        // initialize the animated textures\r\n        for (let i = 0; i < this.animatedTextures.length; ++i) {\r\n            const animTexture = this.animatedTextures[i];\r\n            animTexture.progressor = new Sequence(animTexture.animcoords.length, 1.0 / animTexture.animspeed);\r\n        }\r\n\r\n        // collect the materials we will have to update each frame\r\n        const lstMaterials = [];\r\n\r\n        for (let i = 0; i < lstObjs.length; ++i) {\r\n            const obj = lstObjs[i] as IMesh;\r\n\r\n            const materials = obj.materials;\r\n\r\n            for (let m = 0; m < materials.length; ++m) {\r\n                const material = materials[m],\r\n                      userData = material.userData;\r\n\r\n                if (!userData || !userData.animatedTexture) {\r\n                    continue;\r\n                }\r\n\r\n                const animTexture = this.animatedTextures[userData.animatedTexture.idxAnimatedTexture];\r\n\r\n                if (!animTexture.scrolltexture) {\r\n                    lstMaterials.push(material);\r\n                }\r\n            }\r\n        }\r\n\r\n        this.matList = lstMaterials;\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public onFrameStarted(curTime: number, delta: number) {\r\n        for (let i = 0; i < this.animatedTextures.length; ++i) {\r\n            const animTexture = this.animatedTextures[i];\r\n            animTexture.progressor.update(delta);\r\n        }\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number) {\r\n        for (let i = 0; i < this.matList.length; ++i) {\r\n            const material = this.matList[i],\r\n                  userData = material.userData,\r\n                  animTexture = this.animatedTextures[userData.animatedTexture.idxAnimatedTexture],\r\n                  coords = animTexture.animcoords[(animTexture.progressor.currentTile + userData.animatedTexture.pos) % animTexture.animcoords.length];\r\n\r\n            material.uniforms.map.value = this.textures[coords.texture];\r\n            material.uniforms.offsetRepeat.value[0] = coords.minU - userData.animatedTexture.minU;\r\n            material.uniforms.offsetRepeat.value[1] = coords.minV - userData.animatedTexture.minV;\r\n\r\n            material.uniformsUpdated([\"map\", \"offsetRepeat\"]);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(AnimatedTexture);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { Quaternion } from \"../Proxy/INode\";\r\nimport IGameData from \"../Player/IGameData\";\r\n\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\ninterface States {\r\n    [n: number]: {\r\n        state: number,\r\n        on: boolean,\r\n    };\r\n}\r\n\r\ninterface myMap {\r\n    [name: string]: any;\r\n}\r\n\r\nexport class BasicControl extends Behaviour {\r\n\r\n    public name: string = BasicControl.name;\r\n\r\n    protected object: IMesh | null;\r\n    protected domElement: Element;\r\n    protected STATES: myMap;\r\n    protected KEYS: myMap;\r\n    protected states: States;\r\n    protected enabled: boolean;\r\n    protected _captureMouse: boolean;\r\n    protected factor: number;\r\n    protected moveFactor: number;\r\n    protected rotFactor: number;\r\n    protected mouseRotFactor: number;\r\n    protected _mouseX: number;\r\n    protected _mouseY: number;\r\n    protected _mouseDeltaX: number;\r\n    protected _mouseDeltaY: number;\r\n    protected xSign : number;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.STATES = { FASTER: 0, FORWARD: 1, LEFT: 2, RIGHT: 3, BACKWARD: 4, UP: 5, DOWN: 6, ROTY: 7, ROTNY: 8, ROTX: 9, ROTNX: 10, SLOWER: 11 };\r\n        this.KEYS = { MOUSENX: 300, MOUSEX: 301, MOUSENY: 302, MOUSEY: 303 };\r\n        this.enabled = true;\r\n        this._captureMouse = false;\r\n        this.object = null;\r\n        this.xSign = 1;\r\n        this.domElement = <any>null;\r\n\r\n        this.states = {\r\n            16: {state: this.STATES.FASTER,   on: false}, // SHIFT\r\n            17: {state: this.STATES.SLOWER,   on: false}, // CTRL\r\n            90: {state: this.STATES.FORWARD,  on: false}, // Z\r\n            38: {state: this.STATES.FORWARD,  on: false}, // CURSOR UP\r\n            81: {state: this.STATES.LEFT,     on: false}, // Q\r\n            68: {state: this.STATES.RIGHT,    on: false}, // D\r\n            83: {state: this.STATES.BACKWARD, on: false}, // S\r\n            40: {state: this.STATES.BACKWARD, on: false}, // CURSOR DOWN\r\n            32: {state: this.STATES.UP,       on: false}, // SPACE\r\n            88: {state: this.STATES.DOWN,     on: false}, // X\r\n            37: {state: this.STATES.ROTY,     on: false}, // CURSOR LEFT\r\n            39: {state: this.STATES.ROTNY,    on: false}  // CURSOR RIGHT\r\n        };\r\n\r\n        this.states[this.KEYS.MOUSENX] = {state: this.STATES.ROTY,    on: false}; // mouse move -X\r\n        this.states[this.KEYS.MOUSEX]  = {state: this.STATES.ROTNY,   on: false}; // mouse move +X\r\n        this.states[this.KEYS.MOUSENY] = {state: this.STATES.ROTX,    on: false}; // mouse move -Y\r\n        this.states[this.KEYS.MOUSEY]  = {state: this.STATES.ROTNX,   on: false}; // mouse move +Y\r\n\r\n        this.factor = 1.0;\r\n        this.moveFactor = 0;\r\n        this.rotFactor = 0;\r\n        this.mouseRotFactor = 0;\r\n        this._mouseX = -1;\r\n        this._mouseY = -1;\r\n        this._mouseDeltaX = this._mouseDeltaY = 0;\r\n    }\r\n\r\n    get captureMouse(): boolean {\r\n        return this._captureMouse;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n\r\n        if (lstObjs == null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        const domElement = document.body,\r\n              object = lstObjs[0] as IMesh,\r\n              scale = this.nbhv.scale;\r\n\r\n        this.domElement = domElement;\r\n\r\n        this.object = object;\r\n\r\n        this.moveFactor = scale && scale.move ? parseFloat(scale.move) : 6000;\r\n        this.rotFactor = scale && scale.rotation ? parseFloat(scale.rotation) : 100;\r\n        this.mouseRotFactor = scale && scale.mouserotation ? parseFloat(scale.mouserotation) : 10;\r\n\r\n        const prefix = ['', 'webkit', 'moz'];\r\n\r\n        for (let i = 0; i < prefix.length; ++i) {\r\n\r\n            document.addEventListener(prefix[i] + \"pointerlockchange\", this.pointerLockChange.bind(this), false);\r\n            document.addEventListener(prefix[i] + \"pointerlocklost\", this.pointerLockChange.bind(this), false);\r\n\r\n        }\r\n\r\n        this.domElement.addEventListener('contextmenu', function(event: Event) { event.preventDefault(); }, false);\r\n        this.domElement.addEventListener('keydown',    this.keydown.bind(this)    as ((evt: Event) => void), false);\r\n        this.domElement.addEventListener('keyup',      this.keyup.bind(this)      as ((evt: Event) => void), false);\r\n        this.domElement.addEventListener('mousemove',  this.mousemove.bind(this)  as ((evt: Event) => void), false);\r\n        this.domElement.addEventListener('mousedown',  this.mousedown.bind(this)  as ((evt: Event) => void), false);\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    onFrameStarted(curTime: number, delta: number) {\r\n\r\n        if (this.object === null) { return; }\r\n\r\n        let rotX = 0.0, rotY = 0.0, translate = [ 0, 0, 0 ];\r\n\r\n        let moveScale = this.factor * this.moveFactor * delta;\r\n        let rotScale = this.factor * this.rotFactor * delta;\r\n        let rotMouseScale = this.factor * this.mouseRotFactor * delta;\r\n\r\n        for (const state in this.states) {\r\n\r\n            const ostate = this.states[state], isMouse = (state as unknown as number) >= 300;\r\n\r\n            if (!ostate.on) { continue; }\r\n\r\n            switch (ostate.state) {\r\n\r\n                case this.STATES.FASTER:\r\n                    moveScale *= 3;\r\n                    rotScale *= 3;\r\n                    rotMouseScale *= 3;\r\n                    break;\r\n\r\n                case this.STATES.SLOWER:\r\n                    moveScale /= 6;\r\n                    rotScale /= 6;\r\n                    rotMouseScale /= 6;\r\n                    break;\r\n\r\n                case this.STATES.FORWARD:\r\n                    translate[2] = -moveScale * this.xSign;\r\n                    break;\r\n\r\n                case this.STATES.BACKWARD:\r\n                    translate[2] = moveScale * this.xSign;\r\n                    break;\r\n\r\n                case this.STATES.LEFT:\r\n                    translate[0] = -moveScale * this.xSign;\r\n                    break;\r\n\r\n                case this.STATES.RIGHT:\r\n                    translate[0] = moveScale * this.xSign;\r\n                    break;\r\n\r\n                case this.STATES.UP:\r\n                    translate[1] = moveScale;\r\n                    break;\r\n\r\n                case this.STATES.DOWN:\r\n                    translate[1] = -moveScale;\r\n                    break;\r\n\r\n                case this.STATES.ROTY:\r\n                    if (isMouse) {\r\n\r\n                        rotY -= this._mouseDeltaX * rotMouseScale;\r\n\r\n                    } else {\r\n\r\n                        rotY += rotScale;\r\n\r\n                    }\r\n                    break;\r\n\r\n                case this.STATES.ROTNY:\r\n                    if (isMouse) {\r\n\r\n                        rotY -= this._mouseDeltaX * rotMouseScale;\r\n\r\n                    } else {\r\n\r\n                        rotY -= rotScale;\r\n\r\n                    }\r\n                    break;\r\n\r\n                case this.STATES.ROTX:\r\n                    if (isMouse) {\r\n\r\n                        rotX -= this._mouseDeltaY * rotMouseScale;\r\n\r\n                    } else {\r\n\r\n                        rotX += rotScale;\r\n\r\n                    }\r\n                    break;\r\n\r\n                case this.STATES.ROTNX:\r\n                    if (isMouse) {\r\n\r\n                        rotX -= this._mouseDeltaY * rotMouseScale;\r\n\r\n                    } else {\r\n\r\n                        rotX -= rotScale;\r\n\r\n                    }\r\n                    break;\r\n\r\n            }\r\n        }\r\n\r\n        this._mouseDeltaX = this._mouseDeltaY = 0;\r\n\r\n        if (this.states[ this.KEYS.MOUSENX ]) { this.states[ this.KEYS.MOUSENX ].on = false; }\r\n        if (this.states[ this.KEYS.MOUSEX ]) {  this.states[ this.KEYS.MOUSEX ].on  = false; }\r\n        if (this.states[ this.KEYS.MOUSENY ]) { this.states[ this.KEYS.MOUSENY ].on = false; }\r\n        if (this.states[ this.KEYS.MOUSEY ]) {  this.states[ this.KEYS.MOUSEY ].on  = false; }\r\n\r\n        if (rotX == 0 && rotY == 0 && translate[0] == 0 && translate[1] == 0 && translate[2] == 0) {\r\n            return;\r\n        }\r\n\r\n        let q = [ 0, 0, 0, 0 ];\r\n        let quat: Quaternion = this.object.quaternion;\r\n\r\n        glMatrix.quat.setAxisAngle(q, [ 0, 1, 0 ], glMatrix.glMatrix.toRadian(rotY));\r\n        glMatrix.quat.mul(quat, q, quat);\r\n\r\n        let v = [ this.xSign, 0, 0 ];\r\n\r\n        glMatrix.vec3.transformQuat(v, v, quat);\r\n\r\n        glMatrix.quat.setAxisAngle(q, v, glMatrix.glMatrix.toRadian(rotX));\r\n        glMatrix.quat.mul(quat, q, quat);\r\n\r\n        glMatrix.vec3.transformQuat(v, translate, quat);\r\n\r\n        this.object.setQuaternion(quat);\r\n\r\n        let pos = this.object.position;\r\n\r\n        this.object.setPosition([pos[0] + v[0], pos[1] + v[1], pos[2] + v[2]]);\r\n\r\n    }\r\n\r\n    protected pointerLockChange(): void {\r\n\r\n        var locked = document.pointerLockElement == this.domElement;\r\n        this._captureMouse = locked;\r\n\r\n    }\r\n\r\n    protected keydown(event: KeyboardEvent): void {\r\n\r\n        if (this.enabled === false) { return; }\r\n\r\n        if (this.states[event.keyCode]) {\r\n\r\n            this.states[ event.keyCode ].on = true;\r\n\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n        }\r\n\r\n    }\r\n\r\n    protected keyup(event: KeyboardEvent): void {\r\n\r\n        if (this.enabled === false) { return; }\r\n\r\n        if (this.states[ event.keyCode ]) {\r\n\r\n            this.states[ event.keyCode ].on = false;\r\n\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n\r\n        }\r\n\r\n    }\r\n\r\n    protected mousemove(_event: MouseEvent): void {\r\n\r\n        let event: any = _event;\r\n\r\n        if (event.event) { event = event.event; }\r\n\r\n        if (document.pointerLockElement) {\r\n\r\n            const mx = event.movementX/* || event.webkitMovementX || event.mozMovementX || 0*/;\r\n            const my = event.movementY/* || event.webkitMovementY || event.mozMovementY || 0*/;\r\n\r\n            this._mouseDeltaX = mx;\r\n            this._mouseDeltaY = my;\r\n\r\n        } else {\r\n\r\n            if (this.enabled === false || !this._captureMouse) { return; }\r\n\r\n            const curMouseX = event.clientX;\r\n            const curMouseY = event.clientY;\r\n\r\n            this._mouseDeltaX = this._mouseX == -1 ? 0 : curMouseX - this._mouseX;\r\n            this._mouseDeltaY = this._mouseY == -1 ? 0 : curMouseY - this._mouseY;\r\n\r\n            this._mouseX = curMouseX;\r\n            this._mouseY = curMouseY;\r\n\r\n        }\r\n\r\n        if (this.states[this.KEYS.MOUSENX]) { this.states[ this.KEYS.MOUSENX ].on = this._mouseDeltaX < 0; }\r\n        if (this.states[this.KEYS.MOUSEX]) {  this.states[ this.KEYS.MOUSEX ].on  = this._mouseDeltaX > 0; }\r\n        if (this.states[this.KEYS.MOUSENY]) { this.states[ this.KEYS.MOUSENY ].on = this._mouseDeltaY < 0; }\r\n        if (this.states[this.KEYS.MOUSEY]) {  this.states[ this.KEYS.MOUSEY ].on  = this._mouseDeltaY > 0; }\r\n\r\n    }\r\n\r\n    protected mousedown(_event: MouseEvent): void {\r\n\r\n        let event: any = _event;\r\n\r\n        if (event.event) { event = event.event; }\r\n\r\n        if (event.button == 2) {\r\n\r\n            this._captureMouse = !this._captureMouse;\r\n            this._mouseX = -1;\r\n            this._mouseY = -1;\r\n\r\n            if (this._captureMouse) {\r\n\r\n                if (this.domElement.requestPointerLock) {\r\n\r\n                    this.domElement.requestPointerLock();\r\n\r\n                }\r\n\r\n            } else {\r\n\r\n                if (document.exitPointerLock) {\r\n\r\n                    document.exitPointerLock();\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(BasicControl);\r\n","import IGameData from \"../Player/IGameData\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { ICamera } from \"../Proxy/ICamera\";\r\n\r\nexport enum BehaviourRetCode {\r\n    keepBehaviour = 0,\r\n    dontKeepBehaviour\r\n}\r\n\r\nexport abstract class Behaviour {\r\n\r\n    public name: string = \"\";\r\n\r\n    protected nbhv: any;\r\n    protected gameData: IGameData;\r\n    protected objectid: number | undefined;\r\n    protected objecttype: string | undefined;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        this.nbhv = nbhv;\r\n        this.gameData = gameData;\r\n        this.objectid = objectid;\r\n        this.objecttype = objecttype;\r\n    }\r\n\r\n    public abstract init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null];\r\n\r\n    onFrameStarted?(curTime: number, delta: number): void;\r\n    onFrameEnded?(curTime: number, delta: number): void;\r\n\r\n}\r\n","import Utils from \"../Utils/Misc\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { ICamera } from \"../Proxy/ICamera\";\r\nimport { ConfigManager } from \"../ConfigManager\";\r\nimport { ObjectManager, MeshList } from \"../Player/ObjectManager\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\n\r\ntype factory = (nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) => Behaviour;\r\n\r\nexport class BehaviourManager {\r\n\r\n    private static factories: Map<string, typeof Behaviour> = new Map();\r\n\r\n    private behaviours: Array<Behaviour>;\r\n    private behavioursByName: Map<string, Array<Behaviour>>;\r\n    private gameData: IGameData;\r\n    private confMgr: ConfigManager;\r\n    private objMgr: ObjectManager;\r\n\r\n    public static registerFactory(clss: typeof Behaviour): void {\r\n        this.factories.set(clss.name, clss);\r\n    }\r\n\r\n    constructor() {\r\n        this.behaviours = [];\r\n        this.behavioursByName = new Map();\r\n        this.confMgr = <any>null;\r\n        this.objMgr = <any>null;\r\n        this.gameData = <any>null;\r\n    }\r\n\r\n    public initialize(gameData: IGameData): void {\r\n        this.gameData = gameData;\r\n\r\n        this.confMgr = gameData.confMgr;\r\n        this.objMgr = gameData.objMgr;\r\n    }\r\n\r\n    public removeBehaviours(obj: any): void {\r\n        if (obj.__behaviours) {\r\n            obj.__behaviours.forEach((bhv: Behaviour) => this.removeBehaviour(bhv));\r\n\r\n            delete obj.__behaviours;\r\n        }\r\n    }\r\n\r\n    public removeBehaviour(bhv: Behaviour): void {\r\n        let idx = this.behaviours.indexOf(bhv);\r\n        if (idx !== -1) {\r\n            this.behaviours.splice(idx, 1);\r\n        }\r\n\r\n        const lst = this.behavioursByName.get(bhv.name);\r\n        if (lst) {\r\n            idx = lst.indexOf(bhv);\r\n            if (idx !== -1) {\r\n                lst.splice(idx, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    public callFunction(funcname: string, params: Array<any>) {\r\n        for (let i = 0; i < this.behaviours.length; ++i) {\r\n            const bhv = this.behaviours[i];\r\n\r\n            if ((bhv as any)[funcname]) {\r\n                (bhv as any)[funcname].apply(bhv, params);\r\n            }\r\n        }\r\n    }\r\n\r\n    public static callStatic(funcname: string, params: Array<any>): Array<any> {\r\n        const ret = [];\r\n\r\n        for (const [name, clss] of BehaviourManager.factories) {\r\n            if ((clss as any)[funcname]) {\r\n                const r = (clss as any)[funcname].apply(null, params);\r\n                if (Array.isArray(r)) {\r\n                    ret.push(...r);\r\n                }\r\n            }\r\n        }\r\n\r\n        return ret;\r\n    }\r\n\r\n    public static onEngineInitialized(gameData: IGameData): Array<Promise<any>> {\r\n        return BehaviourManager.callStatic(\"onEngineInitialized\", [gameData]);\r\n    }\r\n\r\n    public onBeforeRenderLoop(): void {\r\n        this.callFunction('onBeforeRenderLoop', []);\r\n    }\r\n\r\n    public onFrameStarted(curTime: number, delta: number) {\r\n        this.callFunction('onFrameStarted', [curTime, delta]);\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number) {\r\n        this.callFunction('onFrameEnded', [curTime, delta]);\r\n    }\r\n\r\n    public getBehaviour(name: string): Array<Behaviour> | undefined {\r\n        return this.behavioursByName.get(name);\r\n    }\r\n\r\n    public addBehaviour(name: string, params?: any, objectid?: number, objecttype?: string, _lstObjs?: Array<IMesh>): Array<Promise<void>> | null {\r\n        let lstObjs: Array<IMesh | ICamera> | null = null;\r\n\r\n        if (_lstObjs !== undefined) {\r\n            lstObjs = _lstObjs;\r\n        } else {\r\n            const objList: MeshList | Array<ICamera> | null = objecttype !== undefined ? (objecttype == 'camera' ? [this.gameData.camera] : this.objMgr.objectList[objecttype]) : null;\r\n\r\n            if ((objectid !== undefined || objecttype !== undefined) && (objList === null || objectid === undefined || !objList[objectid])) {\r\n                return null;\r\n            }\r\n\r\n            if (objList && objectid !== undefined && objList[objectid]) {\r\n                const objs = objList[objectid];\r\n                if (!Array.isArray(objs)) {\r\n                    lstObjs = [objs];\r\n                } else {\r\n                    lstObjs = objs;\r\n                }\r\n            }\r\n        }\r\n\r\n        const factory = BehaviourManager.factories.get(name);\r\n\r\n        if (factory === undefined) {\r\n            throw `Can't find a factory to create a behaviour with name ${name}`;\r\n        }\r\n\r\n        const obhv = new (factory as any)(params, this.gameData, objectid, objecttype);\r\n\r\n        const [retCode, promises] = obhv.init(lstObjs);\r\n\r\n        if (retCode == BehaviourRetCode.keepBehaviour) {\r\n            this.behaviours.push(obhv);\r\n\r\n            if (lstObjs) {\r\n                lstObjs.forEach((obj) => {\r\n                    let lbhv = obj.behaviours;\r\n                    if (!lbhv) {\r\n                        lbhv = [];\r\n                        obj.behaviours = lbhv;\r\n                    }\r\n                    lbhv.push(obhv);\r\n                });\r\n            }\r\n\r\n            let blst = this.behavioursByName.get(name);\r\n            if (!blst) {\r\n                blst = [];\r\n                this.behavioursByName.set(name, blst);\r\n            }\r\n            blst.push(obhv);\r\n        }\r\n\r\n        return promises;\r\n    }\r\n\r\n    public loadBehaviours(): Array<Promise<void>> {\r\n        this.behaviours = [];\r\n        this.behavioursByName = new Map();\r\n\r\n        let behaviours = jQuery(this.confMgr.globalParam('behaviour', true)),\r\n            allPromises = this.loadBehavioursSub(behaviours);\r\n\r\n        behaviours = jQuery(this.confMgr.param('behaviour', false, true));\r\n\r\n        allPromises = allPromises.concat(this.loadBehavioursSub(behaviours));\r\n\r\n        return allPromises;\r\n    }\r\n\r\n    private loadBehavioursSub(behaviours: any): Array<Promise<void>> {\r\n        let promises: Array<Promise<void>> = [];\r\n\r\n        for (let bhv = 0; bhv < behaviours.length; ++bhv) {\r\n            let nbhv = behaviours[bhv],\r\n                name = nbhv.getAttribute(\"name\"),\r\n                cutsceneOnly = nbhv.getAttribute(\"cutsceneonly\");\r\n\r\n            if (nbhv.__consumed || BehaviourManager.factories.get(name) === undefined) { continue; }\r\n            if (cutsceneOnly && cutsceneOnly == \"true\" && !this.gameData.isCutscene) { continue; }\r\n\r\n            // get the type and id of the object to apply the behaviour to\r\n            let objectid = nbhv.getAttribute('objectid'),\r\n                objecttype = nbhv.getAttribute('objecttype') || \"moveable\";\r\n\r\n            if (objectid == \"\" || objectid == null) {\r\n                if (!nbhv.parentNode) { continue; }\r\n\r\n                objectid = nbhv.parentNode.getAttribute(\"id\");\r\n                objecttype = objectid ? nbhv.parentNode.nodeName : null;\r\n            }\r\n\r\n            // get overriden data from the level (if any)\r\n            // look first for a <behaviour> tag with the same objectid and objecttype as the current one\r\n            let bhvLevel = objectid ? jQuery(this.confMgr.param('behaviour[name=\"' + name + '\"][objectid=\"' + objectid + '\"]', false, true)) : null;\r\n            if (bhvLevel && bhvLevel.length > 0 && bhvLevel[0] !== nbhv) {\r\n                const tp = bhvLevel[0].getAttribute(\"objecttype\") || \"moveable\";\r\n                if (tp != objecttype) {\r\n                    bhvLevel = null;\r\n                }\r\n            }\r\n            if (!bhvLevel || bhvLevel.length == 0) {\r\n                // not found. Look for a <behaviour> with the same name as the current one and without any of the objectid / objecttype attributes\r\n                bhvLevel = jQuery(this.confMgr.param('behaviour[name=\"' + name + '\"]', false, true));\r\n                if (bhvLevel.length > 0 && bhvLevel[0] !== nbhv) {\r\n                    if (bhvLevel[0].getAttribute(\"objectid\") || bhvLevel[0].getAttribute(\"objecttype\")) {\r\n                        bhvLevel = null;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // merge the data found in the level section (if any)\r\n            nbhv = Utils.domNodeToJSon(nbhv);\r\n\r\n            if (bhvLevel && bhvLevel.length > 0) {\r\n                bhvLevel[0].__consumed = true;\r\n                bhvLevel = Utils.domNodeToJSon(bhvLevel[0]);\r\n                Object.assign(nbhv, bhvLevel);\r\n            }\r\n\r\n            // create the behaviour\r\n            promises = promises.concat(this.addBehaviour(name, nbhv, objectid === null ? undefined : parseInt(objectid), objecttype === null ? undefined : objecttype) || []);\r\n        }\r\n\r\n        return promises;\r\n    }\r\n\r\n}\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { Position, Quaternion } from \"../Proxy/INode\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\nimport { ConfigManager } from \"../ConfigManager\";\r\nimport { AnimationManager } from \"../Animation/AnimationManager\";\r\nimport { ObjectID, baseFrameRate } from \"../Constants\";\r\nimport { MaterialManager } from \"../Player/MaterialManager\";\r\nimport { TRLevel } from \"../Player/TRLevel\";\r\nimport Browser from \"../Utils/Browser\";\r\nimport Misc from \"../Utils/Misc\";\r\nimport TrackInstance from \"../Animation/TrackInstance\";\r\nimport { BasicControl } from \"./BasicControl\";\r\nimport { Lara } from \"./Lara\";\r\nimport { Ponytail } from \"./Ponytail\";\r\nimport CutSceneHelper from \"./CutSceneHelper\";\r\nimport CutSceneTR4 from \"./CutSceneTR4\";\r\nimport CutSceneControl from \"./CutSceneControl\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nconst FRAME_DURATION = 1 / baseFrameRate;\r\n\r\nexport interface CutSceneData {\r\n    \"index\"         : number;\r\n    \"curFrame\"      : number;\r\n    \"frames\"        : any;\r\n    \"position\"      : Position;\r\n    \"quaternion\"    : Quaternion;\r\n    \"sound\"         : any;\r\n    \"soundbuffer\"   : any;\r\n    \"gainNode\"      : any;\r\n    \"objects\"       : any;\r\n}\r\n\r\nexport class CutScene extends Behaviour {\r\n\r\n    public name: string = CutScene.name;\r\n\r\n    private sceneData: any;\r\n    private confMgr: ConfigManager;\r\n    private anmMgr: AnimationManager;\r\n    private objMgr: ObjectManager;\r\n    private bhvMgr: BehaviourManager;\r\n    private matMgr: MaterialManager;\r\n    private trlvl: TRLevel;\r\n    private camera: ICamera;\r\n    private cutscene: CutSceneData;\r\n    private cutSceneEnded: boolean;\r\n    private objects: { [name: string]: IMesh };\r\n    private bhvCtrl: BasicControl;\r\n    private helper: CutSceneHelper;\r\n    private lara: IMesh;\r\n    private control: CutSceneControl;\r\n    private soundStarted: boolean;\r\n    private _volume: number;\r\n    private _volumeSaved: number;\r\n    private _muted: boolean;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.sceneData = gameData.sceneData;\r\n        this.bhvMgr = gameData.bhvMgr;\r\n        this.confMgr = gameData.confMgr;\r\n        this.anmMgr = gameData.anmMgr;\r\n        this.objMgr = gameData.objMgr;\r\n        this.matMgr = gameData.matMgr;\r\n        this.trlvl = gameData.trlvl;\r\n        this.sceneData = gameData.sceneData;\r\n        this.camera = gameData.camera;\r\n        this.cutscene = this.sceneData.cutScene;\r\n        this.cutSceneEnded = false;\r\n        this.objects = {};\r\n        this.bhvCtrl = <any>null;\r\n        this.helper = <any>null;\r\n        this.lara = <any>null;\r\n        this.soundStarted = false;\r\n        this._volume = this._volumeSaved = 0;\r\n        this._muted = false;\r\n\r\n        this.cutscene = {\r\n            \"index\"         : 0,\r\n            \"curFrame\"      : 0,\r\n            \"frames\"        : null,\r\n            \"position\"      : [0, 0, 0],\r\n            \"quaternion\"    : [0, 0, 0, 0],\r\n            \"sound\"         : null,\r\n            \"soundbuffer\"   : null,\r\n            \"gainNode\"      : null,\r\n            \"objects\"       : null,\r\n        };\r\n\r\n        this.control = new CutSceneControl(this, gameData);\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const useAddLights = this.nbhv.useadditionallights === 'true' || this.nbhv.useadditionallights === true,\r\n              index = this.nbhv.index || 0,\r\n              promises: Array<Promise<void>> = [];\r\n\r\n        this.matMgr.useAdditionalLights = useAddLights;\r\n\r\n        this.cutscene.index = index;\r\n\r\n        // set cutscene origin\r\n        this.lara = (this.bhvMgr.getBehaviour(\"Lara\") as Array<Lara>)[0].getObject(); //(this.objMgr.objectList['moveable'][ObjectID.Lara] as Array<IMesh>)[0];\r\n\r\n        this.helper = new CutSceneHelper(this.gameData, this.lara);\r\n\r\n        this.cutscene.frames = this.trlvl.trlevel.cinematicFrames;\r\n        this.cutscene.position = this.lara.position;\r\n\r\n        let laraQuat = this.lara.quaternion,\r\n            laraAngle = this.confMgr.float('behaviour[name=\"Lara\"] > angle');\r\n\r\n        if (laraAngle != -Infinity) {\r\n            const q = glMatrix.quat.create();\r\n            glMatrix.quat.setAxisAngle(q, [0, 1, 0], glMatrix.glMatrix.toRadian(laraAngle));\r\n            laraQuat = q;\r\n        }\r\n\r\n        this.cutscene.quaternion = laraQuat;\r\n\r\n        // update position/quaternion for some specific items when we play a cut scene\r\n        const min = this.confMgr.number('cutscene > animminid', true, -1),\r\n              max = this.confMgr.number('cutscene > animmaxid', true, -1),\r\n              ids: string = this.confMgr.param('cutscene > animids', true),\r\n              oids = new Set().add(ObjectID.Lara),\r\n              moveables = this.objMgr.objectList['moveable'];\r\n\r\n        if (ids) {\r\n            ids.split(\",\").forEach((id) => oids.add(parseInt(id)));\r\n        }\r\n        for (let objID in moveables) {\r\n            const lstObj = moveables[objID] as Array<IMesh>;\r\n\r\n            lstObj.forEach((obj) => {\r\n                const data = this.sceneData.objects[obj.name];\r\n\r\n                if (data.objectid >= min && data.objectid <= max || oids.has(data.objectid)) {\r\n                    obj.setPosition(this.cutscene.position);\r\n                    obj.setQuaternion(this.cutscene.quaternion);\r\n                    if (data.layer) {\r\n                        data.layer.update();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if (index > 0) {\r\n            const tr4Promise = new CutSceneTR4(this.gameData, this.cutscene, this.helper, this.lara).makeTR4Cutscene(parseInt(index));\r\n            promises.push(tr4Promise.then(() => {\r\n                this.objects = this.cutscene.objects;\r\n                //this.anmMgr.setAnimatedObjects(this.objects); // have the animation manager animates all objects and not only the ones from the cutscene, to get correct bounding boxes\r\n                this.registerAnimations();\r\n                this.resetHair();\r\n                this.control.init();\r\n            }));\r\n        } else {\r\n            promises.push(...this.helper.prepareLevel(this.confMgr.trversion, this.confMgr.levelName as string, 0, []));\r\n            promises.push(\r\n                Misc.loadSoundAsync(this.gameData.relpath + this.sceneData.soundPath + this.sceneData.levelShortFileNameNoExt.toUpperCase()).then((ret: any) => {\r\n                    if (!ret || ret.code < 0) {\r\n                        console.log('Error decoding sound data for cutscene.');\r\n                    } else {\r\n                        this.cutscene.sound = ret.sound;\r\n                        this.cutscene.soundbuffer = ret.soundbuffer;\r\n                    }\r\n                })\r\n            );\r\n\r\n            this.makeObjectList();\r\n            this.registerAnimations();\r\n            this.resetHair();\r\n            this.control.init();\r\n        }\r\n\r\n        return [BehaviourRetCode.keepBehaviour, promises];\r\n    }\r\n\r\n    protected resetHair(): void {\r\n        const ponytail = this.bhvMgr.getBehaviour(\"Ponytail\") ? (this.bhvMgr.getBehaviour(\"Ponytail\") as Array<Ponytail>)[0] as Ponytail : null;\r\n        if (ponytail) {\r\n            ponytail.reset();\r\n            ponytail.preWarm();\r\n        }\r\n    }\r\n\r\n    protected makeObjectList(): void {\r\n        const moveables = this.objMgr.objectList['moveable'];\r\n\r\n        this.objects = {};\r\n        for (let objID in moveables) {\r\n            const lstObj = moveables[objID] as Array<IMesh>;\r\n            for (let i = 0; i < lstObj.length; ++i) {\r\n                const obj = lstObj[i],\r\n                      data = this.sceneData.objects[obj.name];\r\n\r\n                if (data.dummy || !data.has_anims || !data.visible) { continue; }\r\n\r\n                this.objects[obj.name] = obj;\r\n            }\r\n        }\r\n    }\r\n\r\n    // register all animations we will need in the cut scene\r\n    protected registerAnimations(): void {\r\n        for (let objID in this.objects) {\r\n            const obj = this.objects[objID],\r\n                  data = this.sceneData.objects[obj.name],\r\n                  registered: any = {},\r\n                  allTrackInstances: any = {};\r\n\r\n            let anmIndex = data.animationStartIndex;\r\n\r\n            while (true) {\r\n                if (anmIndex == -1 || registered[anmIndex]) { break; }\r\n\r\n                registered[anmIndex] = true;\r\n\r\n                const track = this.sceneData.animTracks[anmIndex],\r\n                      trackInstance = new TrackInstance(track, data.skeleton);\r\n\r\n                trackInstance.noInterpolationToNextTrack = true;\r\n\r\n                allTrackInstances[anmIndex] = trackInstance;\r\n\r\n                anmIndex = track.nextTrack;\r\n            }\r\n\r\n            data.allTrackInstances = allTrackInstances;\r\n\r\n            const trackInstance = allTrackInstances[data.animationStartIndex];\r\n\r\n            if (trackInstance.track.nextTrack != -1) {\r\n                trackInstance.setNextTrackInstance(data.allTrackInstances[trackInstance.track.nextTrack], trackInstance.track.nextTrackFrame);\r\n            }\r\n            trackInstance.setNoInterpolationToNextTrack = true;\r\n\r\n            trackInstance.runForward(0);\r\n            trackInstance.interpolate();\r\n\r\n            data.trackInstance = trackInstance;\r\n\r\n            data.prevTrackInstance = data.trackInstance;\r\n            data.prevTrackInstanceFrame = 0;\r\n        }\r\n    }\r\n\r\n    public reset(resetCamera: boolean = true): void {\r\n        // Reset all animations\r\n        this.registerAnimations();\r\n\r\n        this.anmMgr.undoAnimCommands(this.cutscene.curFrame, this.objects);\r\n\r\n        this.cutscene.curFrame = 0;\r\n        this.cutSceneEnded = false;\r\n\r\n        if (resetCamera) {\r\n            this.update(0, 0);\r\n        }\r\n    }\r\n\r\n    get volume(): number {\r\n        return this._volume;\r\n    }\r\n\r\n    set volume(v: number) {\r\n        this._volume = v;\r\n        if (this.cutscene.gainNode) {\r\n            this.cutscene.gainNode.gain.value = v;\r\n        }\r\n    }\r\n\r\n    get muted(): boolean {\r\n        return this._muted;\r\n    }\r\n\r\n    set muted(m: boolean) {\r\n        if (m && this._muted || !m && !this._muted) {\r\n            return;\r\n        }\r\n\r\n        if (m) {\r\n            this._muted = true;\r\n            this._volumeSaved = this._volume;\r\n            this.volume = 0;\r\n        } else {\r\n            this._muted = false;\r\n            this.volume = this._volumeSaved;\r\n        }\r\n    }\r\n\r\n    get duration(): number {\r\n        return this.cutscene.frames.length * FRAME_DURATION;\r\n    }\r\n\r\n    get currentTime(): number {\r\n        return this.cutscene.curFrame * FRAME_DURATION;\r\n    }\r\n\r\n    set currentTime(t: number) {\r\n        this.fastForward(t * baseFrameRate);\r\n    }\r\n\r\n    protected fastForward(futureFrame: number): void {\r\n        this.reset(false);\r\n\r\n        this.anmMgr.fastForward(futureFrame, this.objects);\r\n\r\n        this.cutscene.curFrame = futureFrame;\r\n\r\n        this.update(0, 0); // reset camera\r\n\r\n        this.resetHair();\r\n    }\r\n\r\n    public showController(): void {\r\n        this.control.bindEvents();\r\n    }\r\n\r\n    public stopSound(): void {\r\n        if (this.cutscene.sound) {\r\n            this.cutscene.sound.stop();\r\n        }\r\n    }\r\n\r\n    public startSound(time?: number): void {\r\n        if (this.cutscene.sound) {\r\n            if (!time) {\r\n                time = this.currentTime;\r\n            }\r\n            this.cutscene.sound.stop();\r\n            this.cutscene.sound = Browser.AudioContext.createBufferSource();\r\n            this.cutscene.sound.buffer = this.cutscene.soundbuffer;\r\n            this.cutscene.sound.connect(this.cutscene.gainNode);\r\n            this.cutscene.sound.start(0, time);\r\n        }\r\n    }\r\n\r\n    public onBeforeRenderLoop(): void {\r\n        this.gameData.panel.hide();\r\n\r\n        this.bhvCtrl = (this.bhvMgr.getBehaviour(\"BasicControl\") as Array<Behaviour>)[0] as BasicControl;\r\n    }\r\n\r\n    public onFrameStarted(curTime: number, delta: number): void {\r\n        if (this.cutSceneEnded || this.control.paused) {\r\n            return;\r\n        }\r\n\r\n        if (!this.soundStarted && this.cutscene.sound != null && !this.gameData.singleFrame) {\r\n            this.soundStarted = true;\r\n            this.cutscene.gainNode = Browser.AudioContext.createGain();\r\n            this.volume = this.volume;\r\n            this.cutscene.gainNode.connect(Browser.AudioContext.destination);\r\n            this.cutscene.sound.connect(this.cutscene.gainNode);\r\n            this.cutscene.sound.start();\r\n        }\r\n\r\n        this.update(curTime, delta);\r\n    }\r\n\r\n    protected update(curTime: number, delta: number): void {\r\n        this.cutscene.curFrame += baseFrameRate * delta;\r\n\r\n        this.control.updateTime(this.cutscene.curFrame * FRAME_DURATION);\r\n\r\n        // Update camera\r\n        const t = this.cutscene.curFrame - Math.floor(this.cutscene.curFrame),\r\n              cfrmA = Math.min(Math.floor(this.cutscene.curFrame), this.cutscene.frames.length - 2),\r\n              cfrmB = Math.min(cfrmA + 1, this.cutscene.frames.length - 1);\r\n\r\n        if (cfrmA < this.cutscene.frames.length - 3) {\r\n            if (!this.bhvCtrl.captureMouse) {\r\n                const frm1 = this.cutscene.frames[cfrmA],\r\n                      frm2 = this.cutscene.frames[cfrmB],\r\n                      maxDelta = 512.0 * 512.0,\r\n                      fovMult = 60.0 / 16384.0,\r\n                      rollMult = -90.0 / 16384.0;\r\n\r\n                const eyePos:   Position = [frm1.posX, -frm1.posY, -frm1.posZ],\r\n                      eyePos2:  Position = [frm2.posX, -frm2.posY, -frm2.posZ],\r\n                      lkat:     Position = [frm1.targetX, -frm1.targetY, -frm1.targetZ],\r\n                      lkat2:    Position = [frm2.targetX, -frm2.targetY, -frm2.targetZ];\r\n\r\n                const odp = [0, 0, 0],\r\n                      odt = [0, 0, 0];\r\n\r\n                glMatrix.vec3.sub(odp, eyePos, eyePos2);\r\n                glMatrix.vec3.sub(odt, lkat, lkat2);\r\n\r\n                const dp = glMatrix.vec3.squaredLength(odp),\r\n                      dt = glMatrix.vec3.squaredLength(odt);\r\n\r\n                let fov = frm1.fov * fovMult,\r\n                    roll = frm1.roll * rollMult;\r\n\r\n                if (dp <= maxDelta && dt <= maxDelta) {\r\n                    glMatrix.vec3.lerp(eyePos, eyePos, eyePos2, t);\r\n                    glMatrix.vec3.lerp(lkat, lkat, lkat2, t);\r\n                    fov = Misc.lerp(frm1.fov * fovMult, frm2.fov * fovMult, t);\r\n                    roll = Misc.lerp(frm1.roll * rollMult, frm2.roll * rollMult, t);\r\n                }\r\n\r\n                const q = this.cutscene.quaternion.slice();\r\n\r\n                glMatrix.vec3.transformQuat(lkat, lkat, q);\r\n                glMatrix.vec3.transformQuat(eyePos, eyePos, q);\r\n\r\n                this.camera.fov = fov;\r\n                this.camera.setPosition(eyePos);\r\n                this.camera.lookAt(lkat);\r\n                this.camera.setPosition([this.camera.position[0] + this.cutscene.position[0], this.camera.position[1] + this.cutscene.position[1], this.camera.position[2] + this.cutscene.position[2]]);\r\n\r\n                const qcam = this.camera.quaternion;\r\n\r\n                glMatrix.quat.setAxisAngle(q, [0, 1, 0], glMatrix.glMatrix.toRadian(roll));\r\n                glMatrix.quat.mul(qcam, q, qcam);\r\n\r\n                this.camera.setQuaternion(qcam);\r\n                this.camera.updateProjectionMatrix();\r\n            }\r\n\r\n        } else {\r\n            this.cutSceneEnded = true;\r\n            this.anmMgr.pause(true);\r\n            this.control.finished();\r\n        }\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number): void {\r\n        // Update object lights (only in TR4 cutscenes)\r\n        if (this.cutscene.index <= 0 || this.control.paused) {\r\n            return;\r\n        }\r\n\r\n        for (let objID in this.objects) {\r\n            const obj = this.objects[objID],\r\n                  data = this.sceneData.objects[obj.name];\r\n\r\n            const pos = obj.position;\r\n\r\n            pos[0] += data.skeleton.bones[0].position[0];\r\n            pos[1] += data.skeleton.bones[0].position[1];\r\n            pos[2] += data.skeleton.bones[0].position[2];\r\n\r\n            const roomObj = this.objMgr.getRoomByPos(pos);\r\n\r\n            if (roomObj >= 0 && roomObj != data.roomIndex) {\r\n                this.objMgr.changeRoomMembership(obj, data.roomIndex, roomObj);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nBehaviourManager.registerFactory(CutScene);\r\n","import jQuery from \"jquery\";\r\n\r\nimport { CutScene } from \"./CutScene\";\r\nimport IGameData from \"../Player/IGameData\";\r\n/*\r\n*\r\n** Heavily based on http://www.inwebson.com/html5/custom-html5-video-controls-with-jquery/ by Kenny\r\n*\r\n*/\r\nexport default class CutSceneControl {\r\n\r\n    protected _gameData: IGameData;\r\n    protected _cutscene: CutScene;\r\n    protected _volumeDrag: boolean;\r\n    protected _timeDrag: boolean;\r\n    protected _paused: boolean;\r\n    protected _pausedSave: boolean;\r\n    protected _ended: boolean;\r\n\r\n    constructor(cutscene: CutScene, gameData: IGameData) {\r\n        this._gameData = gameData;\r\n        this._cutscene = cutscene;\r\n        this._volumeDrag = false;\r\n        this._timeDrag = false;\r\n        this._paused = false;\r\n        this._pausedSave = false;\r\n        this._ended = false;\r\n    }\r\n\r\n    public init() {\r\n        jQuery(`<style type=\"text/css\" media=\"all\">@import \"${this._gameData.relpath}resources/css/cccontrol.css\";</style>`).appendTo(jQuery(document.body));\r\n        return fetch(this._gameData.relpath + 'resources/template/cccontrol.html').then((response) => {\r\n            return response.text().then((html) => {\r\n                jQuery(document.body).append(html);\r\n            });\r\n        });\r\n    }\r\n\r\n    get paused(): boolean {\r\n        return this._paused;\r\n    }\r\n\r\n    public bindEvents(): void {\r\n        // Handle showing/clicking on big button to start replay\r\n        jQuery(document.body)\r\n            .append('<div id=\"init\"></div>')\r\n            .on('click', ((obj) => () => {\r\n                jQuery('#init').remove();\r\n                jQuery('.btnPlay').addClass('paused');\r\n                obj.off('click');\r\n                obj.on('click', ((ctrl: CutSceneControl) => {\r\n                    return function(e: any) {\r\n                        if (e.which == 1) {\r\n                            ctrl.playPause();\r\n                        }\r\n                        return false;\r\n                    };\r\n                })(this));\r\n                this.bindControlEvents();\r\n                this._gameData.play.play();\r\n            })(jQuery(document.body)));\r\n\r\n        jQuery('#init').fadeIn(200);\r\n\r\n        // Visibility of the control bar\r\n        jQuery('.control')\r\n            .hover(() => {\r\n                jQuery('.control').stop().animate({ 'bottom': 0 }, 500);\r\n                jQuery('.caption').stop().animate({ 'top': 0 }, 500);\r\n            }, () => {\r\n                if (!this._volumeDrag && !this._timeDrag) {\r\n                    jQuery('.control').stop().animate({ 'bottom': -45 }, 500);\r\n                    jQuery('.caption').stop().animate({ 'top': -45 }, 500);\r\n                }\r\n            }).on('click', function(e) { e.stopPropagation(); return false; });\r\n\r\n        // Set video properties\r\n        jQuery('.current').text(this.timeFormat(0));\r\n        jQuery('.duration').text(this.timeFormat(this._cutscene.duration));\r\n\r\n        this.updateVolume(0, 0.7);\r\n\r\n        // Fullscreen button clicked\r\n        jQuery('.btnFS').on('click', function() {\r\n            if (document.fullscreenElement != null) {\r\n                if (document.exitFullscreen) {\r\n                    document.exitFullscreen();\r\n                }\r\n            } else if (document.body.requestFullscreen) {\r\n                document.body.requestFullscreen();\r\n            }\r\n            return false;\r\n        });\r\n\r\n        // Sound button clicked\r\n        jQuery('.sound').click(((obj) => () => {\r\n            this._cutscene.muted = !this._cutscene.muted;\r\n            obj.toggleClass('muted');\r\n            if (this._cutscene.muted) {\r\n                jQuery('.volumeBar').css('width', 0);\r\n            } else {\r\n                jQuery('.volumeBar').css('width', (this._cutscene.volume * 100) + '%');\r\n            }\r\n            return false;\r\n        })(jQuery('.sound')));\r\n\r\n        // Volume bar event\r\n        jQuery('.volume').on('mousedown', (function(ctrl: CutSceneControl) {\r\n            return function(e: any) {\r\n                ctrl._volumeDrag = true;\r\n                ctrl._cutscene.muted = false;\r\n                jQuery('.sound').removeClass('muted');\r\n                ctrl.updateVolume(e.pageX, 0);\r\n                e.stopPropagation();\r\n                return false;\r\n            };\r\n        })(this)).on('click', function(e) { return false; });\r\n\r\n        jQuery(document).on('mouseup', (function(ctrl: CutSceneControl) {\r\n            return function(e: any) {\r\n                if (ctrl._volumeDrag) {\r\n                    ctrl._volumeDrag = false;\r\n                    ctrl.updateVolume(e.pageX, 0);\r\n                }\r\n        };\r\n        })(this));\r\n\r\n        jQuery(document).on('mousemove', (function(ctrl: CutSceneControl) {\r\n            return function(e: any) {\r\n                if (ctrl._volumeDrag) {\r\n                    ctrl.updateVolume(e.pageX, 0);\r\n                }\r\n            };\r\n        })(this));\r\n\r\n        jQuery('.control').css('display', 'block');\r\n    }\r\n\r\n    protected bindControlEvents(): void {\r\n        const DEMO = {\r\n            INI: {\r\n                MOUSE_IDLE: 3000\r\n            },\r\n            hideMouse: function() {\r\n                jQuery(document.body).css('cursor', 'none');\r\n                jQuery(document.body).on(\"mousemove\", DEMO.waitThenHideMouse);\r\n            },\r\n            waitThenHideMouse: function() {\r\n                jQuery(document.body).css('cursor', 'default');\r\n                jQuery(document.body).off(\"mousemove\", DEMO.waitThenHideMouse);\r\n                setTimeout(DEMO.hideMouse, DEMO.INI.MOUSE_IDLE);\r\n            },\r\n            showMouse: function() {\r\n                jQuery(document.body).off(\"mousemove\", DEMO.waitThenHideMouse);\r\n                jQuery(document.body).css('cursor', 'default');\r\n            },\r\n        };\r\n\r\n        DEMO.waitThenHideMouse();\r\n\r\n        // Play button clicked\r\n        jQuery('.btnPlay').on('click', this.playPause.bind(this));\r\n\r\n        // Stop button clicked\r\n        jQuery('.btnStop').on('click', () => {\r\n            jQuery('.btnPlay').removeClass('paused');\r\n            this.updatebar((jQuery('.progress') as any).offset().left);\r\n            if (!this._paused || this._ended) {\r\n                this.playPause();\r\n            }\r\n            this._cutscene.reset();\r\n            return false;\r\n        });\r\n\r\n        // When video timebar is clicked\r\n        jQuery('.progress').on('mousedown', (function(ctrl: CutSceneControl) {\r\n            return function(e: any) {\r\n                ctrl._timeDrag = true;\r\n                ctrl._cutscene.stopSound();\r\n                ctrl._pausedSave = ctrl._paused;\r\n                if (!ctrl._paused) {\r\n                    ctrl._gameData.anmMgr.pause(true);\r\n                    ctrl._paused = true;\r\n                }\r\n                ctrl.updatebar(e.pageX);\r\n                return false;\r\n            };\r\n        })(this));\r\n\r\n        jQuery(document).on('mouseup', (function(ctrl: CutSceneControl) {\r\n            return function(e: any) {\r\n                if (ctrl._timeDrag) {\r\n                    ctrl._timeDrag = false;\r\n                    ctrl.updatebar(e.pageX);\r\n                    if (ctrl._ended) {\r\n                        ctrl._ended = false;\r\n                    }\r\n                    ctrl._paused = ctrl._pausedSave;\r\n                    if (!ctrl._paused) {\r\n                        ctrl._cutscene.startSound();\r\n                        ctrl._gameData.anmMgr.pause(false);\r\n                    }\r\n                }\r\n            };\r\n        })(this));\r\n\r\n        jQuery(document).on('mousemove', (function(ctrl: CutSceneControl) {\r\n            return function(e: any) {\r\n                if (ctrl._timeDrag) {\r\n                    ctrl.updatebar(e.pageX);\r\n                }\r\n            };\r\n        })(this));\r\n    }\r\n\r\n    public updateTime(currentTime: number): void {\r\n        const maxduration = this._cutscene.duration,\r\n              perc = 100 * currentTime / maxduration;\r\n\r\n        jQuery('.timeBar').css('width', perc + '%');\r\n        jQuery('.current').text(this.timeFormat(currentTime));\r\n    }\r\n\r\n    public finished(): void {\r\n        this.updateTime(this._cutscene.duration);\r\n        jQuery('.btnPlay').removeClass('paused');\r\n        this._ended = this._paused = true;\r\n    }\r\n\r\n    protected playPause() {\r\n        if (this._paused || this._ended) {\r\n            if (this._ended) {\r\n                this.updatebar((jQuery('.progress') as any).offset().left);\r\n                this._cutscene.reset();\r\n                this._ended = false;\r\n            }\r\n            jQuery('.btnPlay').addClass('paused');\r\n            this._gameData.anmMgr.pause(false);\r\n            this._paused = false;\r\n            this._cutscene.startSound();\r\n        } else {\r\n            jQuery('.btnPlay').removeClass('paused');\r\n            this._gameData.anmMgr.pause(true);\r\n            this._paused = true;\r\n            this._cutscene.stopSound();\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    protected updatebar(x: number): void {\r\n        const progress: any = jQuery('.progress');\r\n\r\n        // calculate drag position\r\n        // and update video currenttime\r\n        // as well as progress bar\r\n\r\n        const maxduration = this._cutscene.duration;\r\n        const position = x - progress.offset().left;\r\n\r\n        let percentage = 100 * position / progress.width();\r\n\r\n        if (percentage > 100) {\r\n            percentage = 100;\r\n        }\r\n\r\n        if (percentage < 0) {\r\n            percentage = 0;\r\n        }\r\n\r\n        const newTime = maxduration * percentage / 100;\r\n\r\n        this._cutscene.currentTime = newTime;\r\n    }\r\n\r\n    protected updateVolume(x: number, vol: number): void {\r\n        const volume: any = jQuery('.volume');\r\n\r\n        let percentage: number;\r\n\r\n        // if volume have been specified then direct update volume\r\n        if (vol) {\r\n            percentage = vol * 100;\r\n        }\r\n        else {\r\n            const position = x - volume.offset().left;\r\n            percentage = 100 * position / volume.width();\r\n        }\r\n\r\n        if (percentage > 100) {\r\n            percentage = 100;\r\n        }\r\n\r\n        if (percentage < 0) {\r\n            percentage = 0;\r\n        }\r\n\r\n        // update volume bar and video volume\r\n        jQuery('.volumeBar').css('width', percentage + '%');\r\n\r\n        this._cutscene.volume = percentage / 100;\r\n\r\n        // change sound icon based on volume\r\n        if (percentage == 0) {\r\n            jQuery('.sound').removeClass('sound2').addClass('muted');\r\n        } else if (percentage > 50) {\r\n            jQuery('.sound').removeClass('muted').addClass('sound2');\r\n        } else {\r\n            jQuery('.sound').removeClass('muted').removeClass('sound2');\r\n        }\r\n    }\r\n\r\n    // Time format converter - 00:00\r\n    protected timeFormat(seconds: number): string {\r\n        const min = Math.floor(seconds / 60),\r\n              m = min < 10 ? \"0\" + min : \"\" + min,\r\n              s = Math.floor(seconds - min * 60) < 10 ? \"0\" + Math.floor(seconds - min * 60) : \"\" + Math.floor(seconds - min * 60);\r\n\r\n        return m + \":\" + s;\r\n    }\r\n\r\n}\r\n","import Engine from \"../Proxy/Engine\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { IMeshBuilder } from \"../Proxy/IMeshBuilder\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\n\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\nimport { Ponytail } from \"../Behaviour/Ponytail\";\r\nimport { ShaderManager } from \"../ShaderManager\";\r\nimport { Layer, LAYER } from \"../Player/Layer\";\r\nimport { BONE, MASK } from \"../Player/Skeleton\";\r\nimport { Commands } from \"../Animation/Commands\";\r\nimport { CommandDispatchMode } from \"../Animation/CommandDispatch\";\r\nimport TrackInstance from \"../Animation/TrackInstance\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nexport default class CutSceneHelper {\r\n\r\n    private sceneData:      any;\r\n    private gameData:       IGameData;\r\n    private objMgr:         ObjectManager;\r\n    private shdMgr:         ShaderManager;\r\n    private scene:          IScene;\r\n\r\n    private _holeDoneR1:    any;\r\n    private _holeDoneR2:    any;\r\n    private _holeNotDoneR1: any;\r\n    private _holeNotDoneR2: any;\r\n    private _holeDone:      boolean;\r\n\r\n    constructor(gameData: IGameData, lara: IMesh) {\r\n        this.gameData = gameData;\r\n        this.sceneData = gameData.sceneData;\r\n        this.objMgr = gameData.objMgr;\r\n        this.shdMgr = gameData.shdMgr;\r\n        this.scene = gameData.sceneRender;\r\n\r\n        this._holeDone = false;\r\n    }\r\n\r\n    public prepareLevel(trVersion: string, levelName: string, csIndex: number, actorMoveables: Array<any>): Array<Promise<void>> {\r\n        const promises: Array<Promise<any>> = [];\r\n\r\n        if (trVersion == 'TR2') {\r\n            switch (levelName) {\r\n                case 'cut1.tr2': {\r\n                    // disable interpolation for laptop animation\r\n                    const laptop = (this.objMgr.objectList['moveable'][128] as Array<IMesh>)[0],\r\n                          data = this.sceneData.objects[laptop.name],\r\n                          anmIndex = data.animationStartIndex;\r\n\r\n                    let track = this.sceneData.animTracks[anmIndex];\r\n\r\n                    track = this.sceneData.animTracks[track.nextTrack];\r\n\r\n                    track.setCommands([\r\n                        { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [track.commandsFrameStart + 0, Commands.Misc.ANIMCMD_MISC_SETINTERPOLATION, false] },\r\n                    ], track.commandsFrameStart);\r\n                    break;\r\n                }\r\n\r\n                case 'cut3.tr2': {\r\n                    // bad guys are not at the right location\r\n                    const black = (this.objMgr.objectList['moveable'][98] as Array<IMesh>)[0],\r\n                          red = (this.objMgr.objectList['moveable'][97] as Array<IMesh>)[0];\r\n\r\n                    black.setQuaternion([0, 1, 0, 0]); // 180 deg rotation\r\n                    black.setPosition([16900, -5632, -7680]);\r\n\r\n                    red.setPosition([20000, -5632, -10700]);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        switch (csIndex) {\r\n            case 1: {\r\n                // Handle the shovel / Make a hole in the ground / Add a fade-in/out between animation #1 and #2 (so that we don't see the hole pop...)\r\n                const lara = actorMoveables[0],\r\n                      data = this.sceneData.objects[lara.name],\r\n                      track1 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex],\r\n                      track2 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex + 1];\r\n\r\n                const meshShovel = this.objMgr.createMoveable(417, data.roomIndex, undefined, true, data.skeleton);\r\n\r\n                data.layer.setMesh(LAYER.MESHSWAP, meshShovel, 0);\r\n\r\n                this.prepareHole();\r\n                this._holeDone = true;\r\n                this.cs1MakeHole(CommandDispatchMode.NORMAL);\r\n\r\n                track1.setCommands([\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [24,  Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.ARM_L3)] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [230, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, (action: number, obj: IMesh, mode: CommandDispatchMode) => this.fadeOut(1.0, mode)] }\r\n                ], 0);\r\n\r\n                track2.setCommands([\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [27,  Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, (action: number, obj: IMesh, mode: CommandDispatchMode) => this.cs1MakeHole(mode)] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [30,  Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, (action: number, obj: IMesh, mode: CommandDispatchMode) => this.fadeIn(1.0, mode)] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [147, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.ARM_L3)] }\r\n                ], 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 2: {\r\n                // Handle the shovel\r\n                const lara = actorMoveables[0],\r\n                      data = this.sceneData.objects[lara.name],\r\n                      track1 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                const meshShovel = this.objMgr.createMoveable(417, data.roomIndex, undefined, true, data.skeleton);\r\n\r\n                data.layer.setMesh(LAYER.MESHSWAP, meshShovel, 0);\r\n\r\n                this.prepareHole();\r\n\r\n                track1.setCommands([\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [0,   Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.ARM_L3)] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [147, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.ARM_L3)] }\r\n                ], 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 4: {\r\n                // Handle the pistols visibility + fire during the fight with the scorpion\r\n                const lara = actorMoveables[0],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex],\r\n                      commandsL: Array<any> = [];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                commandsL.push(\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [0,   Commands.Misc.ANIMCMD_MISC_GETLEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [0,   Commands.Misc.ANIMCMD_MISC_GETRIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [12,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [55,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [70,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [80,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [100,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [110,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [120,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [130,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [140,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [150,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [160,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [170,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [200,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [210,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [220,  Commands.Misc.ANIMCMD_MISC_FIRERIGHTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [230,  Commands.Misc.ANIMCMD_MISC_FIRELEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [320, Commands.Misc.ANIMCMD_MISC_GETLEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [320, Commands.Misc.ANIMCMD_MISC_GETRIGHTGUN] }\r\n                );\r\n\r\n                // Make speaking heads\r\n                const aziz = actorMoveables[1],\r\n                      azizHeadIds = [21, 22],\r\n                      commandsA: Array<any> = [],\r\n                      trackA = this.sceneData.animTracks[this.sceneData.objects[aziz.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(aziz);\r\n\r\n                trackA.setCommands(commandsA, 0);\r\n\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 16 * 30, 28 * 30, 3, 1 << 8);\r\n\r\n                break;\r\n            }\r\n\r\n            case 5: {\r\n                // Show bagpack\r\n                const lara = actorMoveables[0],\r\n                      data = this.sceneData.objects[lara.name],\r\n                      track1 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                const laraBagpack = this.objMgr.createMoveable(1, -1, undefined, true, data.skeleton) as IMesh,\r\n                      meshb = Engine.makeMeshBuilder(laraBagpack);\r\n\r\n                meshb.replaceSkinIndices({1: BONE.CHEST});\r\n                data.layer.setMeshBuilder(LAYER.MESHSWAP, meshb, 0);\r\n\r\n                track1.setCommands([\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [1350,   Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.CHEST)] }\r\n                ], 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 6: {\r\n                // Make speaking heads\r\n                const vonCroy = actorMoveables[1],\r\n                      vonCroyHeadIds = [21, 22],\r\n                      commandsVC: Array<any> = [],\r\n                      trackVC = this.sceneData.animTracks[this.sceneData.objects[vonCroy.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(vonCroy);\r\n\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 0 * 30, 6 * 30 + 15, 3, 1 << 21);\r\n\r\n                trackVC.setCommands(commandsVC, 0);\r\n\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                this.setHeads(lara, commandsL, laraHeadIds, 9 * 30 - 10, 12 * 30, 3);\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 7:\r\n            case 8:\r\n            case 9: {\r\n                // Add volumetric fog in the rooms / objects\r\n                const rooms  = new Set([0, 1, 2, 3, 4, 5, 6, 7, 8, 110, 111, 112, 113, 114, 115, 116, 117, 122, 123]),\r\n                      shader = this.shdMgr.getFragmentShader(\"TR_volumetric_fog\");\r\n\r\n                const setShader = (obj: IMesh) => {\r\n                    const materials = obj.materials;\r\n                    for (let m = 0; m < materials.length; ++m) {\r\n                        const material = materials[m];\r\n\r\n                        promises.push(shader.then((shd) => material.fragmentShader = shd));\r\n\r\n                        material.uniforms.volFogCenter = { \"type\": \"f3\", \"value\": [52500.0, 3140.0, -49460.0] };\r\n                        material.uniforms.volFogRadius = { \"type\": \"f\",  \"value\": 6000 };\r\n                        material.uniforms.volFogColor =  { \"type\": \"f3\", \"value\": [0.1, 0.75, 0.3] };\r\n                    }\r\n                };\r\n\r\n                this.scene.traverse((obj) => {\r\n                    const data = this.sceneData.objects[obj.name];\r\n\r\n                    if (data && rooms.has(data.roomIndex) || actorMoveables.indexOf(obj) >= 0) {\r\n                        setShader(obj);\r\n                    }\r\n                });\r\n\r\n                const ponytail = this.gameData.bhvMgr.getBehaviour(\"Ponytail\") as Array<Ponytail>;\r\n                if (ponytail && ponytail.length > 0) {\r\n                    ponytail[0].braids.forEach((braid) => setShader(braid.model));\r\n                }\r\n\r\n                // Make speaking heads\r\n                const vonCroy = actorMoveables[1],\r\n                      vonCroyHeadIds = [21, 22],\r\n                      commandsVC: Array<any> = [],\r\n                      trackVC = this.sceneData.animTracks[this.sceneData.objects[vonCroy.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(vonCroy);\r\n\r\n                trackVC.setCommands(commandsVC, 0);\r\n\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                switch (csIndex) {\r\n                    case 7: {\r\n                        this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 13 * 30, 21 * 30, 3, 1 << 21, setShader);\r\n                        this.setHeads(lara, commandsL, laraHeadIds, 22 * 30 + 10, 29 * 30, 3, MASK.HEAD, setShader);\r\n                        break;\r\n                    }\r\n\r\n                    case 8: {\r\n                        this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 10 * 30 + 10, 13 * 30, 3, 1 << 21, setShader);\r\n                        break;\r\n                    }\r\n\r\n                    case 9: {\r\n                        this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 0 * 30, 5 * 30, 3, 1 << 21, setShader);\r\n                        this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 12 * 30, 28 * 30, 3, 1 << 21, setShader);\r\n                        this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 32 * 30 + 24, 38 * 30, 3, 1 << 21, setShader);\r\n                        this.setHeads(lara, commandsL, laraHeadIds, 39 * 30 + 10, 42 * 30, 3, MASK.HEAD, setShader);\r\n                        this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 65 * 30, 69 * 30, 3, 1 << 21, setShader);\r\n                        this.setHeads(lara, commandsL, laraHeadIds, 90 * 30, 92 * 30 + 10, 3, MASK.HEAD, setShader);\r\n                        this.setHeads(lara, commandsL, laraHeadIds, 100 * 30 + 18, 101 * 30, 3, MASK.HEAD, setShader);\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                break;\r\n            }\r\n\r\n            case 10: {\r\n                // Scroll that Lara is reading is not well positionned at start - move and rotate it\r\n                const oscroll = (this.objMgr.objectList['staticmesh'][20] as Array<IMesh>)[2],\r\n                      q = glMatrix.quat.create();\r\n\r\n                glMatrix.quat.setAxisAngle(q, [0, 1, 0], glMatrix.glMatrix.toRadian(60));\r\n\r\n                oscroll.setQuaternion(q);\r\n                oscroll.setPosition([oscroll.position[0] + 850, oscroll.position[1], oscroll.position[2]]);\r\n\r\n                oscroll.matrixAutoUpdate = false;\r\n\r\n                // Make speaking heads\r\n                const vonCroy = actorMoveables[1],\r\n                      vonCroyHeadIds = [21, 22],\r\n                      commandsVC: Array<any> = [],\r\n                      trackVC = this.sceneData.animTracks[this.sceneData.objects[vonCroy.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(vonCroy);\r\n\r\n                trackVC.setCommands(commandsVC, 0);\r\n\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 32 * 30, 40 * 30 + 15, 3, 1 << 21);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 41 * 30 + 10, 43 * 30 + 15, 3);\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 44 * 30 + 10, 57 * 30 + 24, 3, 1 << 21);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 58 * 30 + 10, 62 * 30 - 10, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 62 * 30 + 10, 67 * 30, 3);\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 67 * 30 + 10, 77 * 30, 3, 1 << 21);\r\n\r\n                break;\r\n            }\r\n\r\n            case 11: {\r\n                // Make speaking heads\r\n                const aziz = actorMoveables[2],\r\n                      azizHeadIds = [21, 22],\r\n                      commandsA: Array<any> = [],\r\n                      trackA = this.sceneData.animTracks[this.sceneData.objects[aziz.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(aziz);\r\n\r\n                trackA.setCommands(commandsA, 0);\r\n\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 38 * 30, 39 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 40 * 30 + 10, 46 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 50 * 30, 55 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 55 * 30 + 20, 56 * 30 + 10, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 58 * 30 + 15, 63 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 64 * 30, 64 * 30 + 15, 3);\r\n\r\n                break;\r\n            }\r\n\r\n            case 15: {\r\n                // Make speaking heads\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                const vonCroy = actorMoveables[1],\r\n                      vonCroyHeadIds = [21, 22],\r\n                      commandsVC: Array<any> = [],\r\n                      trackVC = this.sceneData.animTracks[this.sceneData.objects[vonCroy.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(vonCroy);\r\n\r\n                trackVC.setCommands(commandsVC, 0);\r\n\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 10 * 30, 22 * 30, 3, 1 << 21);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 22 * 30 + 15, 23 * 30 + 15, 3);\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 24 * 30, 43 * 30 + 15, 3, 1 << 21);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 44 * 30 - 8, 46 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 60 * 30 - 10, 61 * 30, 3);\r\n\r\n                break;\r\n            }\r\n\r\n            case 16: {\r\n                // Make speaking heads\r\n                const jeanYves = actorMoveables[3],\r\n                      jeanYvesHeadIds = [23, 24],\r\n                      commandsJY: Array<any> = [],\r\n                      trackJY = this.sceneData.animTracks[this.sceneData.objects[jeanYves.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(jeanYves);\r\n\r\n                trackJY.setCommands(commandsJY, 0);\r\n\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                const vonCroy = actorMoveables[1],\r\n                      vonCroyHeadIds = [21, 22],\r\n                      commandsVC: Array<any> = [],\r\n                      trackVC = this.sceneData.animTracks[this.sceneData.objects[vonCroy.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(vonCroy);\r\n\r\n                trackVC.setCommands(commandsVC, 0);\r\n\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 3 * 30, 4 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 6 * 30 - 10, 10 * 30, 3, 1 << 18);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 13 * 30 - 10, 16 * 30, 3);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 17 * 30, 26 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 27 * 30, 33 * 30, 3, 1 << 18);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 34 * 30, 35 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 35 * 30 + 15, 39 * 30, 3);\r\n                this.setHeads(vonCroy, commandsVC, vonCroyHeadIds, 53 * 30, 66 * 30, 3, 1 << 21);\r\n\r\n                break;\r\n            }\r\n\r\n            case 17: {\r\n                // Make speaking heads\r\n                const jeanYves = actorMoveables[1],\r\n                      jeanYvesHeadIds = [23, 24],\r\n                      commandsJY: Array<any> = [],\r\n                      trackJY = this.sceneData.animTracks[this.sceneData.objects[jeanYves.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(jeanYves);\r\n\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 1 * 30, 2 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 8 * 30 + 20, 9 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 13 * 30, 16 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 23 * 30, 26 * 30, 3, 1 << 18);\r\n\r\n                trackJY.setCommands(commandsJY, 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 18: {\r\n                // Make speaking heads\r\n                const jeanYves = actorMoveables[1],\r\n                      jeanYvesHeadIds = [23, 24],\r\n                      commandsJY: Array<any> = [],\r\n                      trackJY = this.sceneData.animTracks[this.sceneData.objects[jeanYves.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(jeanYves);\r\n\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 2 * 30 + 24, 8 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 11 * 30, 19 * 30, 3, 1 << 18);\r\n\r\n                trackJY.setCommands(commandsJY, 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 19: {\r\n                // Make speaking heads\r\n                const jeanYves = actorMoveables[1],\r\n                      jeanYvesHeadIds = [23, 24],\r\n                      commandsJY: Array<any> = [],\r\n                      trackJY = this.sceneData.animTracks[this.sceneData.objects[jeanYves.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(jeanYves);\r\n\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 9 * 30 + 24, 15 * 30 + 20, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 17 * 30, 26 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 27 * 30 + 15, 29 * 30 - 10, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 30 * 30 - 10, 33 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 34 * 30, 43 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 44 * 30 + 10, 48 * 30, 3, 1 << 18);\r\n\r\n                trackJY.setCommands(commandsJY, 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 20: {\r\n                // Make speaking heads\r\n                const jeanYves = actorMoveables[1],\r\n                      jeanYvesHeadIds = [23, 24],\r\n                      commandsJY: Array<any> = [],\r\n                      trackJY = this.sceneData.animTracks[this.sceneData.objects[jeanYves.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(jeanYves);\r\n\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 5 * 30, 10 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 11 * 30 - 10, 14 * 30 - 10, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 14 * 30 + 10, 17 * 30, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 24 * 30, 27 * 30 - 6, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 27 * 30 + 6, 28 * 30 - 8, 3, 1 << 18);\r\n                this.setHeads(jeanYves, commandsJY, jeanYvesHeadIds, 29 * 30, 31 * 30, 3, 1 << 18);\r\n\r\n                trackJY.setCommands(commandsJY, 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 21: {\r\n                // Handle the pole\r\n                const lara = actorMoveables[0],\r\n                      data = this.sceneData.objects[lara.name],\r\n                      track1 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                const meshPole = this.objMgr.createMoveable(417, data.roomIndex, undefined, true, data.skeleton);\r\n\r\n                data.layer.setMesh(LAYER.MESHSWAP, meshPole, 0);\r\n\r\n                track1.setCommands([\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [0,   Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.ARM_R3)] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [560, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => data.layer.updateMask(LAYER.MESHSWAP, MASK.ARM_R3)] }\r\n                ], 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 23: {\r\n                // Handle the visibility of the ankh\r\n                const lara = actorMoveables[0],\r\n                      track1 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                const seth = (this.objMgr.objectList['moveable'][345] as Array<IMesh>)[0],\r\n                      layer = this.sceneData.objects[seth.name].layer as Layer;\r\n\r\n                layer.updateMask(LAYER.MAIN, 1 << 11);\r\n\r\n                track1.setCommands([\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [555, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => layer.updateMask(LAYER.MAIN, 1 << 11)] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [655, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, () => layer.updateMask(LAYER.MAIN, 1 << 11)] }\r\n                ], 0);\r\n\r\n                break;\r\n            }\r\n\r\n            case 24: {\r\n                // Handle the pistols visibility during the dialog with the wounded guy\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      track1 = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                track1.setCommands(commandsL, 0);\r\n\r\n                commandsL.push(\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [0,   Commands.Misc.ANIMCMD_MISC_GETLEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [0,   Commands.Misc.ANIMCMD_MISC_GETRIGHTGUN] }\r\n                );\r\n\r\n                this.setHeads(lara, commandsL, laraHeadIds, 3 * 30 - 10, 5 * 30 + 15, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 17 * 30 - 10, 551, 3);\r\n\r\n                commandsL.push(\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [552, Commands.Misc.ANIMCMD_MISC_GETLEFTGUN] },\r\n                    { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [552, Commands.Misc.ANIMCMD_MISC_GETRIGHTGUN] }\r\n                );\r\n\r\n                this.setHeads(lara, commandsL, laraHeadIds, 553, 22 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 53 * 30, 53 * 30 + 22, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 59 * 30, 60 * 30 + 4, 3);\r\n\r\n                // Make speaking heads\r\n                const aziz = actorMoveables[1],\r\n                      azizHeadIds = [21, 22],\r\n                      commandsA: Array<any> = [],\r\n                      trackA = this.sceneData.animTracks[this.sceneData.objects[aziz.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(aziz);\r\n\r\n                trackA.setCommands(commandsA, 0);\r\n\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 23 * 30, 32 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 38 * 30, 52 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 56 * 30, 59 * 30 - 10, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 61 * 30, 70 * 30, 3);\r\n\r\n                break;\r\n            }\r\n\r\n            case 25: {\r\n                // Make speaking heads\r\n                const aziz = actorMoveables[1],\r\n                      azizHeadIds = [21, 22],\r\n                      commandsA: Array<any> = [],\r\n                      trackA = this.sceneData.animTracks[this.sceneData.objects[aziz.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(aziz);\r\n\r\n                trackA.setCommands(commandsA, 0);\r\n\r\n                const lara = actorMoveables[0],\r\n                      laraHeadIds = [17, 18, 19, 20],\r\n                      commandsL: Array<any> = [],\r\n                      trackL = this.sceneData.animTracks[this.sceneData.objects[lara.name].animationStartIndex];\r\n\r\n                trackL.setCommands(commandsL, 0);\r\n\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 9 * 30 + 20, 15 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 19 * 30 + 20, 20 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 20 * 30, 32 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 32 * 30, 35 * 30 + 10, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 36 * 30 + 15, 38 * 30 + 15, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 40 * 30, 43 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 43 * 30 + 18, 44 * 30 + 10, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 49 * 30, 68 * 30, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 68 * 30 + 15, 72 * 30 + 10, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 74 * 30 - 10, 76 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 77 * 30 + 15, 93 * 30 + 15, 3);\r\n                this.setHeads(lara, commandsL, laraHeadIds, 94 * 30, 95 * 30, 3);\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 98 * 30, 111 * 30, 3);\r\n\r\n                break;\r\n            }\r\n\r\n            case 26: {\r\n                // Make speaking heads\r\n                const aziz = actorMoveables[1],\r\n                      azizHeadIds = [21, 22],\r\n                      commandsA: Array<any> = [],\r\n                      trackA = this.sceneData.animTracks[this.sceneData.objects[aziz.name].animationStartIndex];\r\n\r\n                this.makeLayeredMesh(aziz);\r\n\r\n                trackA.setCommands(commandsA, 0);\r\n\r\n                this.setHeads(aziz, commandsA, azizHeadIds, 3 * 30 + 10, 14 * 30 + 10, 3);\r\n\r\n                break;\r\n            }\r\n        }\r\n\r\n        return promises;\r\n    }\r\n\r\n    protected makeLayeredMesh(mesh: IMesh): void {\r\n        const data = this.sceneData.objects[mesh.name];\r\n\r\n        if (!data.layer) {\r\n            data.layer = new Layer(mesh, this.gameData);\r\n        }\r\n    }\r\n\r\n    public setHeads(mesh: IMesh, commands: Array<any>, ids: Array<number>, startFrame: number, endFrame: number, frameStep: number = 6, headMask: number = MASK.HEAD, shaderFunc?: (obj: IMesh) => void): void {\r\n        const data = this.sceneData.objects[mesh.name];\r\n\r\n        const heads: Array<IMeshBuilder> = [];\r\n\r\n        ids.forEach((id) => {\r\n            const head = this.objMgr.createMoveable(id, -1, undefined, true, data.skeleton) as IMesh,\r\n                  meshb = Engine.makeMeshBuilder(head);\r\n\r\n            if (shaderFunc) {\r\n                shaderFunc(head);\r\n            }\r\n\r\n            meshb.makeSkinIndicesList();\r\n            heads.push(meshb);\r\n        });\r\n\r\n        let frame = startFrame,\r\n            frameEnd = endFrame;\r\n\r\n        let i = 0;\r\n        while (frame <= frameEnd) {\r\n            let func = (head: IMeshBuilder) => ((action: number, obj: IMesh, mode: CommandDispatchMode) => this.setHead(mode, data.layer, head, headMask));\r\n\r\n            commands.push(\r\n                { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [frame, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, func(heads[i])] }\r\n            );\r\n\r\n            frame += frameStep;\r\n            i = (i + 1) % heads.length;\r\n        }\r\n\r\n        commands.push(\r\n            { cmd: Commands.ANIMCMD_MISCACTIONONFRAME , params: [frameEnd +  1, Commands.Misc.ANIMCMD_MISC_CUSTOMFUNCTION, (action: number, obj: IMesh, mode: CommandDispatchMode) => this.resetHead(mode, data.layer)] }\r\n        );\r\n    }\r\n\r\n    protected setHead(mode: CommandDispatchMode, layer: Layer, head: IMeshBuilder, headMask: number): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.UNDO_END: {\r\n                if (layer.getMeshBuilder(LAYER.MESHSWAP)) {\r\n                    layer.setMask(layer.getMeshBuilder(LAYER.MESHSWAP) as IMeshBuilder, 0);\r\n                }\r\n                layer.setMask(layer.getMeshBuilder(LAYER.MAIN) as IMeshBuilder, MASK.ALL);\r\n                break;\r\n            }\r\n\r\n            case CommandDispatchMode.NORMAL: {\r\n                if (layer.getMeshBuilder(LAYER.MESHSWAP)) {\r\n                    layer.setMask(layer.getMeshBuilder(LAYER.MESHSWAP) as IMeshBuilder, 0);\r\n                }\r\n                layer.setMeshBuilder(LAYER.MESHSWAP, head, 0);\r\n                layer.setMask(head, headMask);\r\n                //layer.setMask(layer.getMeshBuilder(LAYER.MAIN) as IMeshBuilder, MASK.ALL & ~headMask);\r\n                layer.setRoom(this.gameData.sceneData.objects[(layer.getMeshBuilder(LAYER.MAIN) as IMeshBuilder).mesh.name].roomIndex);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected resetHead(mode: CommandDispatchMode, layer: Layer): void {\r\n        switch (mode) {\r\n            case CommandDispatchMode.NORMAL: {\r\n                if (layer.getMeshBuilder(LAYER.MESHSWAP)) {\r\n                    layer.setMask(layer.getMeshBuilder(LAYER.MESHSWAP) as IMeshBuilder, 0);\r\n                }\r\n                layer.setMask(layer.getMeshBuilder(LAYER.MAIN) as IMeshBuilder,     MASK.ALL);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public fadeOut(duration: number, mode: CommandDispatchMode): void {\r\n        if (mode === CommandDispatchMode.NORMAL) {\r\n            jQuery(this.gameData.container).fadeOut(duration * 1000);\r\n        } else if (mode === CommandDispatchMode.UNDO) {\r\n            jQuery(this.gameData.container).stop();\r\n            jQuery(this.gameData.container).fadeIn(0);\r\n        }\r\n    }\r\n\r\n    public fadeIn(duration: number, mode: CommandDispatchMode): void {\r\n        if (mode === CommandDispatchMode.NORMAL) {\r\n            jQuery(this.gameData.container).fadeIn(duration * 1000);\r\n        }\r\n    }\r\n\r\n    // Between cutscene 1 and 2, a hole should appear in the ground to reveal hidden entrance to pyramid\r\n    public cs1MakeHole(mode: CommandDispatchMode): void {\r\n        let stateR1 = this._holeDone ? this._holeNotDoneR1 : this._holeDoneR1,\r\n            stateR2 = this._holeDone ? this._holeNotDoneR2 : this._holeDoneR2;\r\n\r\n        let oroom = this.objMgr.objectList['room'][81] as IMesh;\r\n        let mshBld = Engine.makeMeshBuilder(oroom);\r\n\r\n        mshBld.setIndexAndGroupsState(stateR1);\r\n\r\n        oroom = this.objMgr.objectList['room'][80] as IMesh;\r\n        mshBld = Engine.makeMeshBuilder(oroom);\r\n\r\n        mshBld.setIndexAndGroupsState(stateR2);\r\n\r\n        this._holeDone = !this._holeDone;\r\n    }\r\n\r\n    protected prepareHole(): void {\r\n        // First room\r\n        let oroom = this.objMgr.objectList['room'][81] as IMesh;\r\n\r\n        let mshBld = Engine.makeMeshBuilder(oroom);\r\n\r\n        this._holeNotDoneR1 = mshBld.getIndexAndGroupState();\r\n\r\n        let newFaces = [\r\n            mshBld.copyFace(118),\r\n            mshBld.copyFace(120),\r\n            mshBld.copyFace(120),\r\n            mshBld.copyFace(118),\r\n            mshBld.copyFace(117),\r\n            mshBld.copyFace(49)\r\n        ];\r\n\r\n        newFaces[0].v1[0] = newFaces[0].v3[0];\r\n        newFaces[0].v1[2] = newFaces[0].v3[2];\r\n        newFaces[0].uv1 = [newFaces[4].uv1[0], newFaces[4].uv2[1]];\r\n        newFaces[0].uv2 = [newFaces[4].uv2[0], newFaces[4].uv2[1]];\r\n        newFaces[0].uv3 = [newFaces[4].uv1[0], newFaces[4].uv1[1]];\r\n\r\n        newFaces[1].v1[0] = newFaces[1].v3[0];\r\n        newFaces[1].v1[2] = newFaces[1].v3[2];\r\n\r\n        newFaces[2].v2[0] = newFaces[2].v3[0];\r\n        newFaces[2].v2[2] = newFaces[2].v3[2];\r\n        newFaces[2].uv1 = [newFaces[5].uv1[0], newFaces[5].uv1[1]];\r\n        newFaces[2].uv2 = [newFaces[5].uv2[0], newFaces[5].uv1[1]];\r\n        newFaces[2].uv3 = [newFaces[5].uv2[0], newFaces[5].uv2[1]];\r\n\r\n        newFaces[3].v2[0] = newFaces[3].v3[0];\r\n        newFaces[3].v2[2] = newFaces[3].v3[2];\r\n\r\n        mshBld.removeFaces(new Set([\r\n            49, 116, 117, 118, 119, 120,\r\n        ]));\r\n\r\n        mshBld.createFaces(newFaces, 1);\r\n\r\n        this._holeDoneR1 = mshBld.getIndexAndGroupState();\r\n\r\n        // Second room\r\n        oroom = this.objMgr.objectList['room'][80] as IMesh;\r\n\r\n        mshBld = Engine.makeMeshBuilder(oroom);\r\n\r\n        this._holeNotDoneR2 = mshBld.getIndexAndGroupState();\r\n\r\n        newFaces = [\r\n            mshBld.copyFace(126),\r\n            mshBld.copyFace(126),\r\n            mshBld.copyFace(128),\r\n            mshBld.copyFace(128),\r\n            mshBld.copyFace(134),\r\n            mshBld.copyFace(63)\r\n        ];\r\n\r\n        mshBld.removeFaces(new Set([\r\n            63, 126, 127, 128, 129, 134\r\n        ]));\r\n\r\n        newFaces[0].v1[0] = newFaces[0].v3[0];\r\n        newFaces[0].v1[2] = newFaces[0].v3[2];\r\n\r\n        newFaces[1].v2[0] = newFaces[1].v3[0];\r\n        newFaces[1].v2[2] = newFaces[1].v3[2];\r\n        newFaces[1].uv1 = [newFaces[4].uv1[0], newFaces[4].uv1[1]];\r\n        newFaces[1].uv2 = [newFaces[4].uv2[0], newFaces[4].uv1[1]];\r\n        newFaces[1].uv3 = [newFaces[4].uv2[0], newFaces[4].uv2[1]];\r\n\r\n        newFaces[2].v2[0] = newFaces[2].v3[0];\r\n        newFaces[2].v2[2] = newFaces[2].v3[2];\r\n\r\n        newFaces[3].v1[0] = newFaces[3].v3[0];\r\n        newFaces[3].v1[2] = newFaces[3].v3[2];\r\n        newFaces[3].uv1 = [newFaces[5].uv1[0], newFaces[5].uv2[1]];\r\n        newFaces[3].uv2 = [newFaces[5].uv2[0], newFaces[5].uv2[1]];\r\n        newFaces[3].uv3 = [newFaces[5].uv1[0], newFaces[5].uv1[1]];\r\n\r\n        mshBld.createFaces(newFaces, 2);\r\n\r\n        this._holeDoneR2 = mshBld.getIndexAndGroupState();\r\n    }\r\n\r\n}\r\n","import { IMesh } from \"../Proxy/IMesh\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\n\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\nimport { ConfigManager } from \"../ConfigManager\";\r\nimport Track from \"../Animation/Track\";\r\nimport Misc from \"../Utils/Misc\";\r\nimport { ObjectID } from \"../Constants\";\r\nimport CutSceneHelper from \"./CutSceneHelper\";\r\nimport { Quaternion } from \"../Proxy/INode\";\r\nimport { CutSceneData } from \"./CutScene\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nexport default class CutSceneTR4 {\r\n\r\n    private gameData:   IGameData;\r\n    private sceneData:  any;\r\n    private objMgr:     ObjectManager;\r\n    private scene:      IScene;\r\n    private confMgr:    ConfigManager;\r\n    private cutscene:   any;\r\n    private helper:     CutSceneHelper;\r\n    private lara:       IMesh;\r\n\r\n    constructor(gameData: IGameData, cutscene: CutSceneData, helper: CutSceneHelper, lara: IMesh) {\r\n        this.gameData = gameData;\r\n        this.sceneData = gameData.sceneData;\r\n        this.objMgr = gameData.objMgr;\r\n        this.confMgr = gameData.confMgr;\r\n        this.scene = gameData.sceneRender;\r\n        this.cutscene = cutscene;\r\n        this.helper = helper;\r\n        this.lara = lara;\r\n    }\r\n\r\n    public makeTR4Cutscene(icutscene: number): Promise<any> {\r\n        return fetch(this.gameData.relpath + 'resources/level/tr4/TR4_cutscenes/cut' + icutscene + '.json').then((response) => {\r\n            return response.json().then((data) => {\r\n                const cutscene: Array<any> = [];\r\n\r\n                cutscene.push(data);\r\n                cutscene[0].index = icutscene;\r\n\r\n                let soundPromise = Promise.resolve();\r\n\r\n                // get the sound for this cut scene\r\n                if (cutscene[0].info.audio) {\r\n                    soundPromise = Misc.loadSoundAsync(this.gameData.relpath + this.sceneData.soundPath + cutscene[0].info.audio + '.aac').then((ret: any) => {\r\n                        if (!ret || ret.code < 0) {\r\n                            console.log('Error decoding sound data for cutscene.', ret);\r\n                        } else {\r\n                            this.cutscene.sound = ret.sound;\r\n                            this.cutscene.soundbuffer = ret.soundbuffer;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (cutscene[0].index == 1) {\r\n                    // we play cutscene 1 followed by cutscene 2, so need to retrieve data for cutscene 2\r\n                    return fetch(this.gameData.relpath + 'resources/level/tr4/TR4_cutscenes/cut' + (icutscene + 1) + '.json').then((response) => {\r\n                        return response.json().then((data) => {\r\n                            cutscene.push(data);\r\n                            cutscene[1].index = icutscene + 1;\r\n\r\n                            this.makeCutsceneData(cutscene);\r\n\r\n                            return soundPromise;\r\n                        });\r\n                    });\r\n                }\r\n\r\n                this.makeCutsceneData(cutscene);\r\n\r\n                return soundPromise;\r\n            });\r\n        });\r\n    }\r\n\r\n    protected makeCutsceneData(cutscenes: Array<any>): void {\r\n        const ocs = this.cutscene,\r\n              cutscene = cutscenes[0];\r\n\r\n        ocs.position = [cutscene.originX, -cutscene.originY, -cutscene.originZ];\r\n        ocs.quaternion = [0, 0, 0, 1];\r\n\r\n        // hide moveables (except Lara) that are already in the level and that are referenced in the cutscene (we will create them later)\r\n        const idInCutscenes: any = {};\r\n        for (let ac = 0; ac < cutscene.actors.length; ++ac) {\r\n            const id = cutscene.actors[ac].slotNumber;\r\n            idInCutscenes[id] = true;\r\n        }\r\n\r\n        for (let objID in  this.sceneData.objects) {\r\n            const objData = this.sceneData.objects[objID];\r\n            if (objData.type == 'moveable' && objData.roomIndex != -1 && objData.objectid != ObjectID.Lara && objData.objectid in idInCutscenes) {\r\n                objData.visible = false;\r\n                (this.scene.getObjectByName(objID) as IMesh).visible = false;\r\n            }\r\n        }\r\n\r\n        const laraRoomIndex = this.sceneData.objects[this.lara.name].roomIndex;\r\n\r\n        // create moveable instances used in cutscene\r\n        const actorMoveables: Array<IMesh> = [];\r\n\r\n        for (let ac = 0; ac < cutscene.actors.length; ++ac) {\r\n            const id = cutscene.actors[ac].slotNumber;\r\n            let mvb = this.lara;\r\n\r\n            if (id != ObjectID.Lara) {\r\n                mvb = this.objMgr.createMoveable(id, laraRoomIndex, undefined, true, false) as IMesh;\r\n            }\r\n\r\n            actorMoveables.push(mvb);\r\n\r\n            mvb.setPosition(ocs.position);\r\n            mvb.setQuaternion([0, 0, 0, 1]);\r\n        }\r\n\r\n        // create actor frames\r\n        for (let ac = 0; ac < cutscene.actors.length; ++ac) {\r\n            const actor = cutscene.actors[ac],\r\n                  animation = this.makeAnimationForActor(cutscene, actor, \"anim_cutscene_actor\" + ac);\r\n\r\n            this.sceneData.objects[actorMoveables[ac].name].animationStartIndex = this.sceneData.animTracks.length;\r\n\r\n            const oanimation = Track.createTrack(animation);\r\n\r\n            this.sceneData.animTracks.push(oanimation);\r\n\r\n            if (cutscene.index == 1 && ac == 0) {\r\n                // special case for cutscene #1: we add the animation for cutscene #2 as #1+#2 is really the same cutscene\r\n                const animationCont = this.makeAnimationForActor(cutscenes[1], cutscenes[1].actors[ac], \"anim_cutscene2_actor\" + ac);\r\n\r\n                oanimation.nextTrack = this.sceneData.animTracks.length;\r\n                animationCont.nextTrack = -1;\r\n\r\n                this.sceneData.animTracks.push(Track.createTrack(animationCont));\r\n            }\r\n        }\r\n\r\n        // create camera frames\r\n        let frames = this.makeAnimationForCamera(cutscene);\r\n\r\n        if (cutscene.index == 1) {\r\n            frames = frames.concat(this.makeAnimationForCamera(cutscenes[1]));\r\n        }\r\n\r\n        ocs.frames = frames;\r\n\r\n        this.helper.prepareLevel(this.confMgr.trversion, this.confMgr.levelName as string, cutscene.index, actorMoveables);\r\n\r\n        this.cutscene.objects = {};\r\n        actorMoveables.forEach((obj) => this.cutscene.objects[obj.name] = obj);\r\n    }\r\n\r\n    protected makeAnimationForActor(cutscene: any, actor: any, animName: string) {\r\n\r\n        function makeQuaternion(angleX: number, angleY: number, angleZ: number): Quaternion {\r\n\r\n            angleX = 2 * Math.PI * (angleX % 1024) / 1024.0,\r\n            angleY = 2 * Math.PI * (angleY % 1024) / 1024.0,\r\n            angleZ = 2 * Math.PI * (angleZ % 1024) / 1024.0;\r\n\r\n            const qx = glMatrix.quat.create(),\r\n                  qy = glMatrix.quat.create(),\r\n                  qz = glMatrix.quat.create();\r\n\r\n            glMatrix.quat.setAxisAngle(qx, [1, 0, 0], angleX);\r\n            glMatrix.quat.setAxisAngle(qy, [0, 1, 0], -angleY);\r\n            glMatrix.quat.setAxisAngle(qz, [0, 0, 1], -angleZ);\r\n\r\n            glMatrix.quat.mul(qy, qy, qx);\r\n            glMatrix.quat.mul(qy, qy, qz);\r\n\r\n            return qy;\r\n        }\r\n\r\n        const animation = {\r\n            \"fps\": 30,\r\n            \"frameRate\": 1,\r\n            \"keys\": [],\r\n            \"name\": animName,\r\n            \"nextTrack\": -1,\r\n            \"nextTrackFrame\": 0,\r\n            \"numFrames\": cutscene.numFrames,\r\n            \"numKeys\": cutscene.numFrames,\r\n            \"frameStart\": 0,\r\n            \"commands\": []\r\n        };\r\n\r\n        const CST0 = 3;\r\n\r\n        const prev = [];\r\n        for (let m = 0; m < actor.meshes.length; ++m) {\r\n            const mesh   = actor.meshes[m],\r\n                  posHdr = mesh.positionHeader,\r\n                  rotHdr = mesh.rotationHeader;\r\n\r\n            prev.push({\r\n                \"position\": {\r\n                    x: posHdr ? posHdr.startPosX * CST0 : 0,\r\n                    y: posHdr ? -posHdr.startPosY * CST0 : 0,\r\n                    z: posHdr ? -posHdr.startPosZ * CST0 : 0\r\n                },\r\n                \"rotation\": {\r\n                    x: rotHdr.startRotX % 1024,\r\n                    y: rotHdr.startRotY % 1024,\r\n                    z: rotHdr.startRotZ % 1024\r\n                }\r\n            });\r\n        }\r\n\r\n        let realNumFrames = 0;\r\n        for (let d = 0; d < cutscene.numFrames; ++d) {\r\n            const key: any = {\r\n                \"time\": d,\r\n                \"data\": [],\r\n                \"boundingBox\": {\r\n                    xmin: -1e7, ymin: -1e7, zmin: -1e7,\r\n                    xmax:  1e7, ymax:  1e7, zmax:  1e7\r\n                }\r\n            };\r\n\r\n            let addKey = true;\r\n\r\n            for (let m = 0; m < actor.meshes.length; ++m) {\r\n                const mesh = actor.meshes[m],\r\n                      posData = mesh.positionData,\r\n                      rotData = mesh.rotationData;\r\n\r\n                if (rotData.length <= d) {\r\n                    addKey = false;\r\n                    break;\r\n                }\r\n\r\n                let transX = 0,\r\n                    transY = 0,\r\n                    transZ = 0;\r\n\r\n                if (posData) {\r\n                    transX =  posData.dx[d] * CST0;\r\n                    transY = -posData.dy[d] * CST0;\r\n                    transZ = -posData.dz[d] * CST0;\r\n                }\r\n\r\n                const cur: any = {\r\n                    \"position\": {\r\n                        x: transX + prev[m].position.x,\r\n                        y: transY + prev[m].position.y,\r\n                        z: transZ + prev[m].position.z\r\n                    },\r\n                    \"rotation\": {\r\n                        x: (rotData.dx[d] + prev[m].rotation.x) % 1024,\r\n                        y: (rotData.dy[d] + prev[m].rotation.y) % 1024,\r\n                        z: (rotData.dz[d] + prev[m].rotation.z) % 1024\r\n                    }\r\n                };\r\n\r\n                const quat = makeQuaternion(cur.rotation.x, cur.rotation.y, cur.rotation.z);\r\n\r\n                key.data.push({\r\n                    \"position\": \t{ x: cur.position.x, y: cur.position.y, z: cur.position.z },\r\n                    \"quaternion\":\t{ x: quat[0], y: quat[1], z: quat[2], w: quat[3] }\r\n                });\r\n\r\n                prev[m] = cur;\r\n            }\r\n\r\n            if (addKey) {\r\n                realNumFrames = d;\r\n                (animation.keys as Array<any>).push(key);\r\n            }\r\n        }\r\n\r\n        animation.numFrames = realNumFrames;\r\n\r\n        return animation;\r\n    }\r\n\r\n    protected makeAnimationForCamera(cutscene: any): Array<any> {\r\n        // create camera frames\r\n        const frames = [],\r\n              ocam = cutscene.camera,\r\n              CST = 2;\r\n\r\n        let prev = {\r\n            posX:       ocam.cameraHeader.startPosX * CST,    posY:       ocam.cameraHeader.startPosY * CST,    posZ:       ocam.cameraHeader.startPosZ * CST,\r\n            targetX:    ocam.targetHeader.startPosX * CST,    targetY:    ocam.targetHeader.startPosY * CST,    targetZ:    ocam.targetHeader.startPosZ * CST\r\n        };\r\n\r\n        for (let d = 0; d < cutscene.numFrames; ++d) {\r\n            if (ocam.cameraPositionData.dx.length <= d) {\r\n                break;\r\n            }\r\n            const cur = {\r\n                fov: 13000,\r\n                roll: 0,\r\n\r\n                posX: ocam.cameraPositionData.dx[d] * CST + prev.posX,\r\n                posY: ocam.cameraPositionData.dy[d] * CST + prev.posY,\r\n                posZ: ocam.cameraPositionData.dz[d] * CST + prev.posZ,\r\n\r\n                targetX: ocam.targetPositionData.dx[d] * CST + prev.targetX,\r\n                targetY: ocam.targetPositionData.dy[d] * CST + prev.targetY,\r\n                targetZ: ocam.targetPositionData.dz[d] * CST + prev.targetZ\r\n            };\r\n            frames.push(cur);\r\n            prev = cur;\r\n        }\r\n\r\n        return frames;\r\n    }\r\n\r\n}\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\n\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { SystemLight } from \"../Player/SystemLight\";\r\n\r\nexport class DynamicLight extends Behaviour {\r\n\r\n    public name: string = DynamicLight.name;\r\n\r\n    protected _sysLight:     SystemLight;\r\n    protected _lightNum:     number;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this._sysLight = gameData.sysLight;\r\n\r\n        this._lightNum = this._sysLight.add();\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    set fadeout(f: number) {\r\n        this._sysLight.setFadeout(this._lightNum, f);\r\n    }\r\n\r\n    set position(p: Array<number>) {\r\n        this._sysLight.setPosition(this._lightNum, p);\r\n    }\r\n\r\n    set color(c: Array<number>) {\r\n        this._sysLight.setColor(this._lightNum, c);\r\n    }\r\n}\r\n\r\nBehaviourManager.registerFactory(DynamicLight);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh, isMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\nimport { Position } from \"../Proxy/INode\";\r\n\r\nexport class Fade extends Behaviour {\r\n\r\n    public name: string = Fade.name;\r\n\r\n    protected sceneRender: IScene;\r\n    protected bhvMgr: BehaviourManager;\r\n    protected colorStart: Position;\r\n    protected colorEnd: Position;\r\n    protected duration: number;\r\n    protected startTime: number;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.sceneRender = gameData.sceneRender;\r\n        this.bhvMgr = gameData.bhvMgr;\r\n        this.colorStart = this.colorEnd = [0, 0, 0];\r\n        this.duration = 0;\r\n        this.startTime = -1;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        this.colorStart = this.nbhv.colorStart;\r\n        this.colorEnd = this.nbhv.colorEnd;\r\n        this.duration = parseFloat(this.nbhv.duration);\r\n        this.startTime = -1;\r\n\r\n        this.setColor(this.colorStart);\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public onFrameStarted(curTime: number, delta: number): void {\r\n        if (this.startTime < 0) {\r\n            this.startTime = curTime;\r\n        }\r\n\r\n        const ratio = (curTime - this.startTime) / this.duration,\r\n              color: Position = [\r\n                this.colorStart[0] + (this.colorEnd[0] - this.colorStart[0]) * ratio,\r\n                this.colorStart[1] + (this.colorEnd[1] - this.colorStart[1]) * ratio,\r\n                this.colorStart[2] + (this.colorEnd[2] - this.colorStart[2]) * ratio\r\n              ];\r\n\r\n        this.setColor(color);\r\n\r\n        if (curTime - this.startTime >= this.duration) {\r\n            this.setColor(this.colorEnd);\r\n            this.bhvMgr.removeBehaviour(this);\r\n        }\r\n    }\r\n\r\n    protected setColor(color: Position): void {\r\n        this.sceneRender.traverse((obj) => {\r\n            if (!obj.visible || !isMesh(obj)) {\r\n                return;\r\n            }\r\n\r\n            const materials = obj.materials;\r\n\r\n            if (!materials || !materials.length) {\r\n                return;\r\n            }\r\n\r\n            for (let i = 0; i < materials.length; ++i) {\r\n                const material = materials[i];\r\n\r\n                material.uniforms.tintColor.value = color;\r\n\r\n                material.uniformsUpdated([\"tintColor\"]);\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Fade);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { Position } from \"../Proxy/INode\";\r\nimport { Fade } from \"./Fade\";\r\n\r\nexport class FadeUniformColor extends Fade {\r\n\r\n    public name: string = FadeUniformColor.name;\r\n\r\n    protected uniforms: Array<any>;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.uniforms = <any>null;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (this.nbhv.uniforms === null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        this.uniforms = this.nbhv.uniforms;\r\n\r\n        return super.init(lstObjs);\r\n    }\r\n\r\n    protected setColor(color: Position): void {\r\n        for (let i = 0; i < this.uniforms.length; ++i) {\r\n            const u = this.uniforms[i];\r\n\r\n            u.a[u.i + 0] = color[0];\r\n            u.a[u.i + 1] = color[1];\r\n            u.a[u.i + 2] = color[2];\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(FadeUniformColor);\r\n","import Engine from \"../Proxy/Engine\";\r\nimport { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\nimport { ConfigManager } from \"../ConfigManager\";\r\nimport { AnimationManager } from \"../Animation/AnimationManager\";\r\nimport { ObjectID } from \"../Constants\";\r\nimport { Layer, LAYER } from \"../Player/Layer\";\r\nimport { Skeleton, MASK, BONE } from \"../Player/Skeleton\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nexport class Lara extends Behaviour {\r\n\r\n    public name: string = Lara.name;\r\n\r\n    private sceneData: any;\r\n    private confMgr: ConfigManager;\r\n    private anmMgr: AnimationManager;\r\n    private objMgr: ObjectManager;\r\n    private lara: IMesh;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.sceneData = gameData.sceneData;\r\n        this.confMgr = gameData.confMgr;\r\n        this.anmMgr = gameData.anmMgr;\r\n        this.objMgr = gameData.objMgr;\r\n        this.lara = <any>null;\r\n\r\n        if (this.objectid === undefined) {\r\n            throw \"Invalid id for Lara!\";\r\n        }\r\n\r\n        ObjectID.Lara  = this.objectid;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const startTrans = this.nbhv.starttrans,\r\n              startAnim = this.nbhv.startanim,\r\n              laraAngle = this.nbhv.angle;\r\n\r\n        this.lara = lstObjs![0] as IMesh;\r\n\r\n        const dataLara = this.sceneData.objects[this.lara.name],\r\n              layer = new Layer(this.lara, this.gameData);\r\n\r\n        dataLara.layer = layer;\r\n\r\n        if (!this.gameData.isCutscene) {\r\n            if (startTrans) {\r\n                const laraPos = this.lara.position;\r\n                this.lara.setPosition([laraPos[0] + parseFloat(startTrans.x), laraPos[1] + parseFloat(startTrans.y), laraPos[2] + parseFloat(startTrans.z)]);\r\n            }\r\n\r\n            let laraQuat = this.lara.quaternion;\r\n            if (laraAngle != undefined) {\r\n                const q = glMatrix.quat.create();\r\n                glMatrix.quat.setAxisAngle(q, [0, 1, 0], glMatrix.glMatrix.toRadian(parseFloat(laraAngle)));\r\n                laraQuat = q;\r\n            }\r\n\r\n            const camPos = this.lara.position;\r\n\r\n            const ofstDir = parseFloat(this.nbhv.dirdist),\r\n                  ofstUp  = parseFloat(this.nbhv.updist);\r\n\r\n            const v3 = [0, ofstUp, ofstDir],\r\n                  q  = laraQuat.slice();\r\n\r\n            glMatrix.vec3.transformQuat(v3, v3, q);\r\n\r\n            camPos[0] += v3[0];\r\n            camPos[1] += v3[1];\r\n            camPos[2] += v3[2];\r\n\r\n            this.gameData.camera.setPosition(camPos);\r\n            this.gameData.camera.setQuaternion(laraQuat);\r\n\r\n            if (startAnim !== undefined) {\r\n               this.anmMgr.setAnimation(this.lara, parseInt(startAnim), false);\r\n            }\r\n\r\n        }\r\n\r\n        // create pistolanim object\r\n        ObjectID.PistolAnim = this.nbhv.animobject && this.nbhv.animobject.pistol ? parseInt(this.nbhv.animobject.pistol) : -1;\r\n\r\n        const mvbPistolAnim = this.objMgr.createMoveable(ObjectID.PistolAnim, -1, undefined, true, dataLara.skeleton);\r\n        if (mvbPistolAnim) {\r\n            if (this.confMgr.trversion == 'TR4') {\r\n                // for some reason, pistol animation mesh is only for left hand in TR4... So copy it to do right hand animation\r\n                const meshb = Engine.makeMeshBuilder(mvbPistolAnim);\r\n                meshb.copyFacesWithSkinIndex(BONE.ARM_L3, BONE.ARM_R3);\r\n            }\r\n\r\n            layer.setMesh(LAYER.WEAPON, mvbPistolAnim, 0);\r\n        }\r\n\r\n        // create \"holster empty\" object - TR4 only\r\n        ObjectID.HolsterEmpty = this.nbhv.animobject && this.nbhv.animobject.holster ? parseInt(this.nbhv.animobject.holster) : -1;\r\n\r\n        const mvbHolsterEmpty = this.objMgr.createMoveable(ObjectID.HolsterEmpty, -1, undefined, true, dataLara.skeleton);\r\n        if (mvbHolsterEmpty) {\r\n            // for some reason, holster meshes are made of 17 bones and not 15 as Lara mesh...\r\n            // so, modify the skin indices so that left and right holsters match the right bones in Lara mesh\r\n            const meshb = Engine.makeMeshBuilder(mvbHolsterEmpty);\r\n            meshb.replaceSkinIndices({4: BONE.LEG_L1, 8: BONE.LEG_R1});\r\n            layer.setMeshBuilder(LAYER.HOLSTER_EMPTY, meshb, 0);\r\n        }\r\n\r\n        // create \"holster full\" object - TR4 only\r\n        ObjectID.HolsterFull = this.nbhv.animobject && this.nbhv.animobject.holster_pistols ? parseInt(this.nbhv.animobject.holster_pistols) : -1;\r\n\r\n        const mvbHolsterFull = this.objMgr.createMoveable(ObjectID.HolsterFull, -1, undefined, true, dataLara.skeleton);\r\n        if (mvbHolsterFull) {\r\n            const meshb = Engine.makeMeshBuilder(mvbHolsterFull);\r\n            meshb.replaceSkinIndices({4: BONE.LEG_L1, 8: BONE.LEG_R1});\r\n            layer.setMeshBuilder(LAYER.HOLSTER_FULL, meshb, 0);\r\n        }\r\n\r\n        // create the meshswap objects\r\n        const meshSwapIds = [\r\n                this.confMgr.number('meshswap > objid1', true, 0),\r\n                this.confMgr.number('meshswap > objid2', true, 0),\r\n                this.confMgr.number('meshswap > objid3', true, 0)\r\n              ];\r\n\r\n        for (let i = 0; i < meshSwapIds.length; ++i) {\r\n            ObjectID['meshswap' + (i + 1)] = meshSwapIds[i];\r\n            if (ObjectID['meshswap' + (i + 1)] > 0) {\r\n                const mvb = this.objMgr.createMoveable(ObjectID['meshswap' + (i + 1)], -1, undefined, true, dataLara.skeleton);\r\n                if (mvb) {\r\n                    mvb.visible = false;\r\n                }\r\n            }\r\n        }\r\n\r\n        layer.update();\r\n        layer.setBoundingObjects();\r\n\r\n        if (this.confMgr.trversion == 'TR4') {\r\n            if (mvbHolsterFull) {\r\n                layer.updateMask(LAYER.HOLSTER_FULL, MASK.LEG_L1 | MASK.LEG_R1);\r\n            }\r\n        } else if (mvbPistolAnim) {\r\n            // put pistols in Lara holsters\r\n            layer.updateMask(LAYER.WEAPON, MASK.LEG_L1 | MASK.LEG_R1);\r\n            layer.updateMask(LAYER.MAIN,   MASK.LEG_L1 | MASK.LEG_R1);\r\n        }\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public getObject(): IMesh {\r\n        return this.lara;\r\n    }\r\n\r\n    public getSkeleton(): Skeleton {\r\n        return this.sceneData.objects[this.lara.name].skeleton;\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Lara);\r\n","import Engine from \"../Proxy/Engine\";\r\nimport { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\n\r\nexport class Light extends Behaviour {\r\n\r\n    public name: string = Light.name;\r\n\r\n    private static __numInstances = 0;\r\n\r\n    protected _lstObjs: Array<IMesh>;\r\n    protected _color: Array<number>;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this._lstObjs = <any>null;\r\n        this._color = [0, 0, 0];\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const color = this.nbhv.color, range = parseInt(this.nbhv.range.max);\r\n\r\n        if (lstObjs == null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        this._color = [parseFloat(color.r) / 255, parseFloat(color.g) / 255, parseFloat(color.b) / 255];\r\n\r\n        this._lstObjs = lstObjs as Array<IMesh>;\r\n\r\n        this._lstObjs.forEach((obj) => {\r\n            const roomIndex = this.gameData.sceneData.objects[obj.name].roomIndex,\r\n                  roomData = this.gameData.sceneData.objects['room' + roomIndex];\r\n\r\n            let globalLights: Array<any> = roomData.globalLights;\r\n\r\n            if (!globalLights) {\r\n                globalLights = [];\r\n                roomData.globalLights = globalLights;\r\n            }\r\n\r\n            globalLights.push({\r\n                \"x\": obj.position[0],\r\n                \"y\": obj.position[1],\r\n                \"z\": obj.position[2],\r\n                \"color\": this._color,\r\n                \"fadeOut\": range,\r\n            });\r\n\r\n            Light.__numInstances++;\r\n        });\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    protected static canLightRoom(roomMesh: IMesh, light: any): boolean {\r\n        const meshb = Engine.makeMeshBuilder(roomMesh),\r\n              vertices = meshb.vertices,\r\n              numVertices = vertices.length / 3,\r\n              lx = light.x, ly = light.y, lz = light.z, fadeOut2 = light.fadeOut * light.fadeOut;\r\n\r\n        for (let v = 0; v < numVertices; ++v) {\r\n            const x = vertices[v * 3 + 0],\r\n                  y = vertices[v * 3 + 1],\r\n                  z = vertices[v * 3 + 2];\r\n\r\n            const dist2 = (x - lx) * (x - lx) + (y - ly) * (y - ly) + (z - lz) * (z - lz);\r\n\r\n            if (dist2 < fadeOut2) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    public static onEngineInitialized(gameData: IGameData): void {\r\n        if (Light.__numInstances == 0) {\r\n            return;\r\n        }\r\n\r\n        // Loop through the global lights of each room.\r\n        // If a light can light an adjoining room, add this light to the global light list of this room\r\n        const sceneData = gameData.sceneData,\r\n              objRooms: any = gameData.objMgr.objectList['room'],\r\n              trRooms = gameData.trlvl.trlevel.rooms;\r\n\r\n        for (let r = 0; r < trRooms.length; ++r) {\r\n            const trRoom = trRooms[r],\r\n                  portals = trRoom.portals,\r\n                  globalLights = sceneData.objects['room' + r].globalLights;\r\n\r\n            if (!globalLights || portals.length == 0) { continue; }\r\n\r\n            for (let g = 0; g < globalLights.length; ++g) {\r\n                const globalLight = globalLights[g];\r\n\r\n                if (!globalLight.roomList) {\r\n                    globalLight.roomList = new Set<number>(); // list of rooms this light is\r\n                    globalLight.roomList.add(r);\r\n                }\r\n\r\n                // let's see if this light can light the rooms reachable through the portals of the current room\r\n                // if yes, add this light to those other rooms\r\n                for (let p = 0; p < portals.length; ++p) {\r\n                    const adjRoom = portals[p].adjoiningRoom;\r\n\r\n                    if (globalLight.roomList.has(adjRoom)) { continue; } // the light is already in the adjoining room\r\n\r\n                    if (Light.canLightRoom(objRooms[adjRoom] as IMesh, globalLight)) {\r\n                        let glights = sceneData.objects['room' + adjRoom].globalLights;\r\n                        if (!glights) {\r\n                            glights = [];\r\n                            sceneData.objects['room' + adjRoom].globalLights = glights;\r\n                        }\r\n                        glights.push(globalLight);\r\n                        globalLight.roomList.add(adjRoom);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // make sure all global lights are set for each room\r\n        for (let r = 0; r < trRooms.length; ++r) {\r\n            const oroom = objRooms[r] as IMesh;\r\n            gameData.matMgr.setUniformsFromRoom(oroom, r);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Light);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { Layer } from \"../Player/Layer\";\r\n\r\nexport class MakeLayeredMesh extends Behaviour {\r\n\r\n    public name: string = MakeLayeredMesh.name;\r\n\r\n    protected sceneData: any;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.sceneData = gameData.sceneData;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (lstObjs != null) {\r\n            lstObjs.forEach((obj) => {\r\n                const mesh = obj as IMesh,\r\n                      data = this.sceneData.objects[mesh.name],\r\n                      layer = new Layer(mesh, this.gameData);\r\n\r\n                data.layer = layer;\r\n            });\r\n        }\r\n\r\n        return [BehaviourRetCode.dontKeepBehaviour, null];\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(MakeLayeredMesh);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { Position, Quaternion } from \"../Proxy/INode\";\r\n\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { BONE } from \"../Player/Skeleton\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Lara } from \"./Lara\";\r\nimport { SystemLight } from \"../Player/SystemLight\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nconst DURATION = 0.1;\r\nconst COLOR = [0.6, 0.5, 0.1];\r\nconst DISTANCE = 3072 * 2;\r\n\r\nexport class MuzzleFlash extends Behaviour {\r\n\r\n    public name: string = MuzzleFlash.name;\r\n\r\n    protected _bhvMgr:       BehaviourManager;\r\n    protected _sysLight:     SystemLight;\r\n    protected _startTime:    number;\r\n    protected _boneNumber:   number;\r\n    protected _lightNum:     number;\r\n    protected _mesh:         IMesh;\r\n\r\n    protected static _flashId:  number = 0;\r\n    protected static _offsetL:   Position = [0, 0, 0];\r\n    protected static _offsetR:   Position = [0, 0, 0];\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this._bhvMgr = gameData.bhvMgr;\r\n        this._sysLight = gameData.sysLight;\r\n        this._startTime = -1;\r\n        this._boneNumber = 0;\r\n\r\n        this._lightNum = this._sysLight.add();\r\n        this._sysLight.setFadeout(this._lightNum, DISTANCE);\r\n\r\n        this._mesh = <any>null;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        this._startTime = -1;\r\n        this._boneNumber = this.nbhv.bone ? this.nbhv.bone : 0;\r\n\r\n        const lara = (this._bhvMgr.getBehaviour(\"Lara\") as Array<Lara>)[0];\r\n\r\n        this._mesh = this.gameData.objMgr.createMoveable(MuzzleFlash._flashId, this.gameData.sceneData.objects[lara.getObject().name].roomIndex, undefined, true, false) as IMesh;\r\n\r\n        (async() => {\r\n            const shd = await this.gameData.shdMgr.getVertexShader('TR_flash'),\r\n                  materials = this._mesh.materials;\r\n\r\n            for (let mat = 0; mat < materials.length; ++mat) {\r\n                const material = materials[mat];\r\n\r\n                material.depthWrite = false;\r\n                material.transparent = true;\r\n\r\n                material.vertexShader = shd;\r\n            }\r\n        })();\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public static onEngineInitialized(gameData: IGameData): Array<Promise<any>> {\r\n        let ofst = gameData.confMgr.vector3(\"gun > left_flashoffset\", true);\r\n\r\n        if (ofst) {\r\n            MuzzleFlash._offsetL = [ofst.x, ofst.y, ofst.z];\r\n        }\r\n\r\n        ofst = gameData.confMgr.vector3(\"gun > right_flashoffset\", true);\r\n\r\n        if (ofst) {\r\n            MuzzleFlash._offsetR = [ofst.x, ofst.y, ofst.z];\r\n        }\r\n\r\n        MuzzleFlash._flashId = gameData.confMgr.number(\"gun > flashid\", true, 0);\r\n\r\n        return [gameData.shdMgr.getVertexShader('TR_flash')];\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number): void {\r\n        if (this._startTime < 0) {\r\n            this._startTime = curTime;\r\n        }\r\n\r\n        const time = curTime - this._startTime;\r\n\r\n        if (time < DURATION) {\r\n            let intensity = (DURATION - time) * 20;\r\n\r\n            const lara = (this._bhvMgr.getBehaviour(\"Lara\") as Array<Lara>)[0],\r\n                  basis = lara.getSkeleton().getBoneDecomposition(this._boneNumber, lara.getObject());\r\n\r\n            const q: Quaternion = [0, 0, 0, 1];\r\n\r\n            glMatrix.quat.setAxisAngle(q, [1, 0, 0], -Math.PI * 0.5);\r\n\r\n            basis.rotate(q);\r\n            basis.translate(this._boneNumber == BONE.ARM_L3 ? MuzzleFlash._offsetL : MuzzleFlash._offsetR);\r\n\r\n            this._mesh.setPosition(basis.pos);\r\n            this._mesh.setQuaternion(basis.rot);\r\n\r\n            this._sysLight.setPosition(this._lightNum, basis.pos);\r\n            this._sysLight.setColor(this._lightNum, [Math.min(COLOR[0] * intensity, 1), Math.min(COLOR[1] * intensity, 1), Math.min(COLOR[2] * intensity, 1)]);\r\n        } else {\r\n            this._sysLight.remove(this._lightNum);\r\n            this.gameData.objMgr.removeObjectFromScene(this._mesh);\r\n            this._bhvMgr.removeBehaviour(this);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(MuzzleFlash);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\n\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { Braid } from \"../Player/Braid\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Lara } from \"./Lara\";\r\nimport { ObjectID } from \"../Constants\";\r\n\r\nexport class Ponytail extends Behaviour {\r\n\r\n    public name: string = Ponytail.name;\r\n\r\n    protected _braids: Array<Braid>;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this._braids = [];\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const id = this.nbhv.id, offsets_ = this.nbhv.offsets.offset, offsets: Array<any> = Array.isArray(offsets_) ? offsets_ : [offsets_], fixToHead = this.nbhv.fixtohead === 'true';\r\n\r\n        ObjectID.LaraBraid = parseInt(id);\r\n\r\n        const lara = (this.gameData.bhvMgr.getBehaviour(\"Lara\") as Array<Lara>)[0].getObject();\r\n\r\n        for (let i = 0; i < offsets.length; ++i) {\r\n            const offset = { \"x\": \"0\", \"y\": \"0\", \"z\": \"0\", ...offsets[i] };\r\n\r\n            this._braids.push(new Braid(lara, [parseFloat(offset.x), parseFloat(offset.y), parseFloat(offset.z)], this.gameData, fixToHead));\r\n        }\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public preWarm(): void {\r\n        for (let n = 0; n < 30 * 3; ++n) {\r\n            this._braids.forEach((b) => b.update(1 / 30, true));\r\n        }\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number): void {\r\n        this._braids.forEach((b) => b.update(delta));\r\n    }\r\n\r\n    public reset(): void {\r\n        this._braids.forEach((b) => b.reset());\r\n    }\r\n\r\n    public get braids(): Array<Braid> {\r\n        return this._braids;\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Ponytail);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\n\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { SystemLight } from \"../Player/SystemLight\";\r\n\r\nexport class PulsingLight extends Behaviour {\r\n\r\n    public name: string = PulsingLight.name;\r\n\r\n    protected _bhvMgr:       BehaviourManager;\r\n    protected _sysLight:     SystemLight;\r\n    protected _startTime:    number;\r\n    protected _lightNum:     number;\r\n    protected _color:       Array<number>;\r\n    protected _frequency:   number;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this._bhvMgr = gameData.bhvMgr;\r\n        this._sysLight = gameData.sysLight;\r\n        this._startTime = -1;\r\n        this._lightNum = -1;\r\n        this._color = [0, 0, 0];\r\n        this._frequency = 0;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (lstObjs == null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        const objIndex = parseInt(this.nbhv.objindex ? this.nbhv.objindex : \"0\");\r\n\r\n        this._lightNum = this._sysLight.add();\r\n        this._sysLight.setFadeout(this._lightNum, parseFloat(this.nbhv.range.max));\r\n        this._sysLight.setPosition(this._lightNum, lstObjs[objIndex].position);\r\n\r\n        this._color = [parseFloat(this.nbhv.color.r) / 255, parseFloat(this.nbhv.color.g) / 255, parseFloat(this.nbhv.color.b) / 255];\r\n        this._frequency = parseFloat(this.nbhv.frequency);\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public onFrameStarted(curTime: number, delta: number): void {\r\n        if (this._startTime < 0) {\r\n            this._startTime = curTime;\r\n        }\r\n\r\n        const time = curTime - this._startTime;\r\n\r\n        let intensity = Math.abs(Math.sin(Math.PI * time / this._frequency));\r\n\r\n        this._sysLight.setColor(this._lightNum, [this._color[0] * intensity, this._color[1] * intensity, this._color[2] * intensity]);\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(PulsingLight);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\n\r\nexport class RemoveObject extends Behaviour {\r\n\r\n    public name: string = RemoveObject.name;\r\n\r\n    private objMgr: ObjectManager;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.objMgr = gameData.objMgr;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (lstObjs) {\r\n            lstObjs.forEach((obj) => {\r\n                this.objMgr.removeObjectFromScene(obj as IMesh);\r\n            });\r\n        }\r\n\r\n        return [BehaviourRetCode.dontKeepBehaviour, null];\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(RemoveObject);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { moveableScrollAnimTileHeight } from \"../Constants\";\r\n\r\nexport class ScrollTexture extends Behaviour {\r\n\r\n    public name: string = ScrollTexture.name;\r\n\r\n    protected lstObjs: Array<IMesh>;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.lstObjs = <any>null;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (lstObjs == null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        this.lstObjs = lstObjs as Array<IMesh>;\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number): void {\r\n        for (let i = 0; i < this.lstObjs.length; ++i) {\r\n            const obj = this.lstObjs[i],\r\n                  materials = obj.materials;\r\n\r\n            for (let m = 0; m < materials.length; ++m) {\r\n                let material = materials[m],\r\n                    pgr = (curTime * 1000.0) / (5 * material.uniforms.map.height),\r\n                    h = (moveableScrollAnimTileHeight / 2.0) / material.uniforms.map.height;\r\n\r\n                pgr = pgr - h * Math.floor(pgr / h);\r\n\r\n                material.uniforms.offsetRepeat.value[1] = h - pgr;\r\n\r\n                material.uniformsUpdated([\"offsetRepeat\"]);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(ScrollTexture);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh, isMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { AnimationManager } from \"../Animation/AnimationManager\";\r\n\r\nexport class SetAnimation extends Behaviour {\r\n\r\n    public name: string = SetAnimation.name;\r\n\r\n    protected anmMgr: AnimationManager;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.anmMgr = gameData.anmMgr;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const anim = parseInt(this.nbhv.anim);\r\n\r\n        if (lstObjs !== null && lstObjs.length) {\r\n            lstObjs.forEach((obj) => isMesh(obj) ? this.anmMgr.setAnimation(obj, anim, false) : null);\r\n        }\r\n\r\n        return [BehaviourRetCode.dontKeepBehaviour, null];\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(SetAnimation);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\n\r\nexport class Sky extends Behaviour {\r\n\r\n    public name: string = Sky.name;\r\n\r\n    protected objSky: IMesh;\r\n    protected camera: ICamera;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.camera = gameData.camera;\r\n        this.objSky = <any>null;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const id = this.nbhv.id,\r\n              hide = this.nbhv.hide == 'true',\r\n              noanim = this.nbhv.noanim == 'true';\r\n\r\n        if (hide) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        this.objSky = this.gameData.objMgr.createMoveable(id, -1, undefined, false, false) as IMesh;\r\n\r\n        if (this.objSky == null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        const data = this.gameData.sceneData.objects[this.objSky.name];\r\n\r\n        data.has_anims = !noanim;\r\n\r\n        this.objSky.renderOrder = 1;\r\n        this.objSky.matrixAutoUpdate = true;\r\n\r\n        if (data.has_anims) {\r\n            this.gameData.anmMgr.setAnimation(this.objSky, 0, false);\r\n        }\r\n\r\n        this.gameData.sceneRender.remove(this.objSky);\r\n        this.gameData.sceneBackground.add(this.objSky);\r\n\r\n        const promiseShaders = Promise.all([this.gameData.shdMgr.getVertexShader('TR_sky'), this.gameData.shdMgr.getFragmentShader('TR_sky')]).then((shd) => {\r\n            const materials = this.objSky.materials;\r\n            for (let mat = 0; mat < materials.length; ++mat) {\r\n                const material = materials[mat];\r\n\r\n                material.depthWrite = false;\r\n\r\n                material.vertexShader = shd[0];\r\n                material.fragmentShader = shd[1];\r\n            }\r\n        });\r\n\r\n        return [BehaviourRetCode.keepBehaviour, [promiseShaders]];\r\n    }\r\n\r\n    public onFrameEnded(): void {\r\n        this.objSky.setPosition(this.camera.position);\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Sky);\r\n","import Engine from \"../Proxy/Engine\";\r\nimport { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\nimport SkyDome from \"../Utils/SkyDome\";\r\n\r\nexport class Skydome extends Behaviour {\r\n\r\n    public name: string = Skydome.name;\r\n\r\n    protected objSky: IMesh;\r\n    protected camera: ICamera;\r\n    protected objMgr: ObjectManager;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.objMgr = gameData.objMgr;\r\n        this.camera = gameData.camera;\r\n        this.objSky = <any>null;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const promise = this.createSkyDome().then(() => {\r\n            this.objSky.renderOrder = 0;\r\n            this.objSky.matrixAutoUpdate = true;\r\n\r\n            const skyColor = [this.nbhv.color.r / 255.0, this.nbhv.color.g / 255.0, this.nbhv.color.b / 255.0],\r\n                  material = this.objSky.materials[0];\r\n\r\n            material.depthWrite = false;\r\n            material.uniforms.tintColor.value = skyColor;\r\n\r\n            material.uniformsUpdated();\r\n        });\r\n\r\n        return [BehaviourRetCode.keepBehaviour, [promise]];\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number): void {\r\n        this.objSky.setPosition(this.camera.position);\r\n\r\n        const material = this.objSky.materials[0];\r\n\r\n        let pgr = curTime / 50.0;\r\n\r\n        material.uniforms.offsetRepeat.value[0] = pgr - Math.floor(pgr);\r\n\r\n        material.uniformsUpdated([\"offsetRepeat\"]);\r\n    }\r\n\r\n    protected createSkyDome(): Promise<any> {\r\n        const meshData = SkyDome.create(\r\n            /*curvature*/ 10.0,\r\n            /*tiling*/ 3,\r\n            /*distance*/ 2000.0,\r\n            /*orientation*/ [0, 0, 0, 1],\r\n            /*xsegments*/ 16,\r\n            /*ysegments*/ 16,\r\n            /*ySegmentsToKeep*/ 8\r\n        );\r\n\r\n        const skyTexture = this.gameData.sceneData.textures[this.gameData.sceneData.textures.length - 1];\r\n\r\n        (skyTexture as any).wrapS = (skyTexture as any).wrapT = 1000; // for threejs\r\n        (skyTexture as any).wrapU = (skyTexture as any).wrapV = 1; // for babylon - don't want to abstract that...\r\n\r\n        const uniforms = {\r\n            \"map\" :             { type: \"t\",    value: skyTexture },\r\n            \"offsetRepeat\" :    { type: \"f4\",   value: [0, 0, 1, 1] },\r\n            \"tintColor\" :       { type: \"f3\",   value: [0, 0, 0] }\r\n        };\r\n\r\n        return Promise.all([this.gameData.shdMgr.getVertexShader('TR_skydome'), this.gameData.shdMgr.getFragmentShader('TR_skydome')]).then((shd) => {\r\n            const meshb = Engine.makeMeshBuilder();\r\n\r\n            this.objSky = meshb.createMesh('skydome', this.gameData.sceneBackground, shd[0], shd[1], uniforms, meshData.vertices, meshData.faces, meshData.textures, undefined);\r\n\r\n            this.gameData.sceneData.objects['skydome'] = {\r\n                \"type\"\t\t\t\t\t: 'skydome',\r\n                \"objectid\"              : '0',\r\n                \"roomIndex\"             : -1,\r\n                \"visible\"  \t\t\t\t: true\r\n            };\r\n\r\n            this.objMgr.objectList['skydome'] = {0: [this.objSky] };\r\n        });\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Skydome);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\n\r\nexport class Sprite extends Behaviour {\r\n\r\n    public name: string = Sprite.name;\r\n\r\n    private objMgr: ObjectManager;\r\n    private camera: ICamera;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.objMgr = gameData.objMgr;\r\n        this.camera = gameData.camera;\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number): void {\r\n        // make sure the object is always facing the camera\r\n        const cameraRot = this.camera.quaternion;\r\n\r\n        const objects = Object.assign({}, this.objMgr.objectList['sprite'], this.objMgr.objectList['spriteseq']);\r\n\r\n        for (let objID in objects) {\r\n            const lstObj = objects[objID] as Array<IMesh>;\r\n\r\n            for (let i = 0; i < lstObj.length; ++i) {\r\n                const obj = lstObj[i];\r\n\r\n                obj.setQuaternion(cameraRot);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Sprite);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMaterial } from \"../Proxy/IMaterial\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\nimport { ObjectManager } from \"../Player/ObjectManager\";\r\nimport { uvRotateTileHeight } from \"../Constants\";\r\n\r\nexport class UVRotate extends Behaviour {\r\n\r\n    public name: string = UVRotate.name;\r\n\r\n    private animatedTextures: any;\r\n    private matList: Array<IMaterial>;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        this.animatedTextures = gameData.sceneData.animatedTextures;\r\n        this.matList = [];\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        if (lstObjs == null) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        for (let i = 0; i < lstObjs.length; ++i) {\r\n            const obj = lstObjs[i] as IMesh,\r\n                  materials = obj.materials;\r\n\r\n            for (let m = 0; m < materials.length; ++m) {\r\n                const material = materials[m],\r\n                      userData = material.userData;\r\n\r\n                if (!userData || !userData.animatedTexture) {\r\n                    continue;\r\n                }\r\n\r\n                const animTexture = this.animatedTextures[userData.animatedTexture.idxAnimatedTexture];\r\n\r\n                if (animTexture.scrolltexture) {\r\n                    this.matList.push(material);\r\n                }\r\n            }\r\n        }\r\n\r\n        return [BehaviourRetCode.keepBehaviour, null];\r\n    }\r\n\r\n    public onFrameEnded(curTime: number, delta: number) {\r\n        for (let i = 0; i < this.matList.length; ++i) {\r\n            let material = this.matList[i],\r\n                userData = material.userData,\r\n                animTexture = this.animatedTextures[userData.animatedTexture.idxAnimatedTexture],\r\n                coords = animTexture.animcoords[0],\r\n                pgr = (curTime * 1000.0) / (5 * material.uniforms.map.height),\r\n                h = (uvRotateTileHeight / 2.0) / material.uniforms.map.height;\r\n\r\n            pgr = pgr - h * Math.floor(pgr / h);\r\n\r\n            material.uniforms.offsetRepeat.value[0] = coords.minU - userData.animatedTexture.minU;\r\n            material.uniforms.offsetRepeat.value[1] = coords.minV - userData.animatedTexture.minV * 0.5 + h - pgr;\r\n            material.uniforms.offsetRepeat.value[3] = 0.5;\r\n\r\n            material.uniformsUpdated([\"offsetRepeat\"]);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(UVRotate);\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMesh, isMesh } from \"../Proxy/IMesh\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { Behaviour, BehaviourRetCode } from \"./Behaviour\";\r\nimport { BehaviourManager } from \"./BehaviourManager\";\r\n\r\nexport class Zbias extends Behaviour {\r\n\r\n    public name: string = Zbias.name;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        const params = this.nbhv.polygoneoffset;\r\n\r\n        if (lstObjs && params) {\r\n            const factor = params.factor, unit = params.unit;\r\n            lstObjs.forEach((obj) => {\r\n                if (isMesh(obj)) {\r\n                    const materials = obj.materials;\r\n                    for (let m = 0; m < materials.length; ++m) {\r\n                        const material = materials[m];\r\n                        material.setZBias(factor, unit);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return [BehaviourRetCode.dontKeepBehaviour, null];\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(Zbias);\r\n","import jQuery from \"jquery\";\r\n\r\nexport class ConfigManager {\r\n\r\n    protected _root:        any;\r\n    protected _levelname:   string;\r\n    protected _trversion:   string;\r\n\r\n    constructor(xmlConf: XMLDocument) {\r\n        this._root = jQuery(xmlConf);\r\n        this._levelname = \"\";\r\n        this._trversion = \"\";\r\n    }\r\n\r\n    get trversion(): string {\r\n        return this._trversion;\r\n    }\r\n\r\n    set trversion(tv: string) {\r\n        this._trversion = tv;\r\n    }\r\n\r\n    get levelName(): string {\r\n        return this._levelname;\r\n    }\r\n\r\n    set levelName(levelname: string) {\r\n        this._levelname = levelname;\r\n    }\r\n\r\n    globalParam(path: string, getnode: boolean = false): string | any {\r\n        const node: any = this._root.find('game[id=\"' + this.trversion + '\"] > global ' + path);\r\n        return getnode ? node : (node.length > 0 ? node.text() : null);\r\n    }\r\n\r\n    globalColor(path: string): any {\r\n        const r = this.globalParam(path + ' > r');\r\n        const g = this.globalParam(path + ' > g');\r\n        const b = this.globalParam(path + ' > b');\r\n\r\n        return r != null && g != null && b != null ? { r: r / 255, g: g / 255, b: b / 255 } : null;\r\n    }\r\n\r\n    param(path: string, checkinglobal: boolean = false, getnode: boolean = false): string | any {\r\n        let node: any = this._levelname ? this._root.find('game[id=\"' + this.trversion + '\"] > levels > level[id=\"' + this._levelname + '\"] ' + path) : null;\r\n        if ((!node || node.length == 0) && checkinglobal) {\r\n            node = this._root.find('game[id=\"' + this.trversion + '\"] > global ' + path);\r\n        }\r\n        return getnode ? node : (node.length > 0 ? node.text() : null);\r\n    }\r\n\r\n    color(path: string, checkinglobal: boolean = false): any {\r\n        const r = this.param(path + ' > r', checkinglobal);\r\n        const g = this.param(path + ' > g', checkinglobal);\r\n        const b = this.param(path + ' > b', checkinglobal);\r\n\r\n        return r != null && g != null && b != null ? { r: r / 255, g: g / 255, b: b / 255 } : null;\r\n    }\r\n\r\n    vector3(path: string, checkinglobal: boolean = false): any {\r\n        const x = this.param(path + ' > x', checkinglobal);\r\n        const y = this.param(path + ' > y', checkinglobal);\r\n        const z = this.param(path + ' > z', checkinglobal);\r\n\r\n        return x != null && y != null && z != null ? { x: parseFloat(x), y: parseFloat(y), z: parseFloat(z) } : null;\r\n    }\r\n\r\n    float(path: string, checkinglobal: boolean = false, defvalue: number = -Infinity): number {\r\n        const v = this.param(path, checkinglobal);\r\n\r\n        return v != null ? parseFloat(v) : defvalue;\r\n    }\r\n\r\n    number(path: string, checkinglobal: boolean = false, defvalue: number = -Infinity): number {\r\n        const v = this.param(path, checkinglobal);\r\n\r\n        return v != null ? parseInt(v) : defvalue;\r\n    }\r\n\r\n    boolean(path: string, checkinglobal: boolean = false, defvalue: boolean = false): boolean {\r\n        const v = this.param(path, checkinglobal);\r\n\r\n        return v != null ? v == 'true' : defvalue;\r\n    }\r\n}\r\n","export const baseFrameRate = 30.0;\r\nexport const uvRotateTileHeight = 64;\r\nexport const moveableScrollAnimTileHeight = 128;\r\n\r\nexport const ObjectID: { [name: string]: number } = {\r\n    \"Lara\":             0,\r\n    \"LaraJoints\":       9,\r\n    \"LaraBraid\":        -1,\r\n};\r\n","import { ConfigManager } from \"../ConfigManager\";\r\nimport { RawLevel } from \"./LevelLoader\";\r\nimport { baseFrameRate, ObjectID } from \"../Constants\";\r\nimport { Commands } from \"../Animation/Commands\";\r\nimport LevelConverterHelper from \"./LevelConverterHelper\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\ninterface mapNumberToNumber {\r\n    [id: number]: number;\r\n}\r\n\r\n/*\r\n\tConvert the JSON object created by the raw level loader to a higher level JSON scene\r\n*/\r\nexport default class LevelConverter {\r\n\r\n    private confMgr: ConfigManager;\r\n    private sc: any;\r\n    private helper: LevelConverterHelper;\r\n    private laraObjectID: number;\r\n    private movObjID2Index: mapNumberToNumber;\r\n    private objects: any;\r\n\r\n    constructor() {\r\n        this.confMgr = <any>null;\r\n        this.sc = null;\r\n        this.helper = <any>null;\r\n        this.laraObjectID = -1;\r\n        this.movObjID2Index = <any>null;\r\n        this.objects = null;\r\n    }\r\n\r\n    get sceneJSON(): any {\r\n        return this.sc;\r\n    }\r\n\r\n    // create one texture per tile\r\n    private createTextures(): void {\r\n        for (let i = 0; i < this.sc.data.trlevel.textile.length; ++i) {\r\n            const name = 'texture' + i;\r\n            this.sc.textures.push({\r\n                \"uuid\": name,\r\n                \"name\": name,\r\n                \"anisotropy\": 16,\r\n                \"flipY\": false,\r\n                \"image\": name,\r\n                \"wrap\": [1001, 1001], /* 1001=ClampToEdgeWrapping */\r\n                \"minFilter\": 1006, /* 1006=LinearFilter */\r\n                \"magFilter\": 1006\r\n            });\r\n\r\n            this.sc.images.push({\r\n                \"uuid\": name,\r\n                \"url\": this.sc.data.trlevel.textile[i]\r\n            });\r\n        }\r\n    }\r\n\r\n    // Collect the animated textures\r\n    private createAnimatedTextures(): void {\r\n        let i = 0, adata = this.sc.data.trlevel.animatedTextures, numAnimatedTextures = adata[i++];\r\n        const animatedTextures = [], mapObjTexture2AnimTexture: any = {};\r\n        while (numAnimatedTextures-- > 0) {\r\n            let numTextures = adata[i++] + 1, snumTextures = numTextures,\r\n                anmcoords = [];\r\n            while (numTextures-- > 0) {\r\n                const texture = adata[i++], tex = this.sc.data.trlevel.objectTextures[texture], tile = tex.tile & 0x7FFF;\r\n                const isTri = (tex.tile & 0x8000) != 0;\r\n\r\n                let minU = 0x7FFF, minV = 0x7FFF, numVertices = isTri ? 3 : 4;\r\n\r\n                mapObjTexture2AnimTexture[texture] = { idxAnimatedTexture: animatedTextures.length, pos: snumTextures - numTextures - 1 };\r\n\r\n                for (let j = 0; j < numVertices; j++) {\r\n                    const u = tex.vertices[j].Xpixel,\r\n                          v = tex.vertices[j].Ypixel;\r\n\r\n                    if (minU > u) { minU = u; } if (minV > v) { minV = v; }\r\n                }\r\n\r\n                anmcoords.push({ minU: (minU + 0.5) / this.sc.data.trlevel.atlas.width, minV: (minV + 0.5) / this.sc.data.trlevel.atlas.height, texture: \"\" + tile});\r\n            }\r\n\r\n            animatedTextures.push({\r\n                \"animcoords\": anmcoords,\r\n                \"animspeed\" : this.sc.data.trlevel.rversion == 'TR1' ? 5 : this.sc.data.trlevel.rversion == 'TR2' ? 6 : 14,\r\n                \"scrolltexture\" : (animatedTextures.length < this.sc.data.trlevel.animatedTexturesUVCount)\r\n            });\r\n        }\r\n\r\n        this.sc.data.animatedTextures = animatedTextures;\r\n        this.sc.data.trlevel.mapObjTexture2AnimTexture = mapObjTexture2AnimTexture; // => to know for each objTexture if it is part of an animated texture, and if yes which is its starting position in the sequence\r\n    }\r\n\r\n    private createAllStaticMeshes(): void {\r\n        for (let s = 0; s < this.sc.data.trlevel.staticMeshes.length; ++s) {\r\n            const smesh = this.sc.data.trlevel.staticMeshes[s],\r\n                  meshIndex = smesh.mesh,\r\n                  objectID = smesh.objectID,\r\n                  flags = smesh.flags;\r\n\r\n            const mesh = this.sc.data.trlevel.meshes[meshIndex];\r\n            const meshJSON = this.helper.createNewGeometryData();\r\n\r\n            const tiles2material = {};\r\n\r\n            this.helper.makeMeshGeometry(mesh, meshJSON, tiles2material, this.sc.data.trlevel.objectTextures, this.sc.data.trlevel.mapObjTexture2AnimTexture);\r\n\r\n            const materials = this.helper.makeMaterialList(tiles2material, 'mesh', 'mesh' + meshIndex);\r\n\r\n            this.sc.geometries.push({\r\n                \"uuid\": 'mesh' + meshIndex,\r\n                \"type\": \"BufferGeometry\",\r\n                \"data\": meshJSON\r\n            });\r\n\r\n            const meshid = 'staticmesh' + objectID;\r\n\r\n            this.sc.materials.push(...materials);\r\n\r\n            this.objects.push({\r\n                \"uuid\"          : meshid,\r\n                \"type\"          : \"Mesh\",\r\n                \"name\"          : meshid,\r\n                \"geometry\" \t\t: 'mesh' + meshIndex,\r\n                \"material\" \t\t: materials.map((m) => m.uuid),\r\n                \"position\" \t\t: [ 0, 0, 0 ],\r\n                \"quaternion\" \t: [ 0, 0, 0, 1 ],\r\n                \"scale\"\t   \t\t: [ 1, 1, 1 ]\r\n            });\r\n\r\n            this.sc.data.objects[meshid] = {\r\n                \"type\"\t\t\t: 'staticmesh',\r\n                \"raw\"           : smesh,\r\n                \"roomIndex\"\t\t: -1,\r\n                \"objectid\"      : objectID,\r\n                \"visible\"  \t\t: false,\r\n                \"flags\"         : flags\r\n            };\r\n        }\r\n    }\r\n\r\n    private createAllSprites(): void {\r\n        for (let s = 0; s < this.sc.data.trlevel.spriteTextures.length; ++s) {\r\n            const sprite = this.sc.data.trlevel.spriteTextures[s];\r\n\r\n            const geometry: any = this.createSpriteSeq(s);\r\n\r\n            const spriteid = 'sprite' + s;\r\n\r\n            this.sc.materials.push(...geometry.materials);\r\n\r\n            this.objects.push({\r\n                \"uuid\"          : spriteid,\r\n                \"type\"          : \"Mesh\",\r\n                \"name\"          : spriteid,\r\n                \"geometry\" \t\t: geometry.uuid,\r\n                \"material\" \t\t: geometry.materials.map((m: any) => m.uuid),\r\n                \"position\" \t\t: [ 0, 0, 0 ],\r\n                \"quaternion\" \t: [ 0, 0, 0, 1 ],\r\n                \"scale\"\t   \t\t: [ 1, 1, 1 ]\r\n            });\r\n\r\n            this.sc.data.objects[spriteid] = {\r\n                \"type\"\t\t\t: 'sprite',\r\n                \"raw\"           : sprite,\r\n                \"roomIndex\"\t\t: -1,\r\n                \"objectid\"      : s,\r\n                \"visible\"  \t\t: false\r\n            };\r\n        }\r\n    }\r\n\r\n    //  create a sprite sequence: if there's more than one sprite in the sequence, we create an animated texture\r\n    private createSpriteSeq(spriteSeq: number | any): any {\r\n\r\n        let spriteIndex, numSprites = 1, spriteid;\r\n\r\n        if (typeof(spriteSeq) == 'number') {\r\n            // case where this function is called to create a single sprite in a room\r\n\r\n            spriteIndex = spriteSeq;\r\n            spriteSeq = null;\r\n            spriteid = 'sprite' + spriteIndex;\r\n\r\n            if (spriteIndex >= this.sc.data.trlevel.spriteTextures.length) {\r\n                console.log('spriteindex', spriteIndex, 'is too big: only', this.sc.data.trlevel.spriteTextures.length, 'sprites in this.sc.data.trlevel.spriteTextures !');\r\n                return false;\r\n            }\r\n\r\n        } else {\r\n            // case where this function is called to create a sprite sequence\r\n\r\n            spriteIndex = spriteSeq.offset;\r\n            numSprites = -spriteSeq.negativeLength;\r\n            spriteid = 'spriteseq' + spriteSeq.objectID;\r\n        }\r\n\r\n        let sprite = this.sc.data.trlevel.spriteTextures[spriteIndex],\r\n            meshJSON = this.helper.createNewGeometryData(),\r\n            tiles2material = {};\r\n\r\n        delete meshJSON.attributes.vertColor;\r\n        delete meshJSON.attributes._flags;\r\n\r\n        meshJSON.vertices.push(sprite.leftSide,  -sprite.topSide,       0);\r\n        meshJSON.vertices.push(sprite.leftSide,  -sprite.bottomSide,    0);\r\n        meshJSON.vertices.push(sprite.rightSide, -sprite.bottomSide,    0);\r\n        meshJSON.vertices.push(sprite.rightSide, -sprite.topSide,       0);\r\n\r\n        const texturedRectangles = [\r\n                {\r\n                    vertices: [0, 1, 2, 3],\r\n                    texture: 0x8000,\r\n                }\r\n            ];\r\n        const width = (sprite.width - 255) / 256,\r\n              height = (sprite.height - 255) / 256;\r\n        let row = 0, col = 0, tile = sprite.tile;\r\n        if (this.sc.data.trlevel.atlas.make) {\r\n            row = Math.floor(tile / this.sc.data.trlevel.atlas.numColPerRow), col = tile - row * this.sc.data.trlevel.atlas.numColPerRow;\r\n            tile = 0;\r\n        }\r\n        const objectTextures = [\r\n                {\r\n                    attributes: 0,\r\n                    tile: tile,\r\n                    origTile: tile,\r\n                    vertices: [\r\n                        { Xpixel: sprite.x + col * 256, \t\tYpixel: sprite.y + row * 256 },\r\n                        { Xpixel: sprite.x + col * 256, \t\tYpixel: sprite.y + height - 1 + row * 256 },\r\n                        { Xpixel: sprite.x + width - 1 + col * 256, Ypixel: sprite.y + height - 1 + row * 256 },\r\n                        { Xpixel: sprite.x + width - 1 + col * 256, Ypixel: sprite.y + row * 256 }\r\n                    ]\r\n                }\r\n        ];\r\n\r\n        const mapObjTexture2AnimTexture: any = {};\r\n\r\n        if (numSprites > 1 && this.sc.data.animatedTextures) {\r\n            const anmcoords = [];\r\n            mapObjTexture2AnimTexture[0] = { idxAnimatedTexture: this.sc.data.animatedTextures.length, pos: 0 };\r\n            for (let i = 0; i < numSprites; ++i) {\r\n                sprite = this.sc.data.trlevel.spriteTextures[spriteIndex + i];\r\n                tile = sprite.tile;\r\n                if (this.sc.data.trlevel.atlas.make) {\r\n                    row = Math.floor(tile / this.sc.data.trlevel.atlas.numColPerRow), col = tile - row * this.sc.data.trlevel.atlas.numColPerRow;\r\n                    tile = 0;\r\n                }\r\n                anmcoords.push({ minU: (sprite.x + col * 256 + 0.5) / this.sc.data.trlevel.atlas.width, minV: (sprite.y + row * 256 + 0.5) / this.sc.data.trlevel.atlas.height, texture: \"\" + tile});\r\n            }\r\n            this.sc.data.animatedTextures.push({\r\n                \"animcoords\": anmcoords,\r\n                \"animspeed\" : 20\r\n            });\r\n        }\r\n\r\n        this.helper.makeFaces(meshJSON, [texturedRectangles], tiles2material, objectTextures, mapObjTexture2AnimTexture, 0);\r\n\r\n        const materials = this.helper.makeMaterialList(tiles2material, 'sprite', spriteid);\r\n\r\n        this.sc.geometries.push({\r\n            \"uuid\": spriteid,\r\n            \"type\": \"BufferGeometry\",\r\n            \"data\": meshJSON\r\n        });\r\n\r\n        return {\r\n            \"uuid\": spriteid,\r\n            \"materials\": materials\r\n        };\r\n    }\r\n\r\n    // generate the rooms + static meshes + sprites in the room\r\n    private createRooms(): void {\r\n        // flag the alternate rooms\r\n        for (let m = 0; m < this.sc.data.trlevel.rooms.length; ++m) {\r\n            this.sc.data.trlevel.rooms[m].isAlternate = false;\r\n        }\r\n\r\n        for (let m = 0; m < this.sc.data.trlevel.rooms.length; ++m) {\r\n            const room = this.sc.data.trlevel.rooms[m],\r\n                  alternate = room.alternateRoom;\r\n            if (alternate != -1) {\r\n                this.sc.data.trlevel.rooms[alternate].isAlternate = true;\r\n            }\r\n        }\r\n\r\n        let maxLightsInRoom = 0, roomL = -1;\r\n\r\n        // generate the rooms\r\n        for (let m = 0; m < this.sc.data.trlevel.rooms.length; ++m) {\r\n            const room = this.sc.data.trlevel.rooms[m],\r\n                  info = room.info, rdata = room.roomData, rflags = room.flags, lightMode = room.lightMode,\r\n                  isFilledWithWater = (rflags & 1) != 0, isFlickering = (lightMode == 1);\r\n\r\n            const roomMesh: any = {\r\n                \"uuid\"              : \"room\" + m,\r\n                \"type\"              : \"Mesh\",\r\n                \"name\"              : \"room\" + m,\r\n                \"geometry\" \t\t\t: \"room\" + m,\r\n                \"position\" \t\t\t: [ 0, 0, 0 ],\r\n                \"quaternion\" \t\t: [ 0, 0, 0, 1 ],\r\n                \"scale\"\t   \t\t\t: [ 1, 1, 1 ]\r\n            };\r\n\r\n            this.objects.push(roomMesh);\r\n\r\n            const roomData: any = {\r\n                \"type\"\t\t\t\t: 'room',\r\n                \"raw\"               : room,\r\n                \"isAlternateRoom\" \t: room.isAlternate,\r\n                \"filledWithWater\"\t: isFilledWithWater,\r\n                \"flickering\"\t\t: isFlickering,\r\n                \"roomIndex\"\t\t\t: m,\r\n                \"objectid\"          : m,\r\n                \"visible\"  \t\t\t: !room.isAlternate\r\n            };\r\n\r\n            this.sc.data.objects['room' + m] = roomData;\r\n\r\n            // lights in the room\r\n            if (room.lights.length > maxLightsInRoom) {\r\n                maxLightsInRoom = room.lights.length;\r\n                roomL = m;\r\n            }\r\n\r\n            const ambientColor = glMatrix.vec3.create();\r\n            if (this.sc.data.trlevel.rversion != 'TR4') {\r\n                const ambient1 = 1.0 - room.ambientIntensity1 / 0x2000;\r\n                glMatrix.vec3.set(ambientColor, ambient1, ambient1, ambient1);\r\n            } else {\r\n                const rc = room.roomColour;\r\n                ambientColor[0] = ((rc & 0xFF0000) >> 16) / 255.0;\r\n                ambientColor[1] = ((rc & 0xFF00) >> 8)  / 255.0;\r\n                ambientColor[2] = (rc & 0xFF)  / 255.0;\r\n            }\r\n\r\n            const lights = [];\r\n            for (let l = 0; l < room.lights.length; ++l) {\r\n                const light = room.lights[l], color = [1, 1, 1];\r\n                let px = light.x, py = -light.y, pz = -light.z,\r\n                    fadeIn = 0, fadeOut = 0;\r\n                const plight: any = { type: 'point' };\r\n                switch (this.sc.data.trlevel.rversion) {\r\n                    case 'TR1':\r\n                    case 'TR2': {\r\n                        let intensity = light.intensity1;\r\n                        if (intensity > 0x2000) { intensity = 0x2000; }\r\n                        intensity = intensity / 0x2000;\r\n                        glMatrix.vec3.set(color, intensity, intensity, intensity);\r\n                        fadeOut = light.fade1;\r\n                        break;\r\n                    }\r\n                    case 'TR3': {\r\n                        const r = light.color.r / 255.0,\r\n                              g = light.color.g / 255.0,\r\n                              b = light.color.b / 255.0;\r\n                        let intensity = light.intensity;\r\n                        if (intensity > 0x2000) { intensity = 0x2000; } // without this test, cut5 in TR3 (for eg) is wrong\r\n                        intensity = intensity / 0x2000;\r\n                        glMatrix.vec3.set(color, r * intensity, g * intensity, b * intensity);\r\n                        fadeOut = light.fade;\r\n                        break;\r\n                    }\r\n                    case 'TR4': {\r\n                        if (light.lightType > 2) {\r\n                            // todo: handling of shadow / fog bulb lights\r\n                            //console.log('light not handled because of type ' + light.lightType + ' in room ' + m, room)\r\n                            continue;\r\n                        }\r\n                        const r = light.color.r / 255.0,\r\n                              g = light.color.g / 255.0,\r\n                              b = light.color.b / 255.0;\r\n                        let intensity = light.intensity;\r\n                        if (intensity > 32) { intensity = 32; }\r\n                        intensity = intensity / 16.0;\r\n                        glMatrix.vec3.set(color, r * intensity, g * intensity, b * intensity);\r\n                        switch (light.lightType) {\r\n                            case 0: // directional light\r\n                                const bb = this.helper.getBoundingBox(room.roomData.vertices);\r\n                                px = (bb[0] + bb[1]) / 2.0 + info.x;\r\n                                py = -(bb[2] + bb[3]) / 2.0;\r\n                                pz = -(bb[4] + bb[5]) / 2.0 - info.z;\r\n                                fadeOut = Math.sqrt((bb[1] - bb[0]) * (bb[1] - bb[0]) + (bb[3] - bb[2]) * (bb[3] - bb[2]) + (bb[5] - bb[4]) * (bb[5] - bb[4]));\r\n                                plight.type = 'directional';\r\n                                plight.dx = light.dx;\r\n                                plight.dy = -light.dy;\r\n                                plight.dz = -light.dz;\r\n                                break;\r\n                            case 1: // point light\r\n                                fadeIn = light.in;\r\n                                fadeOut = light.out;\r\n                                break;\r\n                            case 2: // spot light\r\n                                fadeIn = light.length;\r\n                                fadeOut = light.cutOff;\r\n                                if (fadeOut < fadeIn) {\r\n                                    fadeIn = fadeOut;\r\n                                    fadeOut = light.length;\r\n                                }\r\n                                plight.dx = light.dx;\r\n                                plight.dy = -light.dy;\r\n                                plight.dz = -light.dz;\r\n                                plight.coneCos = light.out;\r\n                                plight.penumbraCos = light.in;\r\n                                if (plight.coneCos > plight.penumbraCos) {\r\n                                    console.log('pb param spot room#' + room.roomIndex, light, room);\r\n                                }\r\n                                plight.type = 'spot';\r\n                                break;\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                if (fadeOut > 0x7FFF) { fadeOut = 0x8000; }\r\n                if (fadeIn > fadeOut) { fadeIn = 0; }\r\n                plight.x = px;\r\n                plight.y = py;\r\n                plight.z = pz;\r\n                plight.color = color;\r\n                plight.fadeIn = fadeIn;\r\n                plight.fadeOut = fadeOut;\r\n                lights.push(plight);\r\n            }\r\n\r\n            roomData.lights = lights;\r\n            roomData.ambientColor = ambientColor;\r\n\r\n            // room geometry\r\n            const roomJSON = this.helper.createNewGeometryData();\r\n\r\n            const tiles2material = {};\r\n\r\n            // push the vertices + vertex colors of the room\r\n            for (let v = 0; v < rdata.vertices.length; ++v) {\r\n                const rvertex = rdata.vertices[v],\r\n                      vertexInfo = this.helper.processRoomVertex(rvertex, isFilledWithWater);\r\n\r\n                roomJSON.vertices.push(vertexInfo.x + info.x, vertexInfo.y, vertexInfo.z - info.z);\r\n                roomJSON.colors.push(vertexInfo.color2[0], vertexInfo.color2[1], vertexInfo.color2[2]);\r\n                roomJSON._flags.push(vertexInfo.flag[0], vertexInfo.flag[1], vertexInfo.flag[2], vertexInfo.flag[3]);\r\n            }\r\n\r\n            // create the tri/quad faces\r\n            this.helper.makeFaces(roomJSON, [rdata.rectangles, rdata.triangles], tiles2material, this.sc.data.trlevel.objectTextures, this.sc.data.trlevel.mapObjTexture2AnimTexture, 0);\r\n\r\n            const materials = this.helper.makeMaterialList(tiles2material, 'room', 'room' + m);\r\n\r\n            this.sc.materials.push(...materials);\r\n\r\n            // add the room geometry to the scene\r\n            this.sc.geometries.push({\r\n                \"uuid\": \"room\" + m,\r\n                \"type\": \"BufferGeometry\",\r\n                \"data\": roomJSON\r\n            });\r\n\r\n            roomMesh.material = materials.map((m) => m.uuid);\r\n\r\n            // portal in the room\r\n            const portals = [];\r\n            for (let p = 0; p < room.portals.length; ++p) {\r\n                const portal = room.portals[p];\r\n                portals.push({\r\n                    \"adjoiningRoom\": portal.adjoiningRoom,\r\n                    \"normal\": { x: portal.normal.x, y: -portal.normal.y, z: -portal.normal.z },\r\n                    \"vertices\": [\r\n                        { x: (portal.vertices[0].x + info.x), y: -portal.vertices[0].y, z: (-portal.vertices[0].z - info.z) },\r\n                        { x: (portal.vertices[1].x + info.x), y: -portal.vertices[1].y, z: (-portal.vertices[1].z - info.z) },\r\n                        { x: (portal.vertices[2].x + info.x), y: -portal.vertices[2].y, z: (-portal.vertices[2].z - info.z) },\r\n                        { x: (portal.vertices[3].x + info.x), y: -portal.vertices[3].y, z: (-portal.vertices[3].z - info.z) }\r\n                    ]\r\n                });\r\n            }\r\n\r\n            roomData.portals = portals;\r\n        }\r\n\r\n        console.log('num max lights in a single room=' + maxLightsInRoom + '. room=' + roomL);\r\n    }\r\n\r\n    private createAnimations(): void {\r\n        const animTracks = [];\r\n\r\n        for (let anm = 0; anm < this.sc.data.trlevel.animations.length; ++anm) {\r\n            const anim: any = this.sc.data.trlevel.animations[anm];\r\n\r\n            let frameOffset = anim.frameOffset / 2,\r\n                frameStep   = anim.frameSize,\r\n                numFrames = anim.frameEnd - anim.frameStart + 1,\r\n                animNumKeys = Math.floor((numFrames - 1) / anim.frameRate) + 1;\r\n\r\n            if ((numFrames - 1) % anim.frameRate) { animNumKeys++; }\r\n\r\n            let animFPS = baseFrameRate,\r\n                animLength = ((animNumKeys - 1) * anim.frameRate) / baseFrameRate;\r\n\r\n            if (animLength == 0) {\r\n                animFPS = 1.0;\r\n                animLength = 1.0;\r\n            }\r\n\r\n            if (this.sc.data.trlevel.rversion == 'TR1') {\r\n                frameStep = this.sc.data.trlevel.frames[frameOffset + 9] * 2 + 10;\r\n            }\r\n\r\n            const animKeys = [];\r\n\r\n            for (let key = 0; key < animNumKeys; key++)\t{\r\n                let frame = frameOffset + key * frameStep, sframe = frame;\r\n\r\n                const BBLoX =  this.sc.data.trlevel.frames[frame++], BBHiX =  this.sc.data.trlevel.frames[frame++],\r\n                      BBLoY = -this.sc.data.trlevel.frames[frame++], BBHiY = -this.sc.data.trlevel.frames[frame++],\r\n                      BBLoZ = -this.sc.data.trlevel.frames[frame++], BBHiZ = -this.sc.data.trlevel.frames[frame++];\r\n\r\n                let transX = this.sc.data.trlevel.frames[frame++], transY = -this.sc.data.trlevel.frames[frame++], transZ = -this.sc.data.trlevel.frames[frame++];\r\n\r\n                let numAnimatedMeshesUnknown = 99999, numAnimatedMeshes = numAnimatedMeshesUnknown;\r\n                if (this.sc.data.trlevel.rversion == 'TR1') {\r\n                    numAnimatedMeshes = this.sc.data.trlevel.frames[frame++];\r\n                }\r\n\r\n                let mesh = 0, keyData = [];\r\n                // Loop through all the meshes of the key\r\n                while (mesh < numAnimatedMeshes) {\r\n                    let angleX = 0.0, angleY = 0.0, angleZ = 0.0;\r\n\r\n                    if (numAnimatedMeshes == numAnimatedMeshesUnknown && (frame - sframe) >= frameStep) { break; }\r\n\r\n                    let frameData = this.sc.data.trlevel.frames[frame++];\r\n                    if (frameData < 0) { frameData += 65536; }\r\n\r\n                    if ((frameData & 0xC000) && (this.sc.data.trlevel.rversion != 'TR1')) { // single axis of rotation\r\n                        let angle = this.sc.data.trlevel.rversion == 'TR4' ? (frameData & 0xFFF) >> 2 : frameData & 0x3FF;\r\n\r\n                        angle *= 360.0 / 1024.0;\r\n\r\n                        switch (frameData & 0xC000) {\r\n                            case 0x4000:\r\n                                angleX = angle;\r\n                                break;\r\n                            case 0x8000:\r\n                                angleY = angle;\r\n                                break;\r\n                            case 0xC000:\r\n                                angleZ = angle;\r\n                                break;\r\n                        }\r\n                    } else { // 3 axis of rotation\r\n                        if (numAnimatedMeshes == numAnimatedMeshesUnknown && (frame - sframe) >= frameStep) { break; }\r\n\r\n                        let frameData2 = this.sc.data.trlevel.frames[frame++];\r\n                        if (frameData2 < 0) { frameData2 += 65536; }\r\n\r\n                        if (this.sc.data.trlevel.rversion == 'TR1') {\r\n                            let temp = frameData;\r\n                            frameData = frameData2;\r\n                            frameData2 = temp;\r\n                        }\r\n\r\n                        angleX = (frameData >> 4) & 0x03FF;\r\n                        angleX *= 360.0 / 1024.0;\r\n\r\n                        angleY = (frameData << 6) & 0x03C0;\r\n                        angleY += (frameData2 >> 10) & 0x003F;\r\n                        angleY *= 360.0 / 1024.0;\r\n\r\n                        angleZ = frameData2 & 0x3FF;\r\n                        angleZ *= 360.0 / 1024.0;\r\n                    }\r\n\r\n                    angleX *= Math.PI / 180.0;\r\n                    angleY *= Math.PI / 180.0;\r\n                    angleZ *= Math.PI / 180.0;\r\n\r\n                    const qx = glMatrix.quat.create(), qy = glMatrix.quat.create(), qz = glMatrix.quat.create();\r\n\r\n                    glMatrix.quat.setAxisAngle(qx, [1, 0, 0], angleX);\r\n                    glMatrix.quat.setAxisAngle(qy, [0, 1, 0], -angleY);\r\n                    glMatrix.quat.setAxisAngle(qz, [0, 0, 1], -angleZ);\r\n\r\n                    glMatrix.quat.mul(qy, qy, qx);\r\n                    glMatrix.quat.mul(qy, qy, qz);\r\n\r\n                    keyData.push({\r\n                        \"position\": \t{ x: transX, y: transY, z: transZ },\r\n                        \"quaternion\":\t{ x: qy[0], y: qy[1], z: qy[2], w: qy[3] }\r\n                    });\r\n\r\n                    transX = transY = transZ = 0;\r\n\r\n                    mesh++;\r\n                }\r\n\r\n                animKeys.push({\r\n                    \"time\": \t\tkey * anim.frameRate,\r\n                    \"boundingBox\": \t{ xmin: BBLoX, ymin: BBHiY, zmin: BBHiZ, xmax: BBHiX, ymax: BBLoY, zmax: BBLoZ },\r\n                    \"data\":  \t\tkeyData\r\n                });\r\n\r\n            }\r\n\r\n            const animCommands = [], numAnimCommands = anim.numAnimCommands;\r\n\r\n            if (numAnimCommands < 0x100) {\r\n                let aco = anim.animCommand;\r\n                for (let ac = 0; ac < numAnimCommands; ++ac) {\r\n                    let cmd = this.sc.data.trlevel.animCommands[aco++].value, numParams = Commands.numParams[cmd];\r\n\r\n                    const command = {\r\n                        \"cmd\": cmd,\r\n                        \"params\": Array<number>()\r\n                    };\r\n\r\n                    while (numParams-- > 0) {\r\n                        command.params.push(this.sc.data.trlevel.animCommands[aco++].value);\r\n                    }\r\n\r\n                    animCommands.push(command);\r\n                }\r\n            } else {\r\n                console.log('Invalid num anim commands (' + numAnimCommands + ') ! ', anim);\r\n            }\r\n\r\n            if (this.sc.data.trlevel.animations[anim.nextAnimation] != undefined) { // to avoid bugging for lost artifact TR3 levels\r\n                animTracks.push({\r\n                    \"name\": \t\t\t\"anim\" + anm,\r\n                    \"numKeys\":  \t\tanimNumKeys,\r\n                    \"numFrames\":  \t\tnumFrames,\r\n                    \"frameRate\": \t\tanim.frameRate,\r\n                    \"fps\":  \t\t\tanimFPS,\r\n                    \"nextTrack\":  \t\tanim.nextAnimation,\r\n                    \"nextTrackFrame\": \tanim.nextFrame - this.sc.data.trlevel.animations[anim.nextAnimation].frameStart,\r\n                    \"keys\":  \t\t\tanimKeys,\r\n                    \"commands\":     \tanimCommands,\r\n                    \"frameStart\":    \tanim.frameStart\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n        this.sc.data.animTracks = animTracks;\r\n\r\n    }\r\n\r\n    private createAllMoveables(): void {\r\n        const objIdAnim: any  = this.confMgr.param('behaviour[name=\"ScrollTexture\"]', true, true),\r\n              lstIdAnim: any  =  {};\r\n\r\n        if (objIdAnim) {\r\n            for (let i = 0; i < objIdAnim.length; ++i) {\r\n                const node = objIdAnim[i];\r\n                lstIdAnim[parseInt(node.getAttribute(\"objectid\"))] = true;\r\n            }\r\n        }\r\n\r\n        for (let m = 0; m < this.sc.data.trlevel.moveables.length; ++m) {\r\n            const moveable = this.sc.data.trlevel.moveables[m];\r\n\r\n            this.createMoveable(moveable, lstIdAnim);\r\n        }\r\n    }\r\n\r\n    private createMoveable(moveable: any, lstIdAnim: any): void {\r\n        const jsonid = 'moveable' + moveable.objectID;\r\n\r\n        const objIDForVisu = this.confMgr.number('moveable[id=\"' + moveable.objectID + '\"] > visuid', true, moveable.objectID);\r\n\r\n        const moveableGeom: any = this.sc.data.trlevel.moveables[this.movObjID2Index[objIDForVisu]];\r\n\r\n        let numMeshes = moveableGeom.numMeshes, meshIndex = moveableGeom.startingMesh, meshTree = moveableGeom.meshTree,\r\n            moveableIsExternallyLit = false, materials = null, meshJSON = null;\r\n        const isDummy = numMeshes == 1 && this.sc.data.trlevel.meshes[meshIndex].dummy && !(moveableGeom.objectID == this.laraObjectID);\r\n\r\n        const trType = this.sc.data.trlevel.rversion;\r\n\r\n        if (!isDummy) {\r\n            meshJSON = this.helper.createNewGeometryData();\r\n\r\n            delete meshJSON.attributes.vertColor;\r\n\r\n            const tiles2material = {};\r\n            let stackIdx = 0, stack = [], parent = -1;\r\n            let px = 0, py = 0, pz = 0, bones = [];\r\n\r\n            meshJSON.objHasScrollAnim = moveableGeom.objectID in lstIdAnim;\r\n\r\n            meshJSON.skinIndices = [];\r\n            meshJSON.skinWeights = [];\r\n\r\n            for (let idx = 0; idx < numMeshes; ++idx, meshIndex++) {\r\n                if (idx != 0) {\r\n                    const sflag = this.sc.data.trlevel.meshTrees[meshTree++].coord;\r\n                    px = this.sc.data.trlevel.meshTrees[meshTree++].coord;\r\n                    py = this.sc.data.trlevel.meshTrees[meshTree++].coord;\r\n                    pz = this.sc.data.trlevel.meshTrees[meshTree++].coord;\r\n                    if (sflag & 1) {\r\n                        if (stackIdx == 0) { stackIdx = 1; } // some moveables can have stackPtr == -1 without this test... (look in joby1a.tr4 for eg)\r\n                        parent = stack[--stackIdx];\r\n                    }\r\n                    if (sflag & 2) {\r\n                        stack[stackIdx++] = parent;\r\n                    }\r\n                }\r\n\r\n                const mesh = this.sc.data.trlevel.meshes[meshIndex];\r\n\r\n                let isDummyMesh = true;\r\n\r\n                if (!mesh.dummy  ||  (mesh.dummy && (\r\n                    ((trType == 'TR3' || trType == 'TR4')  &&  objIDForVisu == 1  &&  idx == 1)  ||\r\n                    ((trType == 'TR1' || trType == 'TR2') &&  objIDForVisu == 0) ||\r\n                    (trType == 'TR1' && objIDForVisu == 77)\r\n                ))) {\r\n                    isDummyMesh = false;\r\n                }\r\n\r\n                if ((isDummyMesh && trType == 'TR4') || (idx == 0 && trType == 'TR4' && moveableGeom.objectID == ObjectID.LaraJoints)) {\r\n                    // dummy mesh + hack to remove bad data from joint #0 of Lara joints in TR4\r\n                } else {\r\n                    const internalLit = this.helper.makeMeshGeometry(mesh, meshJSON, tiles2material, this.sc.data.trlevel.objectTextures, this.sc.data.trlevel.mapObjTexture2AnimTexture, idx);\r\n\r\n                    moveableIsExternallyLit = moveableIsExternallyLit || !internalLit;\r\n                }\r\n\r\n                bones.push({\r\n                    \"parent\": parent,\r\n                    \"name\": \"mesh#\" + meshIndex,\r\n                    \"pos\": [ 0, 0, 0 ],\r\n                    \"pos_init\": [ px, -py, -pz ],\r\n                    \"rotq\": [ 0, 0, 0, 1]\r\n                });\r\n\r\n                parent = idx;\r\n            }\r\n\r\n            delete meshJSON.objHasScrollAnim;\r\n\r\n            materials = this.helper.makeMaterialList(tiles2material, 'moveable', jsonid);\r\n\r\n            this.sc.geometries.push({\r\n                \"uuid\": jsonid,\r\n                \"type\": \"BufferGeometry\",\r\n                \"data\": meshJSON\r\n            });\r\n\r\n            if (materials) {\r\n                this.sc.materials.push(...materials);\r\n            }\r\n\r\n            this.objects.push({\r\n                \"uuid\"                  : jsonid,\r\n                \"type\"                  : \"Mesh\",\r\n                \"name\"                  : jsonid,\r\n                \"geometry\" \t\t\t\t: !isDummy ? jsonid : null,\r\n                \"material\" \t\t\t\t: !isDummy ? materials.map((m: any) => m.uuid) : null,\r\n                \"position\" \t\t\t\t: [ 0, 0, 0 ],\r\n                \"quaternion\" \t\t\t: [ 0, 0, 0, 1 ],\r\n                \"scale\"\t   \t\t\t\t: [ 1, 1, 1 ]\r\n            });\r\n\r\n            this.sc.data.objects[jsonid] = {\r\n                \"type\"   \t\t\t\t: 'moveable',\r\n                \"raw\"                   : moveable,\r\n                \"has_anims\"\t\t\t\t: !isDummy,\r\n                \"numAnimations\"         : !isDummy ? moveable.numAnimations : 0,\r\n                \"roomIndex\"\t\t\t\t: -1,\r\n                \"animationStartIndex\"\t: moveable.animation,\r\n                \"objectid\"              : moveable.objectID,\r\n                \"visible\"  \t\t\t\t: false,\r\n                \"bonesStartingPos\"      : !isDummy ? bones : null,\r\n                \"internallyLit\"         : !moveableIsExternallyLit,\r\n                \"startingMesh\"          : moveableGeom.startingMesh\r\n            };\r\n        }\r\n    }\r\n\r\n    private createAllSpriteSequences(): void {\r\n        for (let s = 0; s < this.sc.data.trlevel.spriteSequences.length; ++s) {\r\n            const spriteSeq = this.sc.data.trlevel.spriteSequences[s];\r\n\r\n            this.createSpriteSequence(spriteSeq);\r\n        }\r\n    }\r\n\r\n    private createSpriteSequence(spriteSeq: number | any): void {\r\n        const geometry = this.createSpriteSeq(spriteSeq);\r\n\r\n        const spriteid = 'spriteseq' + spriteSeq.objectID;\r\n\r\n        this.sc.materials.push(...geometry.materials);\r\n\r\n        this.objects.push({\r\n            \"uuid\"          : spriteid,\r\n            \"type\"          : \"Mesh\",\r\n            \"name\"          : spriteid,\r\n            \"geometry\" \t    : geometry.uuid,\r\n            \"material\" \t\t: geometry.materials.map((m: any) => m.uuid),\r\n            \"position\" \t    : [ 0, 0, 0 ],\r\n            \"quaternion\"    : [ 0, 0, 0, 1 ],\r\n            \"scale\"\t   \t    : [ 1, 1, 1 ]\r\n        });\r\n\r\n        this.sc.data.objects[spriteid] = {\r\n            \"type\" \t        : 'spriteseq',\r\n            \"raw\"           : spriteSeq,\r\n            \"roomIndex\"\t    : -1,\r\n            \"objectid\"      : spriteSeq.objectID,\r\n            \"visible\"  \t    : false\r\n        };\r\n    }\r\n\r\n    private collectLightsExt(): void {\r\n        let addedLights = 0;\r\n\r\n        for (let objID in this.sc.data.objects) {\r\n            const objData = this.sc.data.objects[objID];\r\n\r\n            if (objData.type != 'room') {\r\n                continue;\r\n            }\r\n\r\n            const portals = objData.portals;\r\n\r\n            const lights = objData.lights.slice(0);\r\n            for (let p = 0; p < portals.length; ++p) {\r\n                const portal = portals[p], r = portal.adjoiningRoom, adjRoom = this.sc.data.objects['room' + r];\r\n                if (!adjRoom) { continue; }\r\n\r\n                const portalCenter = {\r\n                    x: (portal.vertices[0].x + portal.vertices[1].x + portal.vertices[2].x + portal.vertices[3].x) / 4.0,\r\n                    y: (portal.vertices[0].y + portal.vertices[1].y + portal.vertices[2].y + portal.vertices[3].y) / 4.0,\r\n                    z: (portal.vertices[0].z + portal.vertices[1].z + portal.vertices[2].z + portal.vertices[3].z) / 4.0\r\n                };\r\n\r\n                const rlights = adjRoom.lights;\r\n                for (let l = 0; l < rlights.length; ++l) {\r\n                    const rlight = rlights[l];\r\n\r\n                    switch (rlight.type) {\r\n                        case 'directional':\r\n                            continue;\r\n                    }\r\n\r\n                    const distToPortalSq =\r\n                            (portalCenter.x - rlight.x) * (portalCenter.x - rlight.x) +\r\n                            (portalCenter.y - rlight.y) * (portalCenter.y - rlight.y) +\r\n                            (portalCenter.z - rlight.z) * (portalCenter.z - rlight.z);\r\n\r\n                    if (distToPortalSq > rlight.fadeOut * rlight.fadeOut) { continue; }\r\n\r\n                    lights.push(rlight);\r\n                    addedLights++;\r\n                }\r\n            }\r\n\r\n            objData.lightsExt = lights;\r\n        }\r\n\r\n        console.log('Number of additional lights added: ' + addedLights);\r\n    }\r\n\r\n    private createVertexNormals(): void {\r\n\r\n        let vA, vB, vC, vD;\r\n        let cb, ab, db, dc, bc, cross;\r\n\r\n        for (let i = 0; i < this.sc.geometries.length; ++i) {\r\n            const geom = this.sc.geometries[i].data;\r\n\r\n            const vertices = geom.vertices,\r\n                  normals = geom.normals,\r\n                  faces = geom.faces;\r\n\r\n            for (let v = 0; v < vertices.length; ++v) {\r\n                normals.push(0);\r\n            }\r\n\r\n            for (let f = 0; f < faces.length; ++f) {\r\n                const face = faces[f], isTri = face.length == 3;\r\n\r\n                if (isTri) {\r\n                    vA = [ vertices[ face[0].idx * 3 + 0 ], vertices[ face[0].idx * 3 + 1 ], vertices[ face[0].idx * 3 + 2 ] ];\r\n                    vB = [ vertices[ face[1].idx * 3 + 0 ], vertices[ face[1].idx * 3 + 1 ], vertices[ face[1].idx * 3 + 2 ] ];\r\n                    vC = [ vertices[ face[1].idx * 3 + 0 ], vertices[ face[2].idx * 3 + 1 ], vertices[ face[2].idx * 3 + 2 ] ];\r\n\r\n                    cb = [ vC[0] - vB[0], vC[1] - vB[1], vC[2] - vB[2] ];\r\n                    ab = [ vA[0] - vB[0], vA[1] - vB[1], vA[2] - vB[2] ];\r\n                    cross = [\r\n                        cb[1] * ab[2] - cb[2] * ab[1],\r\n                        cb[2] * ab[0] - cb[0] * ab[2],\r\n                        cb[0] * ab[1] - cb[1] * ab[0]\r\n                    ];\r\n\r\n                    normals[ face[0].idx * 3 + 0 ] += cross[0]; normals[ face[0].idx * 3 + 1 ] += cross[1]; normals[ face[0].idx * 3 + 2 ] += cross[2];\r\n                    normals[ face[1].idx * 3 + 0 ] += cross[0]; normals[ face[1].idx * 3 + 1 ] += cross[1]; normals[ face[1].idx * 3 + 2 ] += cross[2];\r\n                    normals[ face[2].idx * 3 + 0 ] += cross[0]; normals[ face[2].idx * 3 + 1 ] += cross[1]; normals[ face[2].idx * 3 + 2 ] += cross[2];\r\n                } else {\r\n                    vA = [ vertices[ face[0].idx * 3 + 0 ], vertices[ face[0].idx * 3 + 1 ], vertices[ face[0].idx * 3 + 2 ] ];\r\n                    vB = [ vertices[ face[1].idx * 3 + 0 ], vertices[ face[1].idx * 3 + 1 ], vertices[ face[1].idx * 3 + 2 ] ];\r\n                    vC = [ vertices[ face[2].idx * 3 + 0 ], vertices[ face[2].idx * 3 + 1 ], vertices[ face[2].idx * 3 + 2 ] ];\r\n                    vD = [ vertices[ face[3].idx * 3 + 0 ], vertices[ face[3].idx * 3 + 1 ], vertices[ face[3].idx * 3 + 2 ] ];\r\n\r\n                    // abd\r\n\r\n                    db = [ vD[0] - vB[0], vD[1] - vB[1], vD[2] - vB[2] ];\r\n                    ab = [ vA[0] - vB[0], vA[1] - vB[1], vA[2] - vB[2] ];\r\n                    cross = [\r\n                        db[1] * ab[2] - db[2] * ab[1],\r\n                        db[2] * ab[0] - db[0] * ab[2],\r\n                        db[0] * ab[1] - db[1] * ab[0]\r\n                    ];\r\n\r\n                    normals[ face[0].idx * 3 + 0 ] += cross[0]; normals[ face[0].idx * 3 + 1 ] += cross[1]; normals[ face[0].idx * 3 + 2 ] += cross[2];\r\n                    normals[ face[1].idx * 3 + 0 ] += cross[0]; normals[ face[1].idx * 3 + 1 ] += cross[1]; normals[ face[1].idx * 3 + 2 ] += cross[2];\r\n                    normals[ face[3].idx * 3 + 0 ] += cross[0]; normals[ face[3].idx * 3 + 1 ] += cross[1]; normals[ face[3].idx * 3 + 2 ] += cross[2];\r\n\r\n                    // bcd\r\n\r\n                    dc = [ vD[0] - vC[0], vD[1] - vC[1], vD[2] - vC[2] ];\r\n                    bc = [ vB[0] - vC[0], vB[1] - vC[1], vB[2] - vC[2] ];\r\n                    cross = [\r\n                        dc[1] * bc[2] - dc[2] * bc[1],\r\n                        dc[2] * bc[0] - dc[0] * bc[2],\r\n                        dc[0] * bc[1] - dc[1] * bc[0]\r\n                    ];\r\n\r\n                    normals[ face[1].idx * 3 + 0 ] += cross[0]; normals[ face[1].idx * 3 + 1 ] += cross[1]; normals[ face[1].idx * 3 + 2 ] += cross[2];\r\n                    normals[ face[2].idx * 3 + 0 ] += cross[0]; normals[ face[2].idx * 3 + 1 ] += cross[1]; normals[ face[2].idx * 3 + 2 ] += cross[2];\r\n                    normals[ face[3].idx * 3 + 0 ] += cross[0]; normals[ face[3].idx * 3 + 1 ] += cross[1]; normals[ face[3].idx * 3 + 2 ] += cross[2];\r\n\r\n                }\r\n            }\r\n\r\n            for (let n = 0; n < normals.length / 3; ++n) {\r\n                let x = normals[n * 3 + 0], y = normals[n * 3 + 1], z = normals[n * 3 + 2];\r\n                let nrm = Math.sqrt(x * x + y * y + z * z);\r\n                if (x == 0 && y == 0 && z == 0) { x = 0; y = 1; z = 0; nrm = 1; } // it's possible some vertices are not used in the object, so normal==0 at this point - put a (fake) valid normal\r\n                normals[n * 3 + 0] = x / nrm;\r\n                normals[n * 3 + 1] = y / nrm;\r\n                normals[n * 3 + 2] = z / nrm;\r\n\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    private weldSkinJoints(mainSkinId: number, jointSkinId: number, reverse: boolean = false, parentCheck: boolean = true): void {\r\n        const joints = this.helper.getGeometryFromId('moveable' + jointSkinId).data,\r\n              jointsVertices = joints.vertices,\r\n              main = this.helper.getGeometryFromId('moveable' + mainSkinId).data,\r\n              mainVertices = main.vertices;\r\n\r\n        const bones = this.sc.data.objects['moveable' + mainSkinId].bonesStartingPos,\r\n              numBones = bones.length,\r\n              posStack: Array<any> = [];\r\n\r\n        for (let j = 0; j < numBones; ++j) {\r\n            const bone = bones[j], pos = bone.pos_init.slice(0);\r\n            if (bone.parent >= 0) {\r\n                pos[0] += posStack[bone.parent][0];\r\n                pos[1] += posStack[bone.parent][1];\r\n                pos[2] += posStack[bone.parent][2];\r\n            }\r\n            posStack.push(pos);\r\n        }\r\n\r\n        function findVertex(x: number, y: number, z: number, b1: number, b2: number): number {\r\n            let v = reverse ? mainVertices.length / 3 - 1 : 0, vmax = reverse ? 0 : mainVertices.length / 3 - 1, step = reverse ? -1 : 1;\r\n            while (v != vmax) {\r\n                const bidx = main.skinIndices[v * 2 + 0];\r\n                if (!parentCheck || bidx == b1 || bidx == b2) {\r\n                    const boneTrans = posStack[bidx],\r\n                        dx = mainVertices[v * 3 + 0] + boneTrans[0] - x, dy = mainVertices[v * 3 + 1] + boneTrans[1] - y, dz = mainVertices[v * 3 + 2] + boneTrans[2] - z,\r\n                        dist = dx * dx + dy * dy + dz * dz;\r\n                    if (dist < 24) {\r\n                        return v;\r\n                    }\r\n                }\r\n                v += step;\r\n            }\r\n            return -1;\r\n        }\r\n\r\n        for (let i = 0; i < jointsVertices.length / 3; ++i) {\r\n            const boneIdx = joints.skinIndices[i * 2 + 0],\r\n                  boneParentIdx = boneIdx > 0 ? bones[boneIdx].parent : boneIdx,\r\n                  jointTrans = posStack[boneIdx],\r\n                  x = jointsVertices[i * 3 + 0] + jointTrans[0], y = jointsVertices[i * 3 + 1] + jointTrans[1], z = jointsVertices[i * 3 + 2] + jointTrans[2];\r\n            const idx = findVertex(x, y, z, boneIdx, boneParentIdx);\r\n            if (idx >= 0) {\r\n                jointsVertices[i * 3 + 0] = mainVertices[idx * 3 + 0];\r\n                jointsVertices[i * 3 + 1] = mainVertices[idx * 3 + 1];\r\n                jointsVertices[i * 3 + 2] = mainVertices[idx * 3 + 2];\r\n                joints.normals[i * 3 + 0] = main.normals[idx * 3 + 0];\r\n                joints.normals[i * 3 + 1] = main.normals[idx * 3 + 1];\r\n                joints.normals[i * 3 + 2] = main.normals[idx * 3 + 2];\r\n                joints.skinIndices[i * 2 + 0] = main.skinIndices[idx * 2 + 0];\r\n                joints.skinIndices[i * 2 + 1] = main.skinIndices[idx * 2 + 1];\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private makeLaraBraid(): void {\r\n        const braidId =  this.confMgr.number('behaviour[name=\"Ponytail\"] > id', true, -1),\r\n              young = this.confMgr.boolean('behaviour[name=\"Ponytail\"] > young', true, false),\r\n              fixToHead = this.confMgr.boolean('behaviour[name=\"Ponytail\"] > fixtohead', true, false);\r\n\r\n        if (braidId < 0) { return; }\r\n\r\n        const braid = this.helper.getGeometryFromId('moveable' + braidId).data,\r\n              vertices = braid.vertices,\r\n              normals = braid.normals;\r\n\r\n        function copyCoord(src: number, dst: number) {\r\n            vertices[dst * 3 + 0] = vertices[src * 3 + 0];\r\n            vertices[dst * 3 + 1] = vertices[src * 3 + 1];\r\n            vertices[dst * 3 + 2] = vertices[src * 3 + 2];\r\n            normals[dst * 3 + 0] = normals[src * 3 + 0];\r\n            normals[dst * 3 + 1] = normals[src * 3 + 1];\r\n            normals[dst * 3 + 2] = normals[src * 3 + 2];\r\n        }\r\n\r\n        if (this.sc.data.trlevel.rversion == 'TR4') {\r\n            if (!young) {\r\n                if (fixToHead) {\r\n                    this.weldSkinJoints(braidId, braidId, true, false);\r\n\r\n                    const perms = [\r\n                        [0,1,2,3], [0,1,3,2], [0,2,1,3], [0,2,3,1], [0,3,1,2], [0,3,2,1],\r\n                        [1,0,2,3], [1,0,3,2], [1,2,0,3], [1,2,3,0], [1,3,0,2], [1,3,2,0],\r\n                        [2,0,1,3], [2,0,3,1], [2,1,0,3], [2,1,3,0], [2,3,0,1], [2,3,1,0],\r\n                        [3,0,1,2], [3,0,2,1], [3,1,0,2], [3,1,2,0], [3,2,0,1], [3,2,1,0],\r\n                    ]\r\n\r\n                    for (let j = 0; j < 4; ++j) {\r\n                        const perm = perms[9];\r\n                        copyCoord(8 + perm[j], 4 + j);\r\n                    }\r\n\r\n                    vertices[0 * 3 + 0] -= 6;\r\n                    vertices[0 * 3 + 1] -= 13;\r\n                    vertices[0 * 3 + 2] -= 40;\r\n\r\n                    vertices[1 * 3 + 0] -= 6;\r\n                    vertices[1 * 3 + 1] -= 13;\r\n                    vertices[1 * 3 + 2] -= 17;\r\n\r\n                    vertices[2 * 3 + 0] -= 1;\r\n                    vertices[2 * 3 + 1] -= 10;\r\n                    vertices[2 * 3 + 2] -= 18;\r\n\r\n                    vertices[3 * 3 + 0] += 2;\r\n                    vertices[3 * 3 + 1] -= 8;\r\n                    vertices[3 * 3 + 2] -= 42;\r\n                } else {\r\n                    this.weldSkinJoints(braidId, braidId);\r\n\r\n                    vertices[0 * 3 + 0] -= 5;\r\n                    vertices[1 * 3 + 0] -= 5;\r\n                    vertices[2 * 3 + 0] += 5;\r\n                    vertices[3 * 3 + 0] += 5;\r\n                }\r\n            } else {\r\n                this.weldSkinJoints(braidId, braidId);\r\n            }\r\n        } else {\r\n            this.weldSkinJoints(braidId, braidId);\r\n        }\r\n    }\r\n\r\n    private makeSkinnedLara(): void {\r\n        const laraID = 0;\r\n\r\n        this.weldSkinJoints(laraID, ObjectID.LaraJoints);\r\n\r\n        const joints = this.helper.getGeometryFromId('moveable' + ObjectID.LaraJoints).data,\r\n              main = this.helper.getGeometryFromId('moveable' + laraID).data,\r\n              mainVertices = main.vertices;\r\n\r\n        let numMatInMain = 0;\r\n        for (let f = 0; f < main.faces.length; ++f) {\r\n            const face = main.faces[f];\r\n            numMatInMain = Math.max(numMatInMain, face.matIndex + 1);\r\n        }\r\n\r\n        const faces = joints.faces;\r\n        for (let f = 0; f < faces.length; ++f) {\r\n            let face = faces[f];\r\n            face.matIndex += this.sc.data.trlevel.atlas.make ? 0 : numMatInMain;\r\n            for (let v = 0; v < face.length; ++v) {\r\n                face[v].idx += mainVertices.length / 3;\r\n            }\r\n        }\r\n\r\n        main._flags = main._flags.concat(joints._flags);\r\n        main.colors = main.colors.concat(joints.colors);\r\n        main.faces = main.faces.concat(joints.faces);\r\n        main.normals = main.normals.concat(joints.normals);\r\n        main.skinIndices = main.skinIndices.concat(joints.skinIndices);\r\n        main.skinWeights = main.skinWeights.concat(joints.skinWeights);\r\n        main.vertices = main.vertices.concat(joints.vertices);\r\n\r\n        const laraObject = this.helper.getObjectFromId('moveable' + laraID);\r\n        const laraJointObject = this.helper.getObjectFromId('moveable' + ObjectID.LaraJoints);\r\n\r\n        if (!this.sc.data.trlevel.atlas.make) {\r\n            laraObject.material = laraObject.material.concat(laraJointObject.material);\r\n        }\r\n\r\n        this.sc.geometries.splice(this.sc.geometries.indexOf(this.helper.getGeometryFromId('moveable' + ObjectID.LaraJoints)), 1);\r\n        this.objects.splice(this.objects.indexOf(laraJointObject), 1);\r\n    }\r\n\r\n    private makeGeometryData(): void {\r\n        for (let i = 0; i < this.sc.geometries.length; ++i) {\r\n            const geom = this.sc.geometries[i].data;\r\n\r\n            const attributes = geom.attributes,\r\n                  vertices = geom.vertices,\r\n                  normals = geom.normals,\r\n                  colors = attributes.vertColor ? geom.colors : null,\r\n                  _flags = attributes._flags ? geom._flags : null,\r\n                  skinIndices = geom.skinIndices,\r\n                  skinWeights = geom.skinWeights,\r\n                  faces = geom.faces;\r\n\r\n            if (skinIndices) {\r\n                geom.attributes['skinIndex'] = {\r\n                    \"itemSize\": 4,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                };\r\n                geom.attributes['skinWeight'] = {\r\n                    \"itemSize\": 4,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                };\r\n            }\r\n\r\n            const indices = [];\r\n\r\n            for (let f = 0; f < faces.length; ++f) {\r\n                const face = faces[f];\r\n\r\n                const matIndex = face.matIndex, posIdx = attributes.position.array.length / 3;\r\n                for (let v = 0; v < face.length; ++v) {\r\n                    const vertex = face[v];\r\n                    attributes.position.array.push(vertices[vertex.idx * 3 + 0], vertices[vertex.idx * 3 + 1], vertices[vertex.idx * 3 + 2]);\r\n                    attributes.uv.array.push(vertex.u, vertex.v);\r\n                    attributes.normal.array.push(normals[vertex.idx * 3 + 0], normals[vertex.idx * 3 + 1], normals[vertex.idx * 3 + 2]);\r\n                    if (colors) {\r\n                        attributes.vertColor.array.push(colors[vertex.idx * 3 + 0], colors[vertex.idx * 3 + 1], colors[vertex.idx * 3 + 2]);\r\n                    }\r\n                    if (_flags) {\r\n                        attributes._flags.array.push(_flags[vertex.idx * 4 + 0], _flags[vertex.idx * 4 + 1], _flags[vertex.idx * 4 + 2], _flags[vertex.idx * 4 + 3]);\r\n                    }\r\n                    if (skinIndices) {\r\n                        attributes.skinIndex.array.push(skinIndices[vertex.idx * 2 + 0], skinIndices[vertex.idx * 2 + 1], 0, 0);\r\n                    }\r\n                    if (skinWeights) {\r\n                        attributes.skinWeight.array.push(skinWeights[vertex.idx * 2 + 0], skinWeights[vertex.idx * 2 + 1], 0, 0);\r\n                    }\r\n                }\r\n\r\n                let lsti: Array<number> = indices[matIndex];\r\n                if (!lsti) {\r\n                    lsti = [];\r\n                    indices[matIndex] = lsti;\r\n                }\r\n\r\n                if (face.length == 3) {\r\n                    lsti.push(posIdx, posIdx + 1, posIdx + 2);\r\n                } else {\r\n                    lsti.push(posIdx, posIdx + 1, posIdx + 3);\r\n                    lsti.push(posIdx + 1, posIdx + 2, posIdx + 3);\r\n                }\r\n            }\r\n\r\n            geom.groups = [];\r\n\r\n            for (let i = 0, ofst = 0; i < indices.length; ++i) {\r\n                const lst = indices[i];\r\n                geom.groups.push({ \"start\": ofst, \"count\": lst.length, \"materialIndex\": i });\r\n                ofst += lst.length;\r\n                geom.index.array.push.apply(geom.index.array, lst);\r\n            }\r\n\r\n            delete geom.vertices;\r\n            delete geom.faces;\r\n            delete geom.colors;\r\n            delete geom.normals;\r\n            delete geom._flags;\r\n            delete geom.skinIndices;\r\n            delete geom.skinWeights;\r\n        }\r\n    }\r\n\r\n    public convert(trlevel: RawLevel) {\r\n        glMatrix.glMatrix.setMatrixArrayType(Array);\r\n\r\n        this.confMgr = trlevel.confMgr;\r\n\r\n        this.sc =  {\r\n            \"metadata\": {\r\n                \"version\": 4.3,\r\n                \"type\" : \"Object\"\r\n            },\r\n\r\n            \"object\": {\r\n                \"type\": \"Scene\",\r\n                \"children\": [ ]\r\n            },\r\n\r\n            \"geometries\": [ ],\r\n\r\n            \"materials\": [ ],\r\n\r\n            \"textures\": [ ],\r\n\r\n            \"images\": [ ],\r\n\r\n            \"data\": {\r\n                \"objects\": {\r\n                },\r\n\r\n                \"trlevel\": trlevel\r\n            }\r\n        };\r\n\r\n        this.objects = this.sc.object.children;\r\n\r\n        this.sc.data.levelFileName = this.sc.data.trlevel.filename;\r\n        this.sc.data.levelShortFileName = this.sc.data.levelFileName;\r\n        this.sc.data.levelShortFileNameNoExt = this.sc.data.levelShortFileName.substring(0, this.sc.data.levelShortFileName.indexOf('.'));\r\n        this.sc.data.waterColor = {\r\n            \"in\" : this.confMgr.globalColor('water > colorin'),\r\n            \"out\" : this.confMgr.globalColor('water > colorout')\r\n        };\r\n        this.sc.data.rversion = this.sc.data.trlevel.rversion;\r\n        this.sc.data.soundPath = \"resources/sound/\" + this.sc.data.rversion.toLowerCase() + \"/\";\r\n\r\n        this.helper = new LevelConverterHelper(this.sc, this.objects);\r\n\r\n        this.laraObjectID = this.confMgr.number('lara > id', true, 0);\r\n\r\n        const hasUVRotate = this.confMgr.param('behaviour[name=\"UVRotate\"]', true, false);\r\n        if (!hasUVRotate) {\r\n            this.sc.data.trlevel.animatedTexturesUVCount = 0;\r\n        }\r\n\r\n        this.movObjID2Index = {};\r\n\r\n        for (let m = 0; m < this.sc.data.trlevel.moveables.length; ++m) {\r\n            const moveable = this.sc.data.trlevel.moveables[m];\r\n            this.movObjID2Index[moveable.objectID] = m;\r\n        }\r\n\r\n        this.objects.push({\r\n            \"uuid\"      : \"camera1\",\r\n            \"type\"      : \"PerspectiveCamera\",\r\n            \"name\"      : \"camera1\",\r\n            \"fov\"       : this.confMgr.float('camera > fov', true, 50),\r\n            \"near\"      : this.confMgr.float('camera > neardist', true, 50),\r\n            \"far\"       : this.confMgr.float('camera > fardist', true, 10000),\r\n            \"position\"  : [ 0, 0, 0 ],\r\n            \"quaternion\": [ 0, 0, 0, 1 ]\r\n        });\r\n\r\n        this.sc.data.objects['camera1'] = {\r\n            \"type\"      : \"camera\",\r\n            \"objectid\"  : 0,\r\n            \"roomIndex\" : -1,\r\n            \"visible\"   : false\r\n        };\r\n\r\n        // get the number of animations for each moveable\r\n        for (let m = 0; m < this.sc.data.trlevel.moveables.length; ++m) {\r\n            const moveable = this.sc.data.trlevel.moveables[m];\r\n\r\n            moveable.numAnimations = this.helper.numAnimationsForMoveable(m);\r\n        }\r\n\r\n        this.createTextures();\r\n\r\n        this.createAnimatedTextures();\r\n\r\n        this.createRooms();\r\n\r\n        this.collectLightsExt();\r\n\r\n        this.createAllStaticMeshes();\r\n\r\n        this.createAllMoveables();\r\n\r\n        this.createAllSprites();\r\n\r\n        this.createAllSpriteSequences();\r\n\r\n        this.createAnimations();\r\n\r\n        this.createVertexNormals();\r\n\r\n        this.makeLaraBraid();\r\n\r\n        if (this.sc.data.trlevel.rversion == 'TR4') {\r\n            this.makeSkinnedLara();\r\n        }\r\n\r\n        this.makeGeometryData();\r\n    }\r\n\r\n}\r\n","import Utils from \"../Utils/Misc\";\r\n\r\nexport default class LevelConverterHelper {\r\n\r\n    private objects: Array<any>;\r\n\r\n    constructor(public sc: any, objects: Array<any>) {\r\n        this.objects = objects;\r\n    }\r\n\r\n    public createNewGeometryData(): any {\r\n        return {\r\n            \"attributes\": {\r\n                \"position\": {\r\n                    \"itemSize\": 3,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                },\r\n                \"normal\": {\r\n                    \"itemSize\": 3,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                },\r\n                \"uv\": {\r\n                    \"itemSize\": 2,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                },\r\n                \"vertColor\": {\r\n                    \"itemSize\": 3,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                },\r\n                \"_flags\": {\r\n                    \"itemSize\": 4,\r\n                    \"type\": \"Float32Array\",\r\n                    \"array\": [],\r\n                    \"normalized\": false\r\n                }\r\n            },\r\n            \"index\": {\r\n                \"type\": \"Uint16Array\",\r\n                \"array\": []\r\n            },\r\n            \"groups\": null,\r\n\r\n            \"faces\": [],\r\n            \"vertices\": [],\r\n            \"colors\": [],\r\n            \"normals\": [],\r\n            \"_flags\": []\r\n        };\r\n    }\r\n\r\n    public createMaterial(objType: string): any {\r\n        const matName = objType;\r\n\r\n        const mat = {\r\n            \"type\": \"RawShaderMaterial\",\r\n            \"name\": matName,\r\n            \"uniforms\": {\r\n                \"map\":          { type: \"t\",  value: \"\" },\r\n                \"mapBump\":      { type: \"t\",  value: \"\" },\r\n                \"offsetBump\":   { type: \"f4\", value: [0.0, 0.0, 0.0, 0.0] },\r\n                \"ambientColor\": { type: \"f3\", value: [0.0, 0.0, 0.0] },\r\n                \"tintColor\":    { type: \"f3\", value: [1.0, 1.0, 1.0] },\r\n                \"flickerColor\": { type: \"f3\", value: [1.2, 1.2, 1.2] },\r\n                \"curTime\":      { type: \"f\",  value: 0.0 },\r\n                \"rnd\":          { type: \"f\",  value: 0.0 },\r\n                \"offsetRepeat\": { type: \"f4\", value: [0.0, 0.0, 1.0, 1.0] },\r\n                \"useFog\":       { type: \"i\",  value: 0 },\r\n                \"lighting\":     { type: \"f3\", value: [0, 0, 0] },\r\n                \"camPosition\":  { type: \"f3\", value: [0, 0, 0] }\r\n            },\r\n            \"vertexShader\": \"TR_\" + objType,\r\n            \"fragmentShader\": \"TR_standard\",\r\n            \"userData\": {}\r\n        };\r\n\r\n        return mat;\r\n    }\r\n\r\n    public getBoundingBox(vertices: Array<any>): number[] {\r\n        let xmin = 1e20, ymin = 1e20, zmin = 1e20,\r\n            xmax = -1e20, ymax = -1e20, zmax = -1e20;\r\n        for (let i = 0; i < vertices.length; ++i) {\r\n            const vertex = vertices[i].vertex;\r\n            if (xmin > vertex.x) { xmin = vertex.x; }\r\n            if (xmax < vertex.x) { xmax = vertex.x; }\r\n            if (ymin > vertex.y) { ymin = vertex.y; }\r\n            if (ymax < vertex.y) { ymax = vertex.y; }\r\n            if (zmin > vertex.z) { zmin = vertex.z; }\r\n            if (zmax < vertex.z) { zmax = vertex.z; }\r\n        }\r\n        return [xmin, xmax, ymin, ymax, zmin, zmax];\r\n    }\r\n\r\n    public processRoomVertex(rvertex: any, isFilledWithWater: boolean): any {\r\n        const vertex = rvertex.vertex, attribute = rvertex.attributes;\r\n        let lighting = 0;\r\n\r\n        switch (this.sc.data.trlevel.rversion) {\r\n            case 'TR1': {\r\n                lighting = Math.floor((1.0 - rvertex.lighting1 / 8192.) * 2 * 256);\r\n                if (lighting > 255) { lighting = 255; }\r\n                const r = lighting, g = lighting, b = lighting;\r\n                lighting = b + (g << 8) + (r << 16);\r\n                break;\r\n            }\r\n            case 'TR2': {\r\n                lighting = Math.floor((1.0 - rvertex.lighting2 / 8192.) * 2 * 256);\r\n                if (lighting > 255) { lighting = 255; }\r\n                const r = lighting, g = lighting, b = lighting;\r\n                lighting = b + (g << 8) + (r << 16);\r\n                break;\r\n            }\r\n            case 'TR3': {\r\n                lighting = rvertex.lighting2;\r\n                const r = (lighting & 0x7C00) >> 10, g = (lighting & 0x03E0) >> 5, b = (lighting & 0x001F);\r\n                lighting = ((b << 3) + 0x000007) + ((g << 11) + 0x000700) + ((r << 19) + 0x070000);\r\n                break;\r\n            }\r\n            case 'TR4': {\r\n                lighting = rvertex.lighting2;\r\n                let r = (((lighting & 0x7C00) >> 7) + 7) << 1, g = (((lighting & 0x03E0) >> 2) + 7) << 1, b = (((lighting & 0x001F) << 3) + 7) << 1;\r\n                if (r > 255) { r = 255; }\r\n                if (g > 255) { g = 255; }\r\n                if (b > 255) { b = 255; }\r\n                lighting = b + (g << 8) + (r << 16);\r\n                break;\r\n            }\r\n        }\r\n\r\n        let moveLight = (attribute & 0x4000) ? 1 : 0,\r\n            moveVertex = (attribute & 0x2000) ? 1 : 0,\r\n            strengthEffect = ((attribute & 0x1E) - 16) / 16;\r\n\r\n        if (moveVertex) { moveLight = 1; }\r\n        if ((this.sc.data.trlevel.rversion == 'TR1' || this.sc.data.trlevel.rversion == 'TR2') && isFilledWithWater) { moveLight = 1; }\r\n        if (isFilledWithWater && (attribute & 0x8000) == 0) { moveVertex = 1; }\r\n\r\n        return {\r\n            x: vertex.x, y: -vertex.y, z: -vertex.z,\r\n            flag: [moveLight, 0, moveVertex, -strengthEffect],\r\n            color: lighting,\r\n            color2: [((lighting & 0xFF0000) >> 16) / 255.0, ((lighting & 0xFF00) >> 8) / 255.0, (lighting & 0xFF) / 255.0]\r\n        };\r\n    }\r\n\r\n    public makeFace(obj: any, oface: any, tiles2material: any, tex: any, mapObjTexture2AnimTexture: any, fidx: ((v: number) => number), ofstvert: number): void {\r\n        let vertices = oface.vertices, texture = oface.texture & 0x7FFF, tile = tex.tile & 0x7FFF, origTile = tex.origTile;\r\n\r\n        if (origTile == undefined) {\r\n            origTile = tile;\r\n        }\r\n\r\n        let minU = 1, minV = 1, maxV = 0;\r\n        for (let tv = 0; tv < vertices.length; ++tv) {\r\n            const u = (tex.vertices[fidx(tv)].Xpixel + 0.5) / this.sc.data.trlevel.atlas.width,\r\n                  v = (tex.vertices[fidx(tv)].Ypixel + 0.5) / this.sc.data.trlevel.atlas.height;\r\n            if (minU > u) { minU = u; }\r\n            if (minV > v) { minV = v; }\r\n            if (maxV < v) { maxV = v; }\r\n        }\r\n\r\n        // material\r\n        let imat, alpha = (tex.attributes & 2 || oface.effects & 1) ? 'alpha' : '';\r\n        if (mapObjTexture2AnimTexture && mapObjTexture2AnimTexture[texture]) {\r\n            const animTexture = mapObjTexture2AnimTexture[texture],\r\n                  matName = 'anmtext' + alpha + '_' + animTexture.idxAnimatedTexture + '_' + animTexture.pos;\r\n            imat = tiles2material[matName];\r\n            if (typeof(imat) == 'undefined') {\r\n                imat = Utils.objSize(tiles2material);\r\n                tiles2material[matName] = { imat: imat, tile: tile, minU: minU, minV: minV, origTile: origTile };\r\n            } else {\r\n                imat = imat.imat;\r\n            }\r\n        } else if (alpha) {\r\n            imat = tiles2material['alpha' + tile];\r\n            if (typeof(imat) == 'undefined') {\r\n                imat = Utils.objSize(tiles2material);\r\n                tiles2material['alpha' + tile] = { imat: imat, tile: tile, minU: minU, minV: minV, origTile: origTile };\r\n            } else {\r\n                imat = imat.imat;\r\n            }\r\n        } else if (origTile >= this.sc.data.trlevel.numRoomTextiles + this.sc.data.trlevel.numObjTextiles) {\r\n            imat = tiles2material['bump' + origTile];\r\n            if (typeof(imat) == 'undefined') {\r\n                imat = Utils.objSize(tiles2material);\r\n                tiles2material['bump' + origTile] = { imat: imat, tile: tile, minU: minU, minV: minV, origTile: origTile };\r\n            } else {\r\n                imat = imat.imat;\r\n            }\r\n        } else {\r\n            imat = tiles2material[tile];\r\n            if (typeof(imat) == 'undefined') {\r\n                imat = Utils.objSize(tiles2material);\r\n                tiles2material[tile] = { imat: imat, tile: tile, minU: minU, minV: minV, origTile: origTile };\r\n            } else {\r\n                imat = imat.imat;\r\n            }\r\n        }\r\n\r\n        const face = [];\r\n        for (let tv = 0; tv < vertices.length; ++tv) {\r\n            let u = (tex.vertices[fidx(tv)].Xpixel + 0.5) / this.sc.data.trlevel.atlas.width,\r\n                v = (tex.vertices[fidx(tv)].Ypixel + 0.5) / this.sc.data.trlevel.atlas.height;\r\n\r\n            if (obj.objHasScrollAnim && v == maxV) {\r\n                v = minV + (maxV - minV) / 2;\r\n            }\r\n\r\n            face.push({\"u\": u, \"v\": v, \"idx\": vertices[fidx(tv)] + ofstvert});\r\n        }\r\n\r\n        (face as any).matIndex = imat;\r\n\r\n        obj.faces.push(face);\r\n    }\r\n\r\n    public makeFaces(obj: any, facearrays: Array<any>, tiles2material: any, objectTextures: any, mapObjTexture2AnimTexture: any, ofstvert: number = 0): void {\r\n        for (let a = 0; a < facearrays.length; ++a) {\r\n            const lstface = facearrays[a];\r\n            for (let i = 0; i < lstface.length; ++i) {\r\n                const o = lstface[i],\r\n                      twoSided = (o.texture & 0x8000) != 0, tex = objectTextures[o.texture & 0x7FFF];\r\n                this.makeFace(obj, o, tiles2material, tex, mapObjTexture2AnimTexture, function(idx) { return o.vertices.length - 1 - idx; }, ofstvert);\r\n                if (twoSided) {\r\n                    this.makeFace(obj, o, tiles2material, tex, mapObjTexture2AnimTexture, function(idx) { return idx; }, ofstvert);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public makeMeshGeometry(mesh: any, meshJSON: any, tiles2material: any, objectTextures: any, mapObjTexture2AnimTexture: any, skinidx: number | undefined = undefined): boolean {\r\n        const internallyLit = mesh.lights.length > 0;\r\n\r\n        const ofstvert = meshJSON.vertices.length / 3;\r\n\r\n        // push the vertices + vertex colors of the mesh\r\n        for (let v = 0; v < mesh.vertices.length; ++v) {\r\n            const vertex = mesh.vertices[v], lighting = internallyLit ? 1.0 - mesh.lights[v] / 8192.0 : 1.0;\r\n\r\n            meshJSON.vertices.push(vertex.x, -vertex.y, -vertex.z);\r\n            meshJSON.colors.push(lighting, lighting, lighting); \t// not used => a specific calculation is done in the vertex shader\r\n                                                                    // with the constant lighting for the mesh + the lighting at each vertex (passed to the shader via flags.w)\r\n            meshJSON._flags.push(0, 0, 0, lighting);\r\n\r\n            if (skinidx !== undefined) {\r\n                meshJSON.skinIndices.push(skinidx, skinidx);\r\n                meshJSON.skinWeights.push(0.5, 0.5);\r\n            }\r\n        }\r\n\r\n        this.makeFaces(meshJSON, [mesh.texturedRectangles, mesh.texturedTriangles], tiles2material, objectTextures, mapObjTexture2AnimTexture, ofstvert);\r\n\r\n        return internallyLit;\r\n    }\r\n\r\n    public makeMaterialList(tiles2material: any, matname: string, id: string): Array<any> {\r\n        if (!matname) {\r\n            matname = 'room';\r\n        }\r\n        const lstMat = [];\r\n        for (let tile in tiles2material) {\r\n            const oimat = tiles2material[tile], imat = oimat.imat, origTile = oimat.origTile,\r\n                  isAnimText = tile.substr(0, 7) == 'anmtext',\r\n                  isBump = tile.substr(0, 4) == 'bump';\r\n            let isAlphaText = tile.substr(0, 5) == 'alpha';\r\n\r\n            if (isAlphaText) { tile = tile.substr(5); }\r\n            if (isBump) { tile = oimat.tile; }\r\n\r\n            lstMat[imat] = this.createMaterial(matname);\r\n            lstMat[imat].uuid = id + '-' + imat;\r\n\r\n            if (isAnimText) {\r\n                const idxAnimText = parseInt(tile.split('_')[1]), pos = parseInt(tile.split('_')[2]);\r\n\r\n                isAlphaText = tile.substr(7, 5) == 'alpha';\r\n                lstMat[imat].uniforms.map.value = \"texture\" + oimat.tile;\r\n                lstMat[imat].uniforms.mapBump.value = \"texture\" + oimat.tile;\r\n                lstMat[imat].userData.animatedTexture = {\r\n                    \"idxAnimatedTexture\": idxAnimText,\r\n                    \"pos\": pos,\r\n                    \"minU\": oimat.minU,\r\n                    \"minV\": oimat.minV\r\n                };\r\n            } else {\r\n                lstMat[imat].uniforms.map.value = \"texture\" + tile;\r\n                lstMat[imat].uniforms.mapBump.value = \"texture\" + tile;\r\n                if (isBump) {\r\n                    if (this.sc.data.trlevel.atlas.make) {\r\n                        const row0 = Math.floor(origTile / this.sc.data.trlevel.atlas.numColPerRow), col0 = origTile - row0 * this.sc.data.trlevel.atlas.numColPerRow,\r\n                              row = Math.floor((origTile + this.sc.data.trlevel.numBumpTextiles / 2) / this.sc.data.trlevel.atlas.numColPerRow), col = (origTile + this.sc.data.trlevel.numBumpTextiles / 2) - row * this.sc.data.trlevel.atlas.numColPerRow;\r\n                        lstMat[imat].uniforms.mapBump.value = \"texture\" + tile;\r\n                        lstMat[imat].uniforms.offsetBump.value = [(col - col0) * 256.0 / this.sc.data.trlevel.atlas.width, (row - row0) * 256.0 / this.sc.data.trlevel.atlas.height, 0, 1];\r\n                    } else {\r\n                        lstMat[imat].uniforms.mapBump.value = \"texture\" + (Math.floor(origTile) + this.sc.data.trlevel.numBumpTextiles / 2);\r\n                    }\r\n                }\r\n            }\r\n            lstMat[imat].transparent = isAlphaText;\r\n\r\n        }\r\n        return lstMat;\r\n    }\r\n\r\n    public numAnimationsForMoveable(moveableIdx: number): number {\r\n        const curr_moveable = this.sc.data.trlevel.moveables[moveableIdx];\r\n\r\n        if (curr_moveable.animation != 0xFFFF) {\r\n            let next_anim_index = this.sc.data.trlevel.animations.length;\r\n            for (let i = moveableIdx + 1; i < this.sc.data.trlevel.moveables.length; ++i) {\r\n                if (this.sc.data.trlevel.moveables[i].animation != 0xFFFF) {\r\n                    next_anim_index = this.sc.data.trlevel.moveables[i].animation;\r\n                    break;\r\n                }\r\n            }\r\n            return next_anim_index - curr_moveable.animation;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    public getGeometryFromId(id: string): any {\r\n        for (let i = 0; i < this.sc.geometries.length; ++i) {\r\n            const geom = this.sc.geometries[i];\r\n            if (geom.uuid == id) {\r\n                return geom;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public getObjectFromId(id: string): any {\r\n        for (let i = 0; i < this.objects.length; ++i) {\r\n            const obj = this.objects[i];\r\n            if (obj.uuid == id) {\r\n                return obj;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n}\r\n","const descr = {\r\n    part1 : [\r\n        'version', 'uint32',\r\n        'numTextiles', 'uint32',\r\n        'textile8', ['', ['', 'uint8', 256 * 256], 'numTextiles'],\r\n        'unused1', 'uint32',\r\n        'numRooms', 'uint16',\r\n        'rooms', ['', [\r\n            'info', ['x', 'int32', 'z', 'int32', 'yBottom', 'int32', 'yTop', 'int32'],\r\n            'numData', 'uint32',\r\n            'roomData', [\r\n                'numVertices', 'uint16',\r\n                'vertices', ['', [\r\n                    'vertex', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                    'lighting1', 'uint16'\r\n                ], 'numVertices'],\r\n                'numRectangles', 'uint16',\r\n                'rectangles', ['', [\r\n                    'vertices', ['', 'uint16', 4],\r\n                    'texture', 'uint16'\r\n                ], 'numRectangles'],\r\n                'numTriangles', 'uint16',\r\n                'triangles', ['', [\r\n                    'vertices', ['', 'uint16', 3],\r\n                    'texture', 'uint16'\r\n                ], 'numTriangles'],\r\n                'numSprites', 'uint16',\r\n                'sprites', ['', [\r\n                    'vertex', 'int16',\r\n                    'texture', 'uint16'\r\n                ], 'numSprites']\r\n            ],\r\n            'numPortals', 'uint16',\r\n            'portals', ['', [\r\n                'adjoiningRoom', 'uint16',\r\n                'normal', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 4]\r\n            ], 'numPortals'],\r\n            'numZsectors', 'uint16',\r\n            'numXsectors', 'uint16',\r\n            'sectorList', ['', [\r\n                'FDindex', 'uint16',\r\n                'boxIndex', 'uint16',\r\n                'roomBelow', 'uint8',\r\n                'floor', 'int8',\r\n                'roomAbove', 'uint8',\r\n                'ceiling', 'int8'\r\n            ], function(struct: any, dataStream: any, type: any) { return struct.numZsectors * struct.numXsectors; }],\r\n            'ambientIntensity1', 'int16',\r\n            'numLights', 'uint16',\r\n            'lights', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'intensity1', 'uint16',\r\n                'fade1', 'uint32'\r\n            ], 'numLights'],\r\n            'numStaticMeshes', 'uint16',\r\n            'staticMeshes', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'rotation', 'uint16',\r\n                'intensity1', 'uint16',\r\n                'objectID', 'uint16'\r\n            ], 'numStaticMeshes'],\r\n            'alternateRoom', 'int16',\r\n            'flags', 'int16'\r\n        ], 'numRooms'],\r\n        'numFloorData', 'uint32',\r\n        'floorData', ['', 'uint16', 'numFloorData'],\r\n        'numMeshData', 'uint32'\r\n    ],\r\n\r\n    part2 : [\r\n        'center', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n        'collisionSize', 'int32',\r\n        'numVertices', 'int16',\r\n        'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 'numVertices'],\r\n        'numNormals', 'int16',\r\n        'normals', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? 0 : struct.numNormals; }],\r\n        'lights', ['', 'int16', function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? -struct.numNormals : 0; }],\r\n        'numTexturedRectangles', 'int16',\r\n        'texturedRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedRectangles'],\r\n        'numTexturedTriangles', 'int16',\r\n        'texturedTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedTriangles'],\r\n        'numColouredRectangles', 'int16',\r\n        'colouredRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numColouredRectangles'],\r\n        'numColouredTriangles', 'int16',\r\n        'colouredTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numColouredTriangles']\r\n    ],\r\n\r\n    part3 : [\r\n        'numAnimations', 'uint32',\r\n        'animations', ['', [\r\n            'frameOffset', 'uint32',\r\n            'frameRate', 'uint8',\r\n            'frameSize', 'uint8',\r\n            'stateID', 'uint16',\r\n            'speedLo', 'int16',\r\n            'speedHi', 'int16',\r\n            'accelLo', 'uint16',\r\n            'accelHi', 'int16',\r\n            'frameStart', 'uint16',\r\n            'frameEnd', 'uint16',\r\n            'nextAnimation', 'uint16',\r\n            'nextFrame', 'uint16',\r\n            'numStateChanges', 'uint16',\r\n            'stateChangeOffset', 'uint16',\r\n            'numAnimCommands', 'uint16',\r\n            'animCommand', 'uint16'\r\n        ], 'numAnimations'],\r\n        'numStateChanges', 'uint32',\r\n        'stateChanges', ['', [\r\n            'stateID', 'uint16',\r\n            'numAnimDispatches', 'uint16',\r\n            'animDispatch', 'uint16'\r\n        ], 'numStateChanges'],\r\n        'numAnimDispatches', 'uint32',\r\n        'animDispatches', ['', [\r\n            'low', 'int16',\r\n            'high', 'int16',\r\n            'nextAnimation', 'int16',\r\n            'nextFrame', 'int16'\r\n        ], 'numAnimDispatches'],\r\n        'numAnimCommands', 'uint32',\r\n        'animCommands', ['', [\r\n            'value', 'int16',\r\n        ], 'numAnimCommands'],\r\n        'numMeshTrees', 'uint32',\r\n        'meshTrees', ['', [\r\n            'coord', 'int32',\r\n        ], 'numMeshTrees'],\r\n        'numFrames', 'uint32',\r\n        'frames', ['', 'int16', 'numFrames'],\r\n        'numMoveables', 'uint32',\r\n        'moveables', ['', [\r\n            'objectID', 'uint32',\r\n            'numMeshes', 'uint16',\r\n            'startingMesh', 'uint16',\r\n            'meshTree', 'uint32',\r\n            'frameOffset', 'uint32',\r\n            'animation', 'uint16'\r\n        ], 'numMoveables'],\r\n        'numStaticMeshes', 'uint32',\r\n        'staticMeshes', ['', [\r\n            'objectID', 'uint32',\r\n            'mesh', 'uint16',\r\n            'boundingBox', ['', ['minx', 'int16', 'maxx', 'int16', 'miny', 'int16', 'maxy', 'int16', 'minz', 'int16', 'maxz', 'int16'], 2],\r\n            'flags', 'uint16'\r\n        ], 'numStaticMeshes'],\r\n        'numObjectTextures', 'uint32',\r\n        'objectTextures', ['', [\r\n            'attributes', 'uint16',\r\n            'tile', 'uint16',\r\n            'vertices', ['', ['Xcoordinate', 'int8', 'Xpixel', 'uint8', 'Ycoordinate', 'int8', 'Ypixel', 'uint8'], 4]\r\n        ], 'numObjectTextures'],\r\n        'numSpriteTextures', 'uint32',\r\n        'spriteTextures', ['', [\r\n            'tile', 'uint16',\r\n            'x', 'uint8',\r\n            'y', 'uint8',\r\n            'width', 'uint16',\r\n            'height', 'uint16',\r\n            'leftSide', 'int16',\r\n            'topSide', 'int16',\r\n            'rightSide', 'int16',\r\n            'bottomSide', 'int16'\r\n        ], 'numSpriteTextures'],\r\n        'numSpriteSequences', 'uint32',\r\n        'spriteSequences', ['', [\r\n            'objectID', 'int32',\r\n            'negativeLength', 'int16',\r\n            'offset', 'int16'\r\n        ], 'numSpriteSequences'],\r\n/*\t\t'palette', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8'], 256],*/\r\n        'numCameras', 'uint32',\r\n        'cameras', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'room', 'int16',\r\n            'unknown', 'uint16'\r\n        ], 'numCameras'],\r\n        'numSoundSources', 'uint32',\r\n        'soundSources', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'soundID', 'uint16',\r\n            'flags', 'uint16'\r\n        ], 'numSoundSources'],\r\n        'numBoxes', 'uint32',\r\n        'boxes', ['', [\r\n            'Zmin', 'uint32',\r\n            'Zmax', 'uint32',\r\n            'Xmin', 'uint32',\r\n            'Xmax', 'uint32',\r\n            'trueFloor', 'int16',\r\n            'overlapIndex', 'int16'\r\n        ], 'numBoxes'],\r\n        'numOverlaps', 'uint32',\r\n        'overlaps', ['', 'uint16', 'numOverlaps'],\r\n        'zones', ['', ['id', 'int16', 6], 'numBoxes'],\r\n        'numAnimatedTextures', 'uint32',\r\n        'animatedTextures', ['', 'uint16', 'numAnimatedTextures'],\r\n        'numItems', 'uint32',\r\n        'items', ['', [\r\n            'objectID', 'int16',\r\n            'room', 'int16',\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'angle', 'uint16',\r\n            'intensity1', 'int16',\r\n            'flags', 'uint16'\r\n        ], 'numItems'],\r\n        'lightmap', ['', 'uint8', 32 * 256],\r\n        'palette', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8'], 256],\r\n        'numCinematicFrames', 'uint16',\r\n        'cinematicFrames', ['', [\r\n            'targetX', 'int16',\r\n            'targetY', 'int16',\r\n            'targetZ', 'int16',\r\n            'posX', 'int16',\r\n            'posY', 'int16',\r\n            'posZ', 'int16',\r\n            'fov', 'int16',\r\n            'roll', 'int16'\r\n        ], 'numCinematicFrames'],\r\n        'numDemoData', 'uint16',\r\n        'demoData', ['', 'uint8', 'numDemoData'],\r\n        'soundMap', ['', 'int16', 256],\r\n        'numSoundDetails', 'uint32',\r\n        'soundDetails', ['', [\r\n            'sample', 'int16',\r\n            'volume', 'int16',\r\n            'unknown1', 'int16',\r\n            'unknown2', 'int16'\r\n        ], 'numSoundDetails'],\r\n        'numSamples', 'uint32',\r\n        'samples', ['', 'uint8', 'numSamples'],\r\n        'numSampleIndices', 'uint32',\r\n        'sampleIndices', ['', 'uint32', 'numSampleIndices']\r\n    ]\r\n};\r\n\r\nexport default descr;","const descr = {\r\n    part1 : [\r\n        'version', 'uint32',\r\n        'numTextiles', 'uint32',\r\n        'textile8', ['', ['', 'uint8', 256 * 256], 'numTextiles'],\r\n        'unused1', 'uint32',\r\n        'numRooms', 'uint16',\r\n        'rooms', ['', [\r\n            'info', ['x', 'int32', 'z', 'int32', 'yBottom', 'int32', 'yTop', 'int32'],\r\n            'numData', 'uint32',\r\n            'roomData', [\r\n                'numVertices', 'uint16',\r\n                'vertices', ['', [\r\n                    'vertex', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                    'lighting1', 'uint16'\r\n                ], 'numVertices'],\r\n                'numRectangles', 'uint16',\r\n                'rectangles', ['', [\r\n                    'vertices', ['', 'uint16', 4],\r\n                    'texture', 'uint16'\r\n                ], 'numRectangles'],\r\n                'numTriangles', 'uint16',\r\n                'triangles', ['', [\r\n                    'vertices', ['', 'uint16', 3],\r\n                    'texture', 'uint16'\r\n                ], 'numTriangles'],\r\n                'numSprites', 'uint16',\r\n                'sprites', ['', [\r\n                    'vertex', 'int16',\r\n                    'texture', 'uint16'\r\n                ], 'numSprites']\r\n            ],\r\n            'numPortals', 'uint16',\r\n            'portals', ['', [\r\n                'adjoiningRoom', 'uint16',\r\n                'normal', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 4]\r\n            ], 'numPortals'],\r\n            'numZsectors', 'uint16',\r\n            'numXsectors', 'uint16',\r\n            'sectorList', ['', [\r\n                'FDindex', 'uint16',\r\n                'boxIndex', 'uint16',\r\n                'roomBelow', 'uint8',\r\n                'floor', 'int8',\r\n                'roomAbove', 'uint8',\r\n                'ceiling', 'int8'\r\n            ], function(struct: any, dataStream: any, type: any) { return struct.numZsectors * struct.numXsectors; }],\r\n            'ambientIntensity1', 'int16',\r\n            'numLights', 'uint16',\r\n            'lights', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'intensity1', 'uint16',\r\n                'fade1', 'uint32'\r\n            ], 'numLights'],\r\n            'numStaticMeshes', 'uint16',\r\n            'staticMeshes', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'rotation', 'uint16',\r\n                'intensity1', 'uint16',\r\n                'objectID', 'uint16'\r\n            ], 'numStaticMeshes'],\r\n            'alternateRoom', 'int16',\r\n            'flags', 'int16'\r\n        ], 'numRooms'],\r\n        'numFloorData', 'uint32',\r\n        'floorData', ['', 'uint16', 'numFloorData'],\r\n        'numMeshData', 'uint32'\r\n    ],\r\n\r\n    part2 : [\r\n        'center', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n        'collisionSize', 'int32',\r\n        'numVertices', 'int16',\r\n        'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 'numVertices'],\r\n        'numNormals', 'int16',\r\n        'normals', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? 0 : struct.numNormals; }],\r\n        'lights', ['', 'int16', function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? -struct.numNormals : 0; }],\r\n        'numTexturedRectangles', 'int16',\r\n        'texturedRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedRectangles'],\r\n        'numTexturedTriangles', 'int16',\r\n        'texturedTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedTriangles'],\r\n        'numColouredRectangles', 'int16',\r\n        'colouredRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numColouredRectangles'],\r\n        'numColouredTriangles', 'int16',\r\n        'colouredTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numColouredTriangles']\r\n    ],\r\n\r\n    part3 : [\r\n        'numAnimations', 'uint32',\r\n        'animations', ['', [\r\n            'frameOffset', 'uint32',\r\n            'frameRate', 'uint8',\r\n            'frameSize', 'uint8',\r\n            'stateID', 'uint16',\r\n            'speedLo', 'int16',\r\n            'speedHi', 'int16',\r\n            'accelLo', 'uint16',\r\n            'accelHi', 'int16',\r\n            'frameStart', 'uint16',\r\n            'frameEnd', 'uint16',\r\n            'nextAnimation', 'uint16',\r\n            'nextFrame', 'uint16',\r\n            'numStateChanges', 'uint16',\r\n            'stateChangeOffset', 'uint16',\r\n            'numAnimCommands', 'uint16',\r\n            'animCommand', 'uint16'\r\n        ], 'numAnimations'],\r\n        'numStateChanges', 'uint32',\r\n        'stateChanges', ['', [\r\n            'stateID', 'uint16',\r\n            'numAnimDispatches', 'uint16',\r\n            'animDispatch', 'uint16'\r\n        ], 'numStateChanges'],\r\n        'numAnimDispatches', 'uint32',\r\n        'animDispatches', ['', [\r\n            'low', 'int16',\r\n            'high', 'int16',\r\n            'nextAnimation', 'int16',\r\n            'nextFrame', 'int16'\r\n        ], 'numAnimDispatches'],\r\n        'numAnimCommands', 'uint32',\r\n        'animCommands', ['', [\r\n            'value', 'int16',\r\n        ], 'numAnimCommands'],\r\n        'numMeshTrees', 'uint32',\r\n        'meshTrees', ['', [\r\n            'coord', 'int32',\r\n        ], 'numMeshTrees'],\r\n        'numFrames', 'uint32',\r\n        'frames', ['', 'int16', 'numFrames'],\r\n        'numMoveables', 'uint32',\r\n        'moveables', ['', [\r\n            'objectID', 'uint32',\r\n            'numMeshes', 'uint16',\r\n            'startingMesh', 'uint16',\r\n            'meshTree', 'uint32',\r\n            'frameOffset', 'uint32',\r\n            'animation', 'uint16'\r\n        ], 'numMoveables'],\r\n        'numStaticMeshes', 'uint32',\r\n        'staticMeshes', ['', [\r\n            'objectID', 'uint32',\r\n            'mesh', 'uint16',\r\n            'boundingBox', ['', ['minx', 'int16', 'maxx', 'int16', 'miny', 'int16', 'maxy', 'int16', 'minz', 'int16', 'maxz', 'int16'], 2],\r\n            'flags', 'uint16'\r\n        ], 'numStaticMeshes'],\r\n        'numObjectTextures', 'uint32',\r\n        'objectTextures', ['', [\r\n            'attributes', 'uint16',\r\n            'tile', 'uint16',\r\n            'vertices', ['', ['Xcoordinate', 'int8', 'Xpixel', 'uint8', 'Ycoordinate', 'int8', 'Ypixel', 'uint8'], 4]\r\n        ], 'numObjectTextures'],\r\n        'numSpriteTextures', 'uint32',\r\n        'spriteTextures', ['', [\r\n            'tile', 'uint16',\r\n            'x', 'uint8',\r\n            'y', 'uint8',\r\n            'width', 'uint16',\r\n            'height', 'uint16',\r\n            'leftSide', 'int16',\r\n            'topSide', 'int16',\r\n            'rightSide', 'int16',\r\n            'bottomSide', 'int16'\r\n        ], 'numSpriteTextures'],\r\n        'numSpriteSequences', 'uint32',\r\n        'spriteSequences', ['', [\r\n            'objectID', 'int32',\r\n            'negativeLength', 'int16',\r\n            'offset', 'int16'\r\n        ], 'numSpriteSequences'],\r\n        'palette', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8'], 256],\r\n        'numCameras', 'uint32',\r\n        'cameras', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'room', 'int16',\r\n            'unknown', 'uint16'\r\n        ], 'numCameras'],\r\n        'numSoundSources', 'uint32',\r\n        'soundSources', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'soundID', 'uint16',\r\n            'flags', 'uint16'\r\n        ], 'numSoundSources'],\r\n        'numBoxes', 'uint32',\r\n        'boxes', ['', [\r\n            'Zmin', 'uint32',\r\n            'Zmax', 'uint32',\r\n            'Xmin', 'uint32',\r\n            'Xmax', 'uint32',\r\n            'trueFloor', 'int16',\r\n            'overlapIndex', 'int16'\r\n        ], 'numBoxes'],\r\n        'numOverlaps', 'uint32',\r\n        'overlaps', ['', 'uint16', 'numOverlaps'],\r\n        'zones', ['', ['id', 'int16', 6], 'numBoxes'],\r\n        'numAnimatedTextures', 'uint32',\r\n        'animatedTextures', ['', 'uint16', 'numAnimatedTextures'],\r\n        'numItems', 'uint32',\r\n        'items', ['', [\r\n            'objectID', 'int16',\r\n            'room', 'int16',\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'angle', 'uint16',\r\n            'intensity1', 'int16',\r\n            'flags', 'uint16'\r\n        ], 'numItems'],\r\n        'lightmap', ['', 'uint8', 32 * 256],\r\n        'numCinematicFrames', 'uint16',\r\n        'cinematicFrames', ['', [\r\n            'targetX', 'int16',\r\n            'targetY', 'int16',\r\n            'targetZ', 'int16',\r\n            'posX', 'int16',\r\n            'posY', 'int16',\r\n            'posZ', 'int16',\r\n            'fov', 'int16',\r\n            'roll', 'int16'\r\n        ], 'numCinematicFrames'],\r\n        'numDemoData', 'uint16',\r\n        'demoData', ['', 'uint8', 'numDemoData'],\r\n        'soundMap', ['', 'int16', 256],\r\n        'numSoundDetails', 'uint32',\r\n        'soundDetails', ['', [\r\n            'sample', 'int16',\r\n            'volume', 'int16',\r\n            'unknown1', 'int16',\r\n            'unknown2', 'int16'\r\n        ], 'numSoundDetails'],\r\n        'numSamples', 'uint32',\r\n        'samples', ['', 'uint8', 'numSamples'],\r\n        'numSampleIndices', 'uint32',\r\n        'sampleIndices', ['', 'uint32', 'numSampleIndices']\r\n    ]\r\n};\r\n\r\nexport default descr;","const descr = {\r\n    part1 : [\r\n        'version', 'uint32',\r\n        'palette', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8'], 256],\r\n        'palette16', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8', 'u', 'uint8'], 256],\r\n        'numTextiles', 'uint32',\r\n        'textile8', ['', ['', 'uint8', 256 * 256], 'numTextiles'],\r\n        'textile16', ['', ['', 'uint16', 256 * 256], 'numTextiles'],\r\n        'unused1', 'uint32',\r\n        'numRooms', 'uint16',\r\n        'rooms', ['', [\r\n            'info', ['x', 'int32', 'z', 'int32', 'yBottom', 'int32', 'yTop', 'int32'],\r\n            'numData', 'uint32',\r\n            'roomData', [\r\n                'numVertices', 'uint16',\r\n                'vertices', ['', [\r\n                    'vertex', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                    'lighting1', 'uint16',\r\n                    'attributes', 'uint16',\r\n                    'lighting2', 'int16'\r\n                ], 'numVertices'],\r\n                'numRectangles', 'uint16',\r\n                'rectangles', ['', [\r\n                    'vertices', ['', 'uint16', 4],\r\n                    'texture', 'uint16'\r\n                ], 'numRectangles'],\r\n                'numTriangles', 'uint16',\r\n                'triangles', ['', [\r\n                    'vertices', ['', 'uint16', 3],\r\n                    'texture', 'uint16'\r\n                ], 'numTriangles'],\r\n                'numSprites', 'uint16',\r\n                'sprites', ['', [\r\n                    'vertex', 'int16',\r\n                    'texture', 'uint16'\r\n                ], 'numSprites']\r\n            ],\r\n            'numPortals', 'uint16',\r\n            'portals', ['', [\r\n                'adjoiningRoom', 'uint16',\r\n                'normal', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 4]\r\n            ], 'numPortals'],\r\n            'numZsectors', 'uint16',\r\n            'numXsectors', 'uint16',\r\n            'sectorList', ['', [\r\n                'FDindex', 'uint16',\r\n                'boxIndex', 'uint16',\r\n                'roomBelow', 'uint8',\r\n                'floor', 'int8',\r\n                'roomAbove', 'uint8',\r\n                'ceiling', 'int8'\r\n            ], function(struct: any, dataStream: any, type: any) { return struct.numZsectors * struct.numXsectors; }],\r\n            'ambientIntensity1', 'int16',\r\n            'ambientIntensity2', 'int16',\r\n            'lightMode', 'int16',\r\n            'numLights', 'uint16',\r\n            'lights', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'intensity1', 'uint16',\r\n                'intensity2', 'uint16',\r\n                'fade1', 'uint32',\r\n                'fade2', 'uint32'\r\n            ], 'numLights'],\r\n            'numStaticMeshes', 'uint16',\r\n            'staticMeshes', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'rotation', 'uint16',\r\n                'intensity1', 'uint16',\r\n                'intensity2', 'uint16',\r\n                'objectID', 'uint16'\r\n            ], 'numStaticMeshes'],\r\n            'alternateRoom', 'int16',\r\n            'flags', 'int16'\r\n        ], 'numRooms'],\r\n        'numFloorData', 'uint32',\r\n        'floorData', ['', 'uint16', 'numFloorData'],\r\n        'numMeshData', 'uint32'\r\n    ],\r\n\r\n    part2 : [\r\n        'center', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n        'collisionSize', 'int32',\r\n        'numVertices', 'int16',\r\n        'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 'numVertices'],\r\n        'numNormals', 'int16',\r\n        'normals', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? 0 : struct.numNormals; }],\r\n        'lights', ['', 'int16', function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? -struct.numNormals : 0; }],\r\n        'numTexturedRectangles', 'int16',\r\n        'texturedRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedRectangles'],\r\n        'numTexturedTriangles', 'int16',\r\n        'texturedTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedTriangles'],\r\n        'numColouredRectangles', 'int16',\r\n        'colouredRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numColouredRectangles'],\r\n        'numColouredTriangles', 'int16',\r\n        'colouredTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numColouredTriangles']\r\n    ],\r\n\r\n    part3 : [\r\n        'numAnimations', 'uint32',\r\n        'animations', ['', [\r\n            'frameOffset', 'uint32',\r\n            'frameRate', 'uint8',\r\n            'frameSize', 'uint8',\r\n            'stateID', 'uint16',\r\n            'speedLo', 'int16',\r\n            'speedHi', 'int16',\r\n            'accelLo', 'uint16',\r\n            'accelHi', 'int16',\r\n            'frameStart', 'uint16',\r\n            'frameEnd', 'uint16',\r\n            'nextAnimation', 'uint16',\r\n            'nextFrame', 'uint16',\r\n            'numStateChanges', 'uint16',\r\n            'stateChangeOffset', 'uint16',\r\n            'numAnimCommands', 'uint16',\r\n            'animCommand', 'uint16'\r\n        ], 'numAnimations'],\r\n        'numStateChanges', 'uint32',\r\n        'stateChanges', ['', [\r\n            'stateID', 'uint16',\r\n            'numAnimDispatches', 'uint16',\r\n            'animDispatch', 'uint16'\r\n        ], 'numStateChanges'],\r\n        'numAnimDispatches', 'uint32',\r\n        'animDispatches', ['', [\r\n            'low', 'int16',\r\n            'high', 'int16',\r\n            'nextAnimation', 'int16',\r\n            'nextFrame', 'int16'\r\n        ], 'numAnimDispatches'],\r\n        'numAnimCommands', 'uint32',\r\n        'animCommands', ['', [\r\n            'value', 'int16',\r\n        ], 'numAnimCommands'],\r\n        'numMeshTrees', 'uint32',\r\n        'meshTrees', ['', [\r\n            'coord', 'int32',\r\n        ], 'numMeshTrees'],\r\n        'numFrames', 'uint32',\r\n        'frames', ['', 'int16', 'numFrames'],\r\n        'numMoveables', 'uint32',\r\n        'moveables', ['', [\r\n            'objectID', 'uint32',\r\n            'numMeshes', 'uint16',\r\n            'startingMesh', 'uint16',\r\n            'meshTree', 'uint32',\r\n            'frameOffset', 'uint32',\r\n            'animation', 'uint16'\r\n        ], 'numMoveables'],\r\n        'numStaticMeshes', 'uint32',\r\n        'staticMeshes', ['', [\r\n            'objectID', 'uint32',\r\n            'mesh', 'uint16',\r\n            'boundingBox', ['', ['minx', 'int16', 'maxx', 'int16', 'miny', 'int16', 'maxy', 'int16', 'minz', 'int16', 'maxz', 'int16'], 2],\r\n            'flags', 'uint16'\r\n        ], 'numStaticMeshes'],\r\n        'numObjectTextures', 'uint32',\r\n        'objectTextures', ['', [\r\n            'attributes', 'uint16',\r\n            'tile', 'uint16',\r\n            'vertices', ['', ['Xcoordinate', 'int8', 'Xpixel', 'uint8', 'Ycoordinate', 'int8', 'Ypixel', 'uint8'], 4]\r\n        ], 'numObjectTextures'],\r\n        'numSpriteTextures', 'uint32',\r\n        'spriteTextures', ['', [\r\n            'tile', 'uint16',\r\n            'x', 'uint8',\r\n            'y', 'uint8',\r\n            'width', 'uint16',\r\n            'height', 'uint16',\r\n            'leftSide', 'int16',\r\n            'topSide', 'int16',\r\n            'rightSide', 'int16',\r\n            'bottomSide', 'int16'\r\n        ], 'numSpriteTextures'],\r\n        'numSpriteSequences', 'uint32',\r\n        'spriteSequences', ['', [\r\n            'objectID', 'int32',\r\n            'negativeLength', 'int16',\r\n            'offset', 'int16'\r\n        ], 'numSpriteSequences'],\r\n        'numCameras', 'uint32',\r\n        'cameras', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'room', 'int16',\r\n            'unknown', 'uint16'\r\n        ], 'numCameras'],\r\n        'numSoundSources', 'uint32',\r\n        'soundSources', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'soundID', 'uint16',\r\n            'flags', 'uint16'\r\n        ], 'numSoundSources'],\r\n        'numBoxes', 'uint32',\r\n        'boxes', ['', [\r\n            'Zmin', 'uint8',\r\n            'Zmax', 'uint8',\r\n            'Xmin', 'uint8',\r\n            'Xmax', 'uint8',\r\n            'trueFloor', 'int16',\r\n            'overlapIndex', 'int16'\r\n        ], 'numBoxes'],\r\n        'numOverlaps', 'uint32',\r\n        'overlaps', ['', 'uint16', 'numOverlaps'],\r\n        'zones', ['', ['id', 'int16', 10], 'numBoxes'],\r\n        'numAnimatedTextures', 'uint32',\r\n        'animatedTextures', ['', 'uint16', 'numAnimatedTextures'],\r\n        'numItems', 'uint32',\r\n        'items', ['', [\r\n            'objectID', 'int16',\r\n            'room', 'int16',\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'angle', 'uint16',\r\n            'intensity1', 'int16',\r\n            'intensity2', 'int16',\r\n            'flags', 'uint16'\r\n        ], 'numItems'],\r\n        'lightmap', ['', 'uint8', 32 * 256],\r\n        'numCinematicFrames', 'uint16',\r\n        'cinematicFrames', ['', [\r\n            'targetX', 'int16',\r\n            'targetY', 'int16',\r\n            'targetZ', 'int16',\r\n            'posX', 'int16',\r\n            'posY', 'int16',\r\n            'posZ', 'int16',\r\n            'fov', 'int16',\r\n            'roll', 'int16'\r\n        ], 'numCinematicFrames'],\r\n        'numDemoData', 'uint16',\r\n        'demoData', ['', 'uint8', 'numDemoData'],\r\n        'soundMap', ['', 'int16', 370],\r\n        'numSoundDetails', 'uint32',\r\n        'soundDetails', ['', [\r\n            'sample', 'int16',\r\n            'volume', 'int16',\r\n            'unknown1', 'int16',\r\n            'unknown2', 'int16'\r\n        ], 'numSoundDetails'],\r\n        'numSampleIndices', 'uint32',\r\n        'sampleIndices', ['', 'uint32', 'numSampleIndices']\r\n    ]\r\n};\r\n\r\nexport default descr;","const descr = {\r\n    part1 : [\r\n        'version', 'uint32',\r\n        'palette', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8'], 256],\r\n        'palette16', ['', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8', 'u', 'uint8'], 256],\r\n        'numTextiles', 'uint32',\r\n        'textile8', ['', ['', 'uint8', 256 * 256], 'numTextiles'],\r\n        'textile16', ['', ['', 'uint16', 256 * 256], 'numTextiles'],\r\n        'unused1', 'uint32',\r\n        'numRooms', 'uint16',\r\n        'rooms', ['', [\r\n            'info', ['x', 'int32', 'z', 'int32', 'yBottom', 'int32', 'yTop', 'int32'],\r\n            'numData', 'uint32',\r\n            'roomData', [\r\n                'numVertices', 'uint16',\r\n                'vertices', ['', [\r\n                    'vertex', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                    'lighting1', 'uint16',\r\n                    'attributes', 'uint16',\r\n                    'lighting2', 'uint16'\r\n                ], 'numVertices'],\r\n                'numRectangles', 'uint16',\r\n                'rectangles', ['', [\r\n                    'vertices', ['', 'uint16', 4],\r\n                    'texture', 'uint16'\r\n                ], 'numRectangles'],\r\n                'numTriangles', 'uint16',\r\n                'triangles', ['', [\r\n                    'vertices', ['', 'uint16', 3],\r\n                    'texture', 'uint16'\r\n                ], 'numTriangles'],\r\n                'numSprites', 'uint16',\r\n                'sprites', ['', [\r\n                    'vertex', 'int16',\r\n                    'texture', 'uint16'\r\n                ], 'numSprites']\r\n            ],\r\n            'numPortals', 'uint16',\r\n            'portals', ['', [\r\n                'adjoiningRoom', 'uint16',\r\n                'normal', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 4]\r\n            ], 'numPortals'],\r\n            'numZsectors', 'uint16',\r\n            'numXsectors', 'uint16',\r\n            'sectorList', ['', [\r\n                'FDindex', 'uint16',\r\n                'boxIndex', 'uint16',\r\n                'roomBelow', 'uint8',\r\n                'floor', 'int8',\r\n                'roomAbove', 'uint8',\r\n                'ceiling', 'int8'\r\n            ], function(struct: any, dataStream: any, type: any) { return struct.numZsectors * struct.numXsectors; }],\r\n            'ambientIntensity1', 'int16',\r\n            'ambientIntensity2', 'int16',\r\n            'numLights', 'uint16',\r\n            'lights', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'color', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8', 'u', 'uint8'],\r\n                'intensity', 'uint32',\r\n                'fade', 'uint32'\r\n            ], 'numLights'],\r\n            'numStaticMeshes', 'uint16',\r\n            'staticMeshes', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'rotation', 'uint16',\r\n                'intensity1', 'uint16',\r\n                'intensity2', 'uint16',\r\n                'objectID', 'uint16'\r\n            ], 'numStaticMeshes'],\r\n            'alternateRoom', 'int16',\r\n            'flags', 'int16',\r\n            'roomColor', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8']\r\n        ], 'numRooms'],\r\n        'numFloorData', 'uint32',\r\n        'floorData', ['', 'uint16', 'numFloorData'],\r\n        'numMeshData', 'uint32'\r\n    ],\r\n\r\n    part2 : [\r\n        'center', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n        'collisionSize', 'int32',\r\n        'numVertices', 'int16',\r\n        'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 'numVertices'],\r\n        'numNormals', 'int16',\r\n        'normals', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? 0 : struct.numNormals; }],\r\n        'lights', ['', 'int16', function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? -struct.numNormals : 0; }],\r\n        'numTexturedRectangles', 'int16',\r\n        'texturedRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedRectangles'],\r\n        'numTexturedTriangles', 'int16',\r\n        'texturedTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numTexturedTriangles'],\r\n        'numColouredRectangles', 'int16',\r\n        'colouredRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16'\r\n        ], 'numColouredRectangles'],\r\n        'numColouredTriangles', 'int16',\r\n        'colouredTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16'\r\n        ], 'numColouredTriangles']\r\n    ],\r\n\r\n    part3 : [\r\n        'numAnimations', 'uint32',\r\n        'animations', ['', [\r\n            'frameOffset', 'uint32',\r\n            'frameRate', 'uint8',\r\n            'frameSize', 'uint8',\r\n            'stateID', 'uint16',\r\n            'speedLo', 'int16',\r\n            'speedHi', 'int16',\r\n            'accelLo', 'uint16',\r\n            'accelHi', 'int16',\r\n            'frameStart', 'uint16',\r\n            'frameEnd', 'uint16',\r\n            'nextAnimation', 'uint16',\r\n            'nextFrame', 'uint16',\r\n            'numStateChanges', 'uint16',\r\n            'stateChangeOffset', 'uint16',\r\n            'numAnimCommands', 'uint16',\r\n            'animCommand', 'uint16'\r\n        ], 'numAnimations'],\r\n        'numStateChanges', 'uint32',\r\n        'stateChanges', ['', [\r\n            'stateID', 'uint16',\r\n            'numAnimDispatches', 'uint16',\r\n            'animDispatch', 'uint16'\r\n        ], 'numStateChanges'],\r\n        'numAnimDispatches', 'uint32',\r\n        'animDispatches', ['', [\r\n            'low', 'int16',\r\n            'high', 'int16',\r\n            'nextAnimation', 'int16',\r\n            'nextFrame', 'int16'\r\n        ], 'numAnimDispatches'],\r\n        'numAnimCommands', 'uint32',\r\n        'animCommands', ['', [\r\n            'value', 'int16',\r\n        ], 'numAnimCommands'],\r\n        'numMeshTrees', 'uint32',\r\n        'meshTrees', ['', [\r\n            'coord', 'int32',\r\n        ], 'numMeshTrees'],\r\n        'numFrames', 'uint32',\r\n        'frames', ['', 'int16', 'numFrames'],\r\n        'numMoveables', 'uint32',\r\n        'moveables', ['', [\r\n            'objectID', 'uint32',\r\n            'numMeshes', 'uint16',\r\n            'startingMesh', 'uint16',\r\n            'meshTree', 'uint32',\r\n            'frameOffset', 'uint32',\r\n            'animation', 'uint16'\r\n        ], 'numMoveables'],\r\n        'numStaticMeshes', 'uint32',\r\n        'staticMeshes', ['', [\r\n            'objectID', 'uint32',\r\n            'mesh', 'uint16',\r\n            'boundingBox', ['', ['minx', 'int16', 'maxx', 'int16', 'miny', 'int16', 'maxy', 'int16', 'minz', 'int16', 'maxz', 'int16'], 2],\r\n            'flags', 'uint16'\r\n        ], 'numStaticMeshes'],\r\n        'numSpriteTextures', 'uint32',\r\n        'spriteTextures', ['', [\r\n            'tile', 'uint16',\r\n            'x', 'uint8',\r\n            'y', 'uint8',\r\n            'width', 'uint16',\r\n            'height', 'uint16',\r\n            'leftSide', 'int16',\r\n            'topSide', 'int16',\r\n            'rightSide', 'int16',\r\n            'bottomSide', 'int16'\r\n        ], 'numSpriteTextures'],\r\n        'numSpriteSequences', 'uint32',\r\n        'spriteSequences', ['', [\r\n            'objectID', 'int32',\r\n            'negativeLength', 'int16',\r\n            'offset', 'int16'\r\n        ], 'numSpriteSequences'],\r\n        'numCameras', 'uint32',\r\n        'cameras', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'room', 'int16',\r\n            'unknown', 'uint16'\r\n        ], 'numCameras'],\r\n        'numSoundSources', 'uint32',\r\n        'soundSources', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'soundID', 'uint16',\r\n            'flags', 'uint16'\r\n        ], 'numSoundSources'],\r\n        'numBoxes', 'uint32',\r\n        'boxes', ['', [\r\n            'Zmin', 'uint8',\r\n            'Zmax', 'uint8',\r\n            'Xmin', 'uint8',\r\n            'Xmax', 'uint8',\r\n            'trueFloor', 'int16',\r\n            'overlapIndex', 'int16'\r\n        ], 'numBoxes'],\r\n        'numOverlaps', 'uint32',\r\n        'overlaps', ['', 'uint16', 'numOverlaps'],\r\n        'zones', ['', ['id', 'int16', 10], 'numBoxes'],\r\n        'numAnimatedTextures', 'uint32',\r\n        'animatedTextures', ['', 'uint16', 'numAnimatedTextures'],\r\n        'numObjectTextures', 'uint32',\r\n        'objectTextures', ['', [\r\n            'attributes', 'uint16',\r\n            'tile', 'uint16',\r\n            'vertices', ['', ['Xcoordinate', 'int8', 'Xpixel', 'uint8', 'Ycoordinate', 'int8', 'Ypixel', 'uint8'], 4]\r\n        ], 'numObjectTextures'],\r\n        'numItems', 'uint32',\r\n        'items', ['', [\r\n            'objectID', 'int16',\r\n            'room', 'int16',\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'angle', 'uint16',\r\n            'intensity1', 'int16',\r\n            'intensity2', 'int16',\r\n            'flags', 'uint16'\r\n        ], 'numItems'],\r\n        'lightmap', ['', 'uint8', 32 * 256],\r\n        'numCinematicFrames', 'uint16',\r\n        'cinematicFrames', ['', [\r\n            'targetX', 'int16',\r\n            'targetY', 'int16',\r\n            'targetZ', 'int16',\r\n            'posX', 'int16',\r\n            'posY', 'int16',\r\n            'posZ', 'int16',\r\n            'fov', 'int16',\r\n            'roll', 'int16'\r\n        ], 'numCinematicFrames'],\r\n        'numDemoData', 'uint16',\r\n        'demoData', ['', 'uint8', 'numDemoData'],\r\n        'soundMap', ['', 'int16', 370],\r\n        'numSoundDetails', 'uint32',\r\n        'soundDetails', ['', [\r\n            'sample', 'int16',\r\n            'volume', 'int16',\r\n            'unknown1', 'int16',\r\n            'unknown2', 'int16'\r\n        ], 'numSoundDetails'],\r\n        'numSampleIndices', 'uint32',\r\n        'sampleIndices', ['', 'uint32', 'numSampleIndices']\r\n    ]\r\n};\r\n\r\nexport default descr;\r\n","import { LevelLoader } from \"../LevelLoader\";\r\n\r\nconst descr = {\r\n    part1 : [\r\n        'version', 'uint32',\r\n        'numRoomTextiles', 'uint16',\r\n        'numObjTextiles', 'uint16',\r\n        'numBumpTextiles', 'uint16',\r\n        'textile32_uncompSize', 'uint32',\r\n        'textile32_compSize', 'uint32',\r\n        '', function(dataStream: any, struct: any) { LevelLoader.unzip(dataStream, struct, struct.textile32_compSize); return ''; },\r\n        'textile32', ['', ['', 'uint32', 256 * 256], function(struct: any, dataStream: any, type: any)\r\n            { return struct.numRoomTextiles + struct.numObjTextiles + struct.numBumpTextiles; }],\r\n        'textile16_uncompSize', 'uint32',\r\n        'textile16_compSize', 'uint32',\r\n        '', function(dataStream: any, struct: any) { dataStream.position += struct.textile16_compSize; return ''; },\r\n        'textile32misc_uncompSize', 'uint32',\r\n        'textile32misc_compSize', 'uint32',\r\n        '', function(dataStream: any, struct: any) { LevelLoader.unzip(dataStream, struct, struct.textile32misc_compSize); return ''; },\r\n        'textile32misc', ['', ['', 'uint32', 256 * 256], 2],\r\n        'levelData_uncompSize', 'uint32',\r\n        'levelData_compSize', 'uint32',\r\n        '', function(dataStream: any, struct: any) { LevelLoader.unzip(dataStream, struct, struct.levelData_compSize); return ''; },\r\n        'unused', 'uint32',\r\n        'numRooms', 'uint16',\r\n        'rooms', ['', [\r\n            'info', ['x', 'int32', 'z', 'int32', 'yBottom', 'int32', 'yTop', 'int32'],\r\n            'numData', 'uint32',\r\n            'roomData', [\r\n                'numVertices', 'uint16',\r\n                'vertices', ['', [\r\n                    'vertex', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                    'lighting1', 'uint16',\r\n                    'attributes', 'uint16',\r\n                    'lighting2', 'uint16'\r\n                ], 'numVertices'],\r\n                'numRectangles', 'uint16',\r\n                'rectangles', ['', [\r\n                    'vertices', ['', 'uint16', 4],\r\n                    'texture', 'uint16'\r\n                ], 'numRectangles'],\r\n                'numTriangles', 'uint16',\r\n                'triangles', ['', [\r\n                    'vertices', ['', 'uint16', 3],\r\n                    'texture', 'uint16'\r\n                ], 'numTriangles'],\r\n                'numSprites', 'uint16',\r\n                'sprites', ['', [\r\n                    'vertex', 'int16',\r\n                    'texture', 'uint16'\r\n                ], 'numSprites']\r\n            ],\r\n            'numPortals', 'uint16',\r\n            'portals', ['', [\r\n                'adjoiningRoom', 'uint16',\r\n                'normal', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n                'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 4]\r\n            ], 'numPortals'],\r\n            'numZsectors', 'uint16',\r\n            'numXsectors', 'uint16',\r\n            'sectorList', ['', [\r\n                'FDindex', 'uint16',\r\n                'boxIndex', 'uint16',\r\n                'roomBelow', 'uint8',\r\n                'floor', 'int8',\r\n                'roomAbove', 'uint8',\r\n                'ceiling', 'int8'\r\n            ], function(struct: any, dataStream: any, type: any) { return struct.numZsectors * struct.numXsectors; }],\r\n            'roomColour', 'uint32',\r\n            'numLights', 'uint16',\r\n            'lights', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'color', ['r', 'uint8', 'g', 'uint8', 'b', 'uint8'],\r\n                'lightType', 'uint8',\r\n                'filler', 'uint8',\r\n                'intensity', 'uint8',\r\n                'in', 'float32',\r\n                'out', 'float32',\r\n                'length', 'float32',\r\n                'cutOff', 'float32',\r\n                'dx', 'float32',\r\n                'dy', 'float32',\r\n                'dz', 'float32'\r\n            ], 'numLights'],\r\n            'numStaticMeshes', 'uint16',\r\n            'staticMeshes', ['', [\r\n                'x', 'int32',\r\n                'y', 'int32',\r\n                'z', 'int32',\r\n                'rotation', 'uint16',\r\n                'intensity1', 'uint16',\r\n                'intensity2', 'uint16',\r\n                'objectID', 'uint16'\r\n            ], 'numStaticMeshes'],\r\n            'alternateRoom', 'int16',\r\n            'flags', 'int16',\r\n            'waterScheme', 'uint8',\r\n            'reverbInfo', 'uint8',\r\n            'alternateGroup', 'uint8'\r\n        ], 'numRooms'],\r\n        'numFloorData', 'uint32',\r\n        'floorData', ['', 'uint16', 'numFloorData'],\r\n        'numMeshData', 'uint32'\r\n    ],\r\n\r\n    part2 : [\r\n        'center', ['x', 'int16', 'y', 'int16', 'z', 'int16'],\r\n        'collisionSize', 'int32',\r\n        'numVertices', 'int16',\r\n        'vertices', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], 'numVertices'],\r\n        'numNormals', 'int16',\r\n        'normals', ['', ['x', 'int16', 'y', 'int16', 'z', 'int16'], function(struct: any, dataStream: any, type: any) { return struct.numNormals < 0 ? 0 : struct.numNormals; }],\r\n        'lights', ['', 'int16', function(struct: any, dataStream: any, type: any) { return struct.numNormals <= 0 ? -struct.numNormals : 0; }],\r\n        'numTexturedRectangles', 'int16',\r\n        'texturedRectangles', ['', [\r\n            'vertices', ['', 'uint16', 4],\r\n            'texture', 'uint16',\r\n            'effects', 'uint16'\r\n        ], 'numTexturedRectangles'],\r\n        'numTexturedTriangles', 'int16',\r\n        'texturedTriangles', ['', [\r\n            'vertices', ['', 'uint16', 3],\r\n            'texture', 'uint16',\r\n            'effects', 'uint16'\r\n        ], 'numTexturedTriangles']\r\n    ],\r\n\r\n    part3 : [\r\n        'numAnimations', 'uint32',\r\n        'animations', ['', [\r\n            'frameOffset', 'uint32',\r\n            'frameRate', 'uint8',\r\n            'frameSize', 'uint8',\r\n            'stateID', 'uint16',\r\n            'speedLo', 'int16',\r\n            'speedHi', 'int16',\r\n            'accelLo', 'uint16',\r\n            'accelHi', 'int16',\r\n            'speedLateralLo', 'int16',\r\n            'speedLateralHi', 'int16',\r\n            'accelLateralLo', 'uint16',\r\n            'accelLateralHi', 'int16',\r\n            'frameStart', 'uint16',\r\n            'frameEnd', 'uint16',\r\n            'nextAnimation', 'uint16',\r\n            'nextFrame', 'uint16',\r\n            'numStateChanges', 'uint16',\r\n            'stateChangeOffset', 'uint16',\r\n            'numAnimCommands', 'uint16',\r\n            'animCommand', 'uint16'\r\n        ], 'numAnimations'],\r\n        'numStateChanges', 'uint32',\r\n        'stateChanges', ['', [\r\n            'stateID', 'uint16',\r\n            'numAnimDispatches', 'uint16',\r\n            'animDispatch', 'uint16'\r\n        ], 'numStateChanges'],\r\n        'numAnimDispatches', 'uint32',\r\n        'animDispatches', ['', [\r\n            'low', 'int16',\r\n            'high', 'int16',\r\n            'nextAnimation', 'int16',\r\n            'nextFrame', 'int16'\r\n        ], 'numAnimDispatches'],\r\n        'numAnimCommands', 'uint32',\r\n        'animCommands', ['', [\r\n            'value', 'int16',\r\n        ], 'numAnimCommands'],\r\n        'numMeshTrees', 'uint32',\r\n        'meshTrees', ['', [\r\n            'coord', 'int32',\r\n        ], 'numMeshTrees'],\r\n        'numFrames', 'uint32',\r\n        'frames', ['', 'int16', 'numFrames'],\r\n        'numMoveables', 'uint32',\r\n        'moveables', ['', [\r\n            'objectID', 'uint32',\r\n            'numMeshes', 'uint16',\r\n            'startingMesh', 'uint16',\r\n            'meshTree', 'uint32',\r\n            'frameOffset', 'uint32',\r\n            'animation', 'uint16'\r\n        ], 'numMoveables'],\r\n        'numStaticMeshes', 'uint32',\r\n        'staticMeshes', ['', [\r\n            'objectID', 'uint32',\r\n            'mesh', 'uint16',\r\n            'boundingBox', ['', ['minx', 'int16', 'maxx', 'int16', 'miny', 'int16', 'maxy', 'int16', 'minz', 'int16', 'maxz', 'int16'], 2],\r\n            'flags', 'uint16'\r\n        ], 'numStaticMeshes'],\r\n        'spr', ['', 'uint8', 3],\r\n        'numSpriteTextures', 'uint32',\r\n        'spriteTextures', ['', [\r\n            'tile', 'uint16',\r\n            'x', 'uint8',\r\n            'y', 'uint8',\r\n            'width', 'uint16',\r\n            'height', 'uint16',\r\n            'leftSide', 'int16',\r\n            'topSide', 'int16',\r\n            'rightSide', 'int16',\r\n            'bottomSide', 'int16'\r\n        ], 'numSpriteTextures'],\r\n        'numSpriteSequences', 'uint32',\r\n        'spriteSequences', ['', [\r\n            'objectID', 'int32',\r\n            'negativeLength', 'int16',\r\n            'offset', 'int16'\r\n        ], 'numSpriteSequences'],\r\n        'numCameras', 'uint32',\r\n        'cameras', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'room', 'int16',\r\n            'flag', 'uint16'\r\n        ], 'numCameras'],\r\n        'numFlybyCameras', 'uint32',\r\n        'flybyCameras', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'dx', 'int32',\r\n            'dy', 'int32',\r\n            'dz', 'int32',\r\n            'sequence', 'uint8',\r\n            'index', 'uint8',\r\n            'fov', 'uint16',\r\n            'roll', 'int16',\r\n            'timer', 'uint16',\r\n            'speed', 'uint16',\r\n            'flags', 'uint16',\r\n            'roomID', 'uint32'\r\n        ], 'numFlybyCameras'],\r\n        'numSoundSources', 'uint32',\r\n        'soundSources', ['', [\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'soundID', 'uint16',\r\n            'flags', 'uint16'\r\n        ], 'numSoundSources'],\r\n        'numBoxes', 'uint32',\r\n        'boxes', ['', [\r\n            'Zmin', 'uint8',\r\n            'Zmax', 'uint8',\r\n            'Xmin', 'uint8',\r\n            'Xmax', 'uint8',\r\n            'trueFloor', 'int16',\r\n            'overlapIndex', 'int16'\r\n        ], 'numBoxes'],\r\n        'numOverlaps', 'uint32',\r\n        'overlaps', ['', 'uint16', 'numOverlaps'],\r\n        'zones', ['', ['id', 'int16', 10], 'numBoxes'],\r\n        'numAnimatedTextures', 'uint32',\r\n        'animatedTextures', ['', 'uint16', 'numAnimatedTextures'],\r\n        'animatedTexturesUVCount', 'uint8',\r\n        'tex', ['', 'uint8', 3],\r\n        'numObjectTextures', 'uint32',\r\n        'objectTextures', ['', [\r\n            'attributes', 'uint16',\r\n            'tile', 'uint16',\r\n            'newFlags', 'uint16',\r\n            'vertices', ['', ['Xcoordinate', 'int8', 'Xpixel', 'uint8', 'Ycoordinate', 'int8', 'Ypixel', 'uint8'], 4],\r\n            'originalU', 'uint32',\r\n            'originalV', 'uint32',\r\n            'width', 'uint32',\r\n            'height', 'uint32'\r\n        ], 'numObjectTextures'],\r\n        'numItems', 'uint32',\r\n        'items', ['', [\r\n            'objectID', 'int16',\r\n            'room', 'int16',\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'angle', 'int16',\r\n            'intensity1', 'int16',\r\n            'ocb', 'int16',\r\n            'flags', 'uint16'\r\n        ], 'numItems'],\r\n        'numAIObjects', 'uint32',\r\n        'aiObjects', ['', [\r\n            'typeID', 'uint16',\r\n            'room', 'uint16',\r\n            'x', 'int32',\r\n            'y', 'int32',\r\n            'z', 'int32',\r\n            'ocb', 'int16',\r\n            'flags', 'uint16',\r\n            'angle', 'int32'\r\n        ], 'numAIObjects'],\r\n        'numDemoData', 'uint16',\r\n        'demoData', ['', 'uint8', 'numDemoData'],\r\n        'soundMap', ['', 'int16', 370],\r\n        'numSoundDetails', 'uint32',\r\n        'soundDetails', ['', [\r\n            'sample', 'int16',\r\n            'volume', 'int16',\r\n            'unknown1', 'int16',\r\n            'unknown2', 'int16'\r\n        ], 'numSoundDetails'],\r\n        'numSampleIndices', 'uint32',\r\n        'sampleIndices', ['', 'uint32', 'numSampleIndices']\r\n        // we don't read the sample data\r\n    ]\r\n};\r\n\r\nexport default descr;","import jQuery from \"jquery\";\r\nimport pako from \"pako\";\r\n\r\nimport Utils from \"../Utils/Misc\";\r\n\r\nimport TR1Descr from \"./LevelDescription/TR1\";\r\nimport TR1TubDescr from \"./LevelDescription/TR1Tub\";\r\nimport TR2Descr from \"./LevelDescription/TR2\";\r\nimport TR3Descr from \"./LevelDescription/TR3\";\r\nimport TR4Descr from \"./LevelDescription/TR4\";\r\nimport { ConfigManager } from \"../ConfigManager\";\r\n\r\ndeclare var DataStream: any;\r\n\r\nconst gameFormatDescr: any = {\r\n    \"TR1\":      TR1Descr,\r\n    \"TR1TUB\":   TR1TubDescr,\r\n    \"TR2\":      TR2Descr,\r\n    \"TR3\":      TR3Descr,\r\n    \"TR4\":      TR4Descr,\r\n};\r\n\r\nexport enum levelVersion {\r\n    TR1 = \"TR1\",\r\n    TR2 = \"TR2\",\r\n    TR3 = \"TR3\",\r\n    TR4 = \"TR4\",\r\n}\r\n\r\nexport interface RawLevel {\r\n    confMgr:                    ConfigManager;\r\n    filename:                   string; // name of the level with extension. eg: palaces.tr4\r\n    shortfilename:              string; // name of the level without extension. eg: palaces\r\n    rversion:                   levelVersion;\r\n    version:                    string; // version as read in the first 4 bytes of the file data\r\n    textile:                    Array<any>; // array of textures\r\n    animatedTexturesUVCount:    number; // number of uvcounts\r\n\r\n    [name: string] : any;\r\n}\r\n\r\n/**\r\n *  Read the raw level files (meaning the .phd / .tub / .tr2 / ... files)\r\n *  The result is a JSON tree with all data read\r\n */\r\nexport class LevelLoader {\r\n\r\n    private _level:     RawLevel;\r\n    private _confMgr:   ConfigManager;\r\n\r\n    constructor(confMgr: ConfigManager) {\r\n        this._level = <any>{};\r\n        this._confMgr = confMgr;\r\n    }\r\n\r\n    get level(): RawLevel {\r\n        return this._level;\r\n    }\r\n\r\n    get version(): string {\r\n        return this._level.rversion;\r\n    }\r\n\r\n    public load(data: any, fname: string, showTiles: boolean = false): boolean {\r\n        let ds = new DataStream(data);\r\n\r\n        ds.endianness = DataStream.LITTLE_ENDIAN;\r\n\r\n        const hdr = ds.readStruct([\r\n            'version', 'uint32'\r\n        ]);\r\n\r\n        let version = hdr.version;\r\n        let rversion = 'Unknown';\r\n        switch (version) {\r\n            case 0x00000020: rversion = 'TR1'; break;\r\n            case 0x0000002D: rversion = 'TR2'; break;\r\n            case 0xFF080038: rversion = 'TR3'; break;\r\n            case 0xFF180034: rversion = 'TR3'; break;\r\n            case 0xFF180038: rversion = 'TR3'; break;\r\n            case 0x00345254: rversion = 'TR4'; break;\r\n        }\r\n        ds.seek(0);\r\n\r\n        let rversionLoader: string = rversion;\r\n        if (fname.toLowerCase().indexOf('.tub') >= 0) {\r\n            rversionLoader = 'TR1TUB';\r\n        }\r\n\r\n        try {\r\n            let out = ds.readStruct(gameFormatDescr[rversionLoader].part1);\r\n\r\n            //console.log('first part ok', out);\r\n\r\n            const savepos = ds.position;\r\n\r\n            ds.position += out.numMeshData * 2;\r\n\r\n            out.numMeshPointers = ds.readUint32();\r\n            out.meshPointers = ds.readUint32Array(out.numMeshPointers);\r\n            out.meshes = [];\r\n\r\n            const savepos2 = ds.position;\r\n            for (let m = 0; m < out.numMeshPointers; ++m) {\r\n                ds.position = savepos + out.meshPointers[m];\r\n\r\n                const mesh = ds.readStruct(gameFormatDescr[rversionLoader].part2);\r\n\r\n                out.meshes[m] = mesh;\r\n                out.meshes[m].dummy = out.meshPointers[m] == 0;\r\n                //if (out.meshPointers[m] == 0) { console.log(m, mesh); }\r\n            }\r\n\r\n            ds.position = savepos2;\r\n\r\n            //console.log('second part ok', out);\r\n\r\n            const nextPart = ds.readStruct(gameFormatDescr[rversionLoader].part3);\r\n\r\n            //console.log('third part ok', out);\r\n\r\n            for (let attr in nextPart) {\r\n                out[attr] = nextPart[attr];\r\n            }\r\n\r\n            this._level = out;\r\n        } catch (e) {\r\n            console.log('An error occurred while parsing the level! ds.failurePosition=', ds.failurePosition);\r\n            console.log(ds);\r\n\r\n            throw e;\r\n        }\r\n\r\n        // -------------------\r\n        // --- post processing\r\n        //console.log(this._level.numRoomTextiles, this._level.numObjTextiles, this._level.numBumpTextiles);\r\n\r\n        var idx = fname.lastIndexOf('\\\\'), idx2 = fname.lastIndexOf('/');\r\n\r\n        this._level.filename = fname.substring(1 + Math.max(idx, idx2));\r\n        this._level.shortfilename = fname.substring(0, fname.indexOf('.'));\r\n        this._level.rversion = rversion as levelVersion;\r\n        this._level.version = Utils.toHexString32(version);\r\n        this._level.textile = [];\r\n        this._level.animatedTexturesUVCount = this._level.animatedTexturesUVCount || 0;\r\n\r\n        this._level.confMgr = this._confMgr;\r\n        this._level.confMgr.trversion = this._level.rversion;\r\n        this._level.confMgr.levelName = this._level.filename.toLowerCase();\r\n\r\n        if (this._level.textile32misc != undefined) {\r\n            this._level.textile32 = this._level.textile32.concat(this._level.textile32misc);\r\n            delete this._level.textile32misc;\r\n        }\r\n\r\n        let numTotTextiles = 0;\r\n\r\n        if (this._level.textile8 && !this._level.textile16) { numTotTextiles += this._level.textile8.length; }\r\n        if (this._level.textile16) { numTotTextiles += this._level.textile16.length; }\r\n        if (this._level.textile32) { numTotTextiles += this._level.textile32.length; }\r\n\r\n        this._level.atlas = {\r\n            \"width\":        256,\r\n            \"height\":       256,\r\n            \"make\":         true,\r\n            \"imageData\":    null,\r\n            \"numColPerRow\": 4,\r\n            \"curRow\":       0,\r\n            \"curCol\":       0,\r\n        };\r\n\r\n        if (this._level.atlas.make) {\r\n            this._level.atlas.width = this._level.atlas.numColPerRow * 256;\r\n            this._level.atlas.height = (Math.floor((numTotTextiles + 1) / this._level.atlas.numColPerRow) + (((numTotTextiles + 1) % this._level.atlas.numColPerRow) == 0 ? 0 : 1)) * 256;\r\n            this._level.atlas.imageData = new ImageData(this._level.atlas.width, this._level.atlas.height);\r\n        }\r\n\r\n        // Handle 8-bit textures\r\n        let numTextiles = 0;\r\n        if (this._level.textile8 && !this._level.textile16) {\r\n            for (let t = 0; t < this._level.textile8.length; ++t, ++numTextiles) {\r\n                const imageData = new ImageData(256, 256);\r\n                for (let j = 0; j < 256; ++j) {\r\n                    for (let i = 0; i < 256; ++i) {\r\n                        const pix = this._level.textile8[t][j * 256 + i];\r\n                        const a = pix ? 0xFF : 0x00, r = this._level.palette[pix].r << 2, g = this._level.palette[pix].g << 2, b = this._level.palette[pix].b << 2;\r\n                        imageData.data[j * 256 * 4 + i * 4 + 0] = r;\r\n                        imageData.data[j * 256 * 4 + i * 4 + 1] = g;\r\n                        imageData.data[j * 256 * 4 + i * 4 + 2] = b;\r\n                        imageData.data[j * 256 * 4 + i * 4 + 3] = a;\r\n                        if (this._level.atlas.make) {\r\n                            this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 0] = r;\r\n                            this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 1] = g;\r\n                            this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 2] = b;\r\n                            this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 3] = a;\r\n                        }\r\n                    }\r\n                }\r\n                this._level.textile[numTextiles] = Utils.convertToPng(imageData);\r\n                if (showTiles) {\r\n                    const idElem = \"tex8_\" + t;\r\n                    jQuery('body').append('<span id=\"' + idElem + '\">' +\r\n                        '<img alt=\"' + this._level.shortfilename + '_tile' + numTextiles + '.png\" style=\"border:1px solid red\" src=\"' + this._level.textile[numTextiles] +\r\n                        '\"/><span style=\"position:relative;left:-140px;top:-140px;background-color:white\">' + numTextiles + '</span></span>');\r\n                    document.getElementById(idElem)!.addEventListener(\"click\", Utils.saveData.bind(null, this._level.shortfilename + '_tile' + numTextiles, this._level.textile[numTextiles]), false);\r\n                }\r\n                if (this._level.atlas.make) {\r\n                    this._level.atlas.curCol++;\r\n                    if (this._level.atlas.curCol == this._level.atlas.numColPerRow) {\r\n                        this._level.atlas.curCol = 0;\r\n                        this._level.atlas.curRow++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Handle 16-bit textures\r\n        if (!this._level.textile16) { this._level.textile16 = []; }\r\n\r\n        const newtile = this.replaceColouredPolys(numTotTextiles);\r\n\r\n        if (newtile != null) { this._level.textile16.push(newtile); }\r\n\r\n        for (let t = 0; t < this._level.textile16.length; ++t, ++numTextiles) {\r\n            const imageData = new ImageData(256, 256);\r\n            for (let j = 0; j < 256; ++j) {\r\n                for (let i = 0; i < 256; ++i) {\r\n                    const pix = this._level.textile16[t][j * 256 + i];\r\n                    let a = pix & 0x8000, r = ((pix & 0x7c00) >> 10) << 3, g = ((pix & 0x03e0) >> 5) << 3, b = (pix & 0x001f) << 3;\r\n                    if (a) { a = 0xFF; }\r\n                    imageData.data[j * 256 * 4 + i * 4 + 0] = r;\r\n                    imageData.data[j * 256 * 4 + i * 4 + 1] = g;\r\n                    imageData.data[j * 256 * 4 + i * 4 + 2] = b;\r\n                    imageData.data[j * 256 * 4 + i * 4 + 3] = a;\r\n                    if (this._level.atlas.make) {\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 0] = r;\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 1] = g;\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 2] = b;\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 3] = a;\r\n                    }\r\n                }\r\n            }\r\n            this._level.textile[numTextiles] = Utils.convertToPng(imageData);\r\n            if (showTiles) {\r\n                const idElem = \"tex16_\" + t;\r\n                jQuery('body').append('<span id=\"' + idElem + '\">' +\r\n                    '<img alt=\"' + this._level.shortfilename + '_tile' + numTextiles + '.png\" style=\"border:1px solid red\" src=\"' + this._level.textile[numTextiles] +\r\n                    '\"/><span style=\"position:relative;left:-140px;top:-140px;background-color:white\">' + numTextiles + '</span></span>');\r\n                document.getElementById(idElem)!.addEventListener(\"click\", Utils.saveData.bind(null, this._level.shortfilename + '_tile' + numTextiles, this._level.textile[numTextiles]), false);\r\n            }\r\n            if (this._level.atlas.make) {\r\n                this._level.atlas.curCol++;\r\n                if (this._level.atlas.curCol == this._level.atlas.numColPerRow) {\r\n                    this._level.atlas.curCol = 0;\r\n                    this._level.atlas.curRow++;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Handle 32-bit textures\r\n        if (!this._level.textile32) { this._level.textile32 = []; }\r\n\r\n        for (let t = 0; t < this._level.textile32.length; ++t, ++numTextiles) {\r\n            const imageData = new ImageData(256, 256);\r\n            for (let j = 0; j < 256; ++j) {\r\n                for (let i = 0; i < 256; ++i) {\r\n                    const pix = this._level.textile32[t][j * 256 + i];\r\n                    const a = ((pix & 0xff000000) >> 24) & 0xFF, r = (pix & 0x00ff0000) >> 16, g = (pix & 0x0000ff00) >> 8, b = (pix & 0x000000ff);\r\n                    imageData.data[j * 256 * 4 + i * 4] = r;\r\n                    imageData.data[j * 256 * 4 + i * 4 + 1] = g;\r\n                    imageData.data[j * 256 * 4 + i * 4 + 2] = b;\r\n                    imageData.data[j * 256 * 4 + i * 4 + 3] = a;\r\n                    if (this._level.atlas.make) {\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 0] = r;\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 1] = g;\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 2] = b;\r\n                        this._level.atlas.imageData.data[(j + this._level.atlas.curRow * 256) * 4 * this._level.atlas.width + (i + this._level.atlas.curCol * 256) * 4 + 3] = a;\r\n                    }\r\n                }\r\n            }\r\n            this._level.textile[numTextiles] = Utils.convertToPng(imageData);\r\n            if (showTiles) {\r\n                const idElem = \"tex32_\" + t;\r\n                jQuery('body').append('<span id=\"' + idElem + '\">' +\r\n                    '<img alt=\"' + this._level.shortfilename + '_tile' + numTextiles + '.png\" style=\"border:1px solid red\" src=\"' + this._level.textile[numTextiles] +\r\n                    '\"/><span style=\"position:relative;left:-140px;top:-140px;background-color:white\">' + numTextiles + '</span></span>');\r\n                document.getElementById(idElem)!.addEventListener(\"click\", Utils.saveData.bind(null, this._level.shortfilename + '_tile' + numTextiles, this._level.textile[numTextiles]), false);\r\n            }\r\n            if (this._level.atlas.make) {\r\n                this._level.atlas.curCol++;\r\n                if (this._level.atlas.curCol == this._level.atlas.numColPerRow) {\r\n                    this._level.atlas.curCol = 0;\r\n                    this._level.atlas.curRow++;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (rversion != 'TR4') {\r\n            for (let i = 0; i < this._level.objectTextures.length; ++i) {\r\n                const tex = this._level.objectTextures[i],\r\n                      tile = tex.tile & 0x7FFF;\r\n\r\n                const isTri =\r\n                        (tex.vertices[3].Xpixel == 0)  &&\r\n                        (tex.vertices[3].Ypixel == 0)  &&\r\n                        (tex.vertices[3].Xcoordinate == 0)  &&\r\n                        (tex.vertices[3].Ycoordinate == 0);\r\n\r\n                tex.tile = tile + (isTri ? 0x8000 : 0);\r\n            }\r\n        }\r\n\r\n        if (this._level.atlas.make) {\r\n            const dataSky = this._level.textile[this._level.textile.length - 1];\r\n\r\n            this._level.textile = [Utils.convertToPng(this._level.atlas.imageData)];\r\n\r\n            if (rversion == 'TR4') { this._level.textile.push(dataSky); } // the sky textile must always be the last of the this._level.textile array\r\n\r\n            if (showTiles) {\r\n                jQuery(document.body).css('overflow', 'auto');\r\n                jQuery('body').append('<span id=\"atlas\">' +\r\n                    '<img title=\"' + this._level.atlas.width + 'x' + this._level.atlas.height + '\" alt=\"' + this._level.shortfilename + '_atlas.png\" style=\"border:1px solid red\" src=\"' + this._level.textile[0] + '\"/></span>');\r\n                document.getElementById(\"atlas\")!.addEventListener(\"click\", Utils.saveData.bind(null, this._level.shortfilename + '_atlas', this._level.textile[0]), false);\r\n            }\r\n\r\n            for (let i = 0; i < this._level.objectTextures.length; ++i) {\r\n                const objText = this._level.objectTextures[i];\r\n                const tile = objText.tile & 0x7FFF, b16 = objText.tile & 0x8000;\r\n\r\n                const row = Math.floor(tile / this._level.atlas.numColPerRow), col = tile - row * this._level.atlas.numColPerRow;\r\n\r\n                objText.tile = 0 + b16;\r\n                objText.origTile = tile;\r\n\r\n                for (let j = 0; j < objText.vertices.length; ++j) {\r\n                    const vert = objText.vertices[j];\r\n\r\n                    vert.Xpixel = parseInt(vert.Xpixel) + col * 256;\r\n                    vert.Ypixel = parseInt(vert.Ypixel) + row * 256;\r\n                }\r\n            }\r\n        }\r\n\r\n        delete this._level.palette;\r\n        delete this._level.textile8;\r\n        delete this._level.textile16;\r\n        delete this._level.textile32;\r\n\r\n        Utils.flatten(this._level, 'rooms.roomData.rectangles.vertices');\r\n        Utils.flatten(this._level, 'rooms.roomData.triangles.vertices');\r\n        Utils.flatten(this._level, 'floorData');\r\n        Utils.flatten(this._level, 'meshPointers');\r\n        Utils.flatten(this._level, 'meshes.lights');\r\n        Utils.flatten(this._level, 'meshes.texturedRectangles.vertices');\r\n        Utils.flatten(this._level, 'meshes.texturedTriangles.vertices');\r\n        Utils.flatten(this._level, 'meshes.colouredRectangles.vertices');\r\n        Utils.flatten(this._level, 'meshes.colouredTriangles.vertices');\r\n        Utils.flatten(this._level, 'frames');\r\n        Utils.flatten(this._level, 'spr');\r\n        Utils.flatten(this._level, 'overlaps');\r\n        Utils.flatten(this._level, 'zones');\r\n        Utils.flatten(this._level, 'animatedTextures');\r\n        Utils.flatten(this._level, 'lightmap');\r\n        Utils.flatten(this._level, 'tex');\r\n        Utils.flatten(this._level, 'demoData');\r\n        Utils.flatten(this._level, 'soundMap');\r\n        Utils.flatten(this._level, 'sampleIndices');\r\n\r\n        return ds.position == ds.byteLength;\r\n    }\r\n\r\n    private replaceColouredPolys(tile: number): Uint16Array | null {\r\n        if (this._level.rversion == 'TR4') {\r\n            return null;\r\n        }\r\n\r\n        // Build a new textile from the color palette\r\n         const newTile = new Uint16Array(256 * 256);\r\n         let ofst = 0, lgn = 0;\r\n        for (let c = 0; c < 256; ++c) {\r\n            let color = this.version == 'TR1' ? this._level.palette[c] : this._level.palette16[c];\r\n\r\n            if (this.version == 'TR1')  {\r\n                color = ((color.r >> 1) << 10) + ((color.g >> 1) << 5) + (color.b >> 1) + 0x8000;\r\n            } else {\r\n                color = ((color.r >> 3) << 10) + ((color.g >> 3) << 5) + (color.b >> 3) + 0x8000;\r\n            }\r\n\r\n            for (let j = 0; j < 3; ++j) {\r\n                for (let i = 0; i < 3; ++i) {\r\n                    newTile[lgn * 256 + ofst + i + j * 256] = color;\r\n                }\r\n            }\r\n\r\n            ofst += 3;\r\n            if (ofst + 3 >= 256) {\r\n                ofst = 0;\r\n                lgn += 3;\r\n            }\r\n        }\r\n\r\n        // Build new objectTexture structures for the 256 colors of the palette\r\n        // There are 2 new sets of 256 objectTexture structs: one for tris and one for quads\r\n        let numObjText = this._level.numObjectTextures;\r\n        for (let j = 0; j < 2; ++j) {\r\n             ofst = lgn = 0;\r\n\r\n             for (let c = 0; c < 256; ++c) {\r\n                 let objText = {\r\n                     \"attributes\": 0,\r\n                    \"tile\": tile,\r\n                    \"vertices\": [\r\n                        { \"Xcoordinate\": +1, \"Xpixel\": ofst,   \"Ycoordinate\": +1, \"Ypixel\": lgn },\r\n                        { \"Xcoordinate\": -1, \"Xpixel\": ofst + 2, \"Ycoordinate\": +1, \"Ypixel\": lgn },\r\n                        { \"Xcoordinate\": -1, \"Xpixel\": ofst + 2, \"Ycoordinate\": -1, \"Ypixel\": lgn + 2 },\r\n                        { \"Xcoordinate\": 0,  \"Xpixel\": 0,      \"Ycoordinate\": 0,  \"Ypixel\": 0 }\r\n                    ]\r\n                 };\r\n                 if (j == 1) {\r\n                     objText.vertices[3].Xcoordinate = +1;\r\n                     objText.vertices[3].Xpixel = ofst;\r\n                     objText.vertices[3].Ycoordinate = -1;\r\n                     objText.vertices[3].Ypixel = lgn + 2;\r\n                 }\r\n                 this._level.objectTextures.push(objText);\r\n                numObjText++;\r\n\r\n                ofst += 3;\r\n                if (ofst + 3 >= 256) {\r\n                    ofst = 0;\r\n                    lgn += 3;\r\n                }\r\n             }\r\n        }\r\n\r\n        const skyRemovePolyStart = this._level.confMgr.number('behaviour[name=\"Sky\"] > removepoly > start', true, 0);\r\n        const skyRemovePolyNum   = this._level.confMgr.number('behaviour[name=\"Sky\"] > removepoly > num', true, 0);\r\n        if (skyRemovePolyNum > 0) {\r\n            const skyId = this._level.confMgr.number('behaviour[name=\"Sky\"] > id', true, 0);\r\n            if (skyId) {\r\n                for (let m = 0; m < this._level.moveables.length; ++m) {\r\n                    let moveable = this._level.moveables[m];\r\n                    if (moveable.objectID == skyId) {\r\n                        this._level.meshes[moveable.startingMesh].colouredTriangles.splice(skyRemovePolyStart, skyRemovePolyNum);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Process the meshes and replace colored polys by textured ones\r\n        for (let m = 0; m < this._level.meshes.length; ++m) {\r\n            let mesh = this._level.meshes[m];\r\n\r\n            // coloured rectangles\r\n            for (let i = 0; i < mesh.colouredRectangles.length; ++i) {\r\n                let poly = mesh.colouredRectangles[i];\r\n                const index = this._level.rversion == levelVersion.TR1 ? poly.texture & 0xFF : poly.texture >> 8;\r\n                poly.texture = numObjText - 256 + index;\r\n                mesh.texturedRectangles.push(poly);\r\n            }\r\n            mesh.colouredRectangles = [];\r\n            mesh.numColouredRectangles = 0;\r\n\r\n            // coloured triangles\r\n            for (let i = 0; i < mesh.colouredTriangles.length; ++i) {\r\n                let poly = mesh.colouredTriangles[i];\r\n                const index = this._level.rversion == levelVersion.TR1 ? poly.texture & 0xFF : poly.texture >> 8;\r\n                poly.texture = numObjText - 512 + index;\r\n                mesh.texturedTriangles.push(poly);\r\n            }\r\n            mesh.colouredTriangles = [];\r\n            mesh.numColouredTriangles = 0;\r\n        }\r\n\r\n        return newTile;\r\n    }\r\n\r\n    public static unzip(ds: any, struct: any, dlength: number): void {\r\n        // unzip chunk of data\r\n        if (dlength == 0) {\r\n            dlength = ds.byteLength - ds.position;\r\n        }\r\n\r\n        let arr = new Uint8Array(dlength);\r\n        DataStream.memcpy(arr.buffer, 0, ds.buffer, ds.byteOffset + ds.position, dlength);\r\n        let unzipped = pako.inflate(arr);\r\n\r\n        // recreate a buffer and replace the compressed data with the uncompressed one\r\n        let buf = new Uint8Array(ds.byteLength + unzipped.length - dlength), ofst = 0;\r\n        let src = new Uint8Array(ds.buffer, 0, ds.byteOffset + ds.position);\r\n\r\n        buf.set(src, ofst);\r\n        ofst += src.length;\r\n        buf.set(unzipped, ofst);\r\n        ofst += unzipped.length;\r\n        src = new Uint8Array(ds.buffer, ds.byteOffset + ds.position + dlength);\r\n        buf.set(src, ofst);\r\n        ds.buffer = buf.buffer.slice(buf.byteOffset, buf.byteLength + buf.byteOffset);\r\n    }\r\n\r\n}\r\n","import Engine from \"../Proxy/Engine\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\n\r\nimport { ConfigManager } from \"../ConfigManager\";\r\nimport { LevelLoader } from \"./LevelLoader\";\r\nimport LevelConverter from \"./LevelConverter\";\r\n\r\nexport default class MasterLoader {\r\n\r\n    /* trlevel is either:\r\n\t \t* a string which is the name of the level to download.\r\n\t \t* a JSON object like { data:XXX, name:YYY } where data are the binary data of the TR level and YYY the filename\r\n\t */\r\n    public static loadLevel(trlevel: string | any, confMgr: ConfigManager): Promise<any> {\r\n        const loader = new LevelLoader(confMgr);\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            if (typeof(trlevel) != 'string') {\r\n                loader.load(trlevel.data, trlevel.name, trlevel.showTiles);\r\n                resolve(loader.level);\r\n            } else {\r\n                fetch(trlevel).then((response: Response) => {\r\n                    response.arrayBuffer().then((blob) => {\r\n                        loader.load(blob, trlevel);\r\n                        resolve(loader.level);\r\n                    });\r\n                });\r\n            }\r\n        }).then((level) => {\r\n            if (trlevel.showTiles) {\r\n                return Promise.resolve(level);\r\n            }\r\n\r\n            const converter = new LevelConverter();\r\n\r\n            converter.convert(level);\r\n\r\n            const shdMgr = Engine.getShaderMgr();\r\n\r\n            shdMgr.setTRLevel(level);\r\n\r\n            return Engine.parseScene(converter.sceneJSON).then((scene: IScene) => {\r\n                MasterLoader._postProcessLevel(converter.sceneJSON, scene);\r\n\r\n                return Promise.resolve([converter.sceneJSON, scene]);\r\n            });\r\n        });\r\n    }\r\n\r\n    private static _postProcessLevel(sceneJSON: any, scene: IScene): void {\r\n        const sceneData = sceneJSON.data, sceneRender = scene;\r\n\r\n        sceneData.textures = sceneRender.textures;\r\n\r\n        // Set all objects as auto update=false\r\n        // Camera, skies, animated objects will have their matrixAutoUpdate set to true later\r\n        sceneRender.traverse((obj: any) => {\r\n            obj.matrixAutoUpdate = false;\r\n        });\r\n\r\n        const objToRemoveFromScene: Array<IMesh> = [];\r\n\r\n        sceneRender.traverse((obj: IMesh) => {\r\n            const data = sceneData.objects[obj.name];\r\n\r\n            if (data) {\r\n                if ((data.type == 'moveable' || data.type == 'spriteseq' || data.type == 'sprite' || data.type == 'staticmesh') /*&& data.roomIndex < 0*/) {\r\n                    data.liveObj = obj;\r\n                    objToRemoveFromScene.push(obj);\r\n                }\r\n\r\n                if (data.type == \"camera\") {\r\n                    obj.matrixAutoUpdate = true;\r\n                }\r\n\r\n                obj.visible = data.visible;\r\n            }\r\n        });\r\n\r\n        objToRemoveFromScene.forEach((obj) => sceneRender.remove(obj));\r\n    }\r\n}\r\n","import jQuery from \"jquery\";\r\n\r\nimport Browser from \"./Utils/Browser\";\r\nimport { ProgressBar } from \"./Utils/ProgressBar\";\r\n\r\nimport { CutScene } from \"./Behaviour/CutScene\";\r\nimport MasterLoader from \"./Loading/MasterLoader\";\r\nimport Play from \"./Player/Play\";\r\nimport { ConfigManager } from \"./ConfigManager\";\r\n\r\nconst showTiles = false;\r\nconst relPath = Browser.QueryString.relpath || \"\";\r\n\r\nfunction setContainerDimensions() {\r\n    if (!showTiles) {\r\n        jQuery('#container').width(window.innerWidth);\r\n        jQuery('#container').height(window.innerHeight);\r\n    }\r\n}\r\n\r\njQuery(window).on('resize', setContainerDimensions);\r\njQuery(window).on('load', setContainerDimensions);\r\n\r\njQuery(document).on('keydown', function(event) {\r\n    //console.log(event.which)\r\n    switch (event.which) {\r\n        case 72: // H\r\n            jQuery(\"#help\").css('display', jQuery('#help').css('display') == 'block' ? 'none' : 'block');\r\n            break;\r\n        case 13: // Enter\r\n            jQuery(\"#panel\").css('display', jQuery('#panel').css('display') == 'block' ? 'none' : 'block');\r\n            jQuery(\"#stats\").css('display', jQuery('#stats').css('display') == 'block' ? 'none' : 'block');\r\n            break;\r\n        case 36: // Home\r\n            let qgame = Browser.QueryString.trgame, qengine = Browser.QueryString.engine,\r\n                prm = '?';\r\n\r\n            if (qengine) {\r\n                prm += 'engine=' + qengine;\r\n            }\r\n\r\n            if (qgame) {\r\n                prm += '&trgame=' + qgame;\r\n            }\r\n\r\n            document.location.href = relPath + 'index.html' + prm;\r\n            break;\r\n    }\r\n});\r\n\r\nfunction loadAndPlayLevel(level: string | any) {\r\n    const progressbar = new ProgressBar(document.getElementById('container') as Element, relPath);\r\n\r\n    progressbar.show();\r\n\r\n    fetch(relPath + 'resources/level/TRLevels.xml').then((response) => {\r\n        response.text().then((txt) => {\r\n            const confMgr = new ConfigManager(jQuery.parseXML(txt));\r\n\r\n            MasterLoader.loadLevel(level, confMgr).then((res) => {\r\n                if (!showTiles) {\r\n                    const play = new Play(document.getElementById('container') as Element);\r\n                    (window as any).play = play;\r\n                    jQuery(`<style type=\"text/css\" media=\"all\">@import \"${relPath}resources/css/help.css\";</style>`).appendTo(jQuery(document.body));\r\n                    fetch(relPath + 'resources/template/help.html').then((response) => {\r\n                        response.text().then((html) => {\r\n                            jQuery(html).appendTo(document.body);\r\n                        });\r\n                    });\r\n                    if (Browser.QueryString.autostart == '1') {\r\n                        play.initialize(res[0], res[1]).then(() => {\r\n                            progressbar.hide();\r\n                            play.play();\r\n                        });\r\n                    } else {\r\n                        play.initialize(res[0], res[1]).then(() => {\r\n                            if (play.gameData.isCutscene) {\r\n                                const idTimer = setInterval(() => {\r\n                                    if (play.gameData.sceneRender.allMeshesReady) {\r\n                                        clearInterval(idTimer);\r\n                                        progressbar.hide();\r\n                                        play.play(true, true);\r\n                                        play.play(true, false); // we need a 2nd call to display the particle systems in Babylon...\r\n                                        const bhvCutScene = (play.gameData.bhvMgr.getBehaviour(\"CutScene\") as Array<CutScene>)[0] as CutScene;\r\n                                        bhvCutScene.showController();\r\n                                    }\r\n                                }, 10);\r\n                            } else {\r\n                                progressbar.showStart(function() {\r\n                                    progressbar.hide();\r\n                                    play.play();\r\n                                });\r\n                            }\r\n                        });\r\n                    }\r\n                } else {\r\n                    progressbar.hide();\r\n                }\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\nfunction handleFileSelect(evt: Event) {\r\n\r\n    function readFile(idx: number) {\r\n        const f = files[idx - 1];\r\n        const freader = new FileReader();\r\n        freader.onload = ((theFile) => {\r\n            return function(e: any) {\r\n                jQuery('#files').css('display', 'none');\r\n\r\n                loadAndPlayLevel({\r\n                    \"data\":         e.target.result,\r\n                    \"name\":         theFile.name,\r\n                    \"showTiles\":    showTiles,\r\n                });\r\n            };\r\n        })(f);\r\n        freader.readAsArrayBuffer(f);\r\n    }\r\n\r\n    let files = (evt.target! as any).files as Array<any>;\r\n\r\n    readFile(1);\r\n}\r\n\r\nif (Browser.QueryString.level) {\r\n    loadAndPlayLevel(relPath + 'resources/level/' + Browser.QueryString.level);\r\n} else {\r\n    jQuery('body').prepend('<input type=\"file\" id=\"files\" multiple=\"multiple\" _style=\"display: none\" />');\r\n\r\n    jQuery('#files').css('display', 'block');\r\n    jQuery('#files').on('change', handleFileSelect);\r\n}\r\n","import { Position, Quaternion } from \"../Proxy/INode\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nexport class Basis {\r\n\r\n    public rot: Quaternion;\r\n    public pos: Position;\r\n\r\n    constructor(pos?: Position, quat?: Quaternion) {\r\n        this.pos = pos ? pos : [0, 0, 0];\r\n        this.rot = quat ? quat : [0, 0, 0, 1];\r\n    }\r\n\r\n    public identity(): void {\r\n        this.rot = [0, 0, 0, 1];\r\n        this.pos = [0, 0, 0];\r\n    }\r\n\r\n    public multBasis(basis: Basis): Basis {\r\n        const q: Quaternion = [0, 0, 0, 1], p: Position = [0, 0, 0];\r\n\r\n        glMatrix.quat.mul(q, this.rot, basis.rot);\r\n        glMatrix.vec3.transformQuat(p, basis.pos, this.rot);\r\n\r\n        p[0] += this.pos[0];\r\n        p[1] += this.pos[1];\r\n        p[2] += this.pos[2];\r\n\r\n        return new Basis(p, q);\r\n    }\r\n\r\n    public mult(v: Position): Position {\r\n        const p: Position = [0, 0, 0];\r\n\r\n        glMatrix.vec3.transformQuat(p, v, this.rot);\r\n\r\n        p[0] += this.pos[0];\r\n        p[1] += this.pos[1];\r\n        p[2] += this.pos[2];\r\n\r\n        return p;\r\n    }\r\n\r\n    public translate(v: Position): void {\r\n        const p: Position = [0, 0, 0];\r\n\r\n        glMatrix.vec3.transformQuat(p, v, this.rot);\r\n\r\n        this.pos[0] += p[0];\r\n        this.pos[1] += p[1];\r\n        this.pos[2] += p[2];\r\n    }\r\n\r\n    public rotate(q: Quaternion): void {\r\n        glMatrix.quat.mul(this.rot, this.rot, q);\r\n    }\r\n}\r\n","/*\r\n***\r\n*** Conversion of the Braid class found in lara.h in OpenLara: https://github.com/XProger/OpenLara\r\n*** All credits to XProger for this!\r\n***\r\n*/\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { Position, Quaternion } from \"../Proxy/INode\";\r\n\r\nimport IGameData from \"./IGameData\";\r\nimport { ObjectID } from \"../Constants\";\r\nimport { Skeleton, BONE, MASK } from \"./Skeleton\";\r\nimport { Basis } from \"./Basis\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nconst GRAVITY   = 6;\r\nconst EPS       = 1.192092896e-07; // smallest such that 1.0+FLT_EPSILON != 1.0\r\n\r\nconst __m = glMatrix.mat4.create();\r\n\r\ninterface Joint {\r\n    posPrev:    Position;\r\n    pos:        Position;\r\n    length:     number;\r\n}\r\n\r\nexport class Braid {\r\n\r\n    protected _lara: IMesh;\r\n    protected _laraSkeleton: Skeleton;\r\n    protected _laraStartingMesh: number;\r\n    protected _offset: Position;\r\n    protected _time: number;\r\n    protected _gameData: IGameData;\r\n    protected _model: IMesh;\r\n    protected _modelSkeleton: Skeleton;\r\n    protected _jointsCount: number;\r\n    protected _joints: Array<Joint>;\r\n    protected _basis: Array<Basis>;\r\n    protected _headBasis: Basis;\r\n    protected _curFrame: number;\r\n    protected _fixToHead: boolean;\r\n\r\n    constructor(lara: IMesh, offset: Position, gameData: IGameData, fixToHead: boolean = false) {\r\n        (window as any).braid = this;\r\n\r\n        this._lara = lara;\r\n        this._offset = offset;\r\n        this._time = 0;\r\n        this._gameData = gameData;\r\n        this._headBasis = <any>null;\r\n        this._curFrame = -1;\r\n        this._fixToHead = fixToHead;\r\n\r\n        this._laraSkeleton = this._gameData.sceneData.objects[this._lara.name].skeleton;\r\n        this._laraSkeleton.updateBoneMatrices();\r\n        this._laraStartingMesh = this._gameData.sceneData.objects['moveable' + this._gameData.sceneData.objects[this._lara.name].objectid].startingMesh;\r\n\r\n        this._model = this.getModel();\r\n        this._modelSkeleton = this._gameData.sceneData.objects[this._model.name].skeleton;\r\n\r\n        const modelJointCount = this._modelSkeleton.bones.length;\r\n\r\n        this._jointsCount = modelJointCount + 1;\r\n        this._joints = new Array(this._jointsCount);\r\n        this._basis = new Array(this._jointsCount - 1);\r\n\r\n        for (let b = 0; b < this._basis.length; ++b) {\r\n            this._basis[b] = new Basis();\r\n        }\r\n\r\n        this.reset();\r\n    }\r\n\r\n    public get model(): IMesh {\r\n        return this._model;\r\n    }\r\n\r\n    public reset(): void {\r\n        const basis = this.getBasis(true);\r\n\r\n        basis.translate(this._offset);\r\n\r\n        for (let i = 0; i < this._jointsCount - 1; i++) {\r\n            const bonePos = this._modelSkeleton.bonesStartingPos[1 + Math.min(i, this._jointsCount - 3)].pos_init;\r\n\r\n            this._joints[i] = {\r\n                \"posPrev\":  basis.pos.slice() as Position,\r\n                \"pos\":      basis.pos.slice() as Position,\r\n                \"length\":   -bonePos[2],\r\n            };\r\n\r\n            basis.translate([0.0, 0.0, this._joints[i].length]);\r\n        }\r\n\r\n        this._joints[this._jointsCount - 1] = {\r\n            \"posPrev\":  basis.pos.slice() as Position,\r\n            \"pos\":      basis.pos.slice() as Position,\r\n            \"length\":   1.0,\r\n        };\r\n    }\r\n\r\n    protected getModel(): IMesh {\r\n        // break the hierarchy between bones so that the matrices are not cumulated: we will calculate the final matrix for each bone ourselves\r\n        const bones = this._gameData.sceneData.objects['moveable' + ObjectID.LaraBraid].bonesStartingPos as Array<any>;\r\n\r\n        bones.forEach((b) => b.parent = -1);\r\n\r\n        // get the model\r\n        const mvb = this._gameData.objMgr.createMoveable(ObjectID.LaraBraid, this._gameData.sceneData.objects[this._lara.name].roomIndex, undefined, true, false) as IMesh,\r\n              data = this._gameData.sceneData.objects[mvb.name];\r\n\r\n        data.has_anims = false;\r\n\r\n        mvb.frustumCulled = false; // faster than regenerating a new bounding box each frame, as the braid will be visible most of the time\r\n\r\n        return mvb;\r\n    }\r\n\r\n    protected getBasis(force: boolean = false): Basis {\r\n        if (!force && (this._curFrame == this._gameData.curFrame)) {\r\n            return this._headBasis;\r\n        }\r\n\r\n        this._headBasis = this._laraSkeleton.getBoneDecomposition(BONE.HEAD, this._lara);\r\n        this._curFrame = this._gameData.curFrame;\r\n\r\n        return this._headBasis;\r\n    }\r\n\r\n    protected getPos(forceCalcBasis: boolean = false): Position {\r\n        return this.getBasis(forceCalcBasis).mult(this._offset);\r\n    }\r\n\r\n    protected integrate(deltaTime: number): void {\r\n        const TIMESTEP = deltaTime;\r\n        const ACCEL    = 16.0 * GRAVITY * 30.0 * TIMESTEP * TIMESTEP;\r\n        let DAMPING    = 1.5;\r\n\r\n        DAMPING = 1.0 / (1.0 + DAMPING * TIMESTEP); // Padé approximation\r\n\r\n        for (let i = 1; i < this._jointsCount; i++) {\r\n            const j = this._joints[i],\r\n                  delta = [0, 0, 0];\r\n\r\n            glMatrix.vec3.sub(delta, j.pos, j.posPrev);\r\n\r\n            const deltaLength = glMatrix.vec3.length(delta);\r\n\r\n            glMatrix.vec3.normalize(delta, delta);\r\n            glMatrix.vec3.scale(delta, delta, Math.min(deltaLength, 2048.0 * deltaTime) * DAMPING); // speed limit\r\n\r\n            glMatrix.vec3.copy(j.posPrev, j.pos);\r\n            glMatrix.vec3.add(j.pos, j.pos, delta);\r\n            j.pos[1] -= ACCEL;\r\n        }\r\n    }\r\n\r\n    protected collide(): void {\r\n        const BRAID_RADIUS = 0.0,\r\n              meshes = this._gameData.trlvl.trlevel.meshes;\r\n\r\n        const pos: Position = [0, 0, 0], quat: Quaternion = [0, 0, 0, 0], dir: Position = [0, 0, 0];\r\n\r\n        for (let i = 0; i < this._laraSkeleton.bones.length; i++) {\r\n            if (!(MASK.BRAID & (1 << i))) { continue; }\r\n\r\n            const mesh = meshes[i + this._laraStartingMesh],\r\n                  mcenter: Position = [mesh.center.x, -mesh.center.y, -mesh.center.z],\r\n                  mradius: number = mesh.collisionSize;\r\n\r\n            this._laraSkeleton.bones[i].decomposeMatrixWorld(pos, quat);\r\n\r\n            const laraBasis = new Basis(this._lara.position, this._lara.quaternion),\r\n                  boneBasis = laraBasis.multBasis(new Basis(pos, quat)),\r\n                  center    = boneBasis.mult(mcenter);\r\n\r\n            let radiusSq = mradius + BRAID_RADIUS;\r\n\r\n            radiusSq *= radiusSq;\r\n\r\n            for (let j = 1; j < this._jointsCount; j++) {\r\n                glMatrix.vec3.sub(dir, this._joints[j].pos, center);\r\n                let len = glMatrix.vec3.squaredLength(dir) + EPS;\r\n                if (len < radiusSq) {\r\n                    len = Math.sqrt(len);\r\n                    glMatrix.vec3.scale(dir, dir, (mradius + BRAID_RADIUS - len) / len);\r\n                    glMatrix.vec3.scale(dir, dir, 0.9);\r\n                    glMatrix.vec3.add(this._joints[j].pos, this._joints[j].pos, dir);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    protected solve(): void {\r\n        for (let i = 0; i < this._jointsCount - 1; i++) {\r\n            const a = this._joints[i],\r\n                  b = this._joints[i + 1],\r\n                  dir = [0, 0, 0];\r\n\r\n            glMatrix.vec3.sub(dir, b.pos, a.pos);\r\n\r\n            const len = glMatrix.vec3.length(dir) + EPS;\r\n\r\n            glMatrix.vec3.scale(dir, dir, 1.0 / len);\r\n\r\n            const d = a.length - len;\r\n\r\n            if (i > 0) {\r\n                glMatrix.vec3.scale(dir, dir, d * (0.5 * 1.0));\r\n                glMatrix.vec3.sub(a.pos, a.pos, dir);\r\n                glMatrix.vec3.add(b.pos, b.pos, dir);\r\n            } else {\r\n                glMatrix.vec3.scale(dir, dir, d * 1.0);\r\n                glMatrix.vec3.add(b.pos, b.pos, dir);\r\n            }\r\n        }\r\n    }\r\n\r\n    public update(deltaTime: number, forceCalcBasis: boolean = false): void {\r\n        this._joints[0].pos = this.getPos(forceCalcBasis);\r\n\r\n        this.integrate(deltaTime); // Verlet integration step\r\n\r\n        this.collide(); // check collision with Lara's mesh\r\n\r\n        for (let i = 0; i < this._jointsCount; i++) { // solve connections (springs)\r\n            this.solve();\r\n        }\r\n\r\n        const headDir: Position = [0, 0, 0];\r\n\r\n        glMatrix.vec3.transformQuat(headDir, [0, 0, 1], this.getBasis().rot);\r\n\r\n        for (let i = 0; i < this._jointsCount - 1; i++) {\r\n            const d = [0, 0, 0];\r\n\r\n            glMatrix.vec3.sub(d, this._joints[i + 1].pos, this._joints[i].pos);\r\n            glMatrix.vec3.normalize(d, d);\r\n\r\n            const r = [0, 0, 0];\r\n\r\n            glMatrix.vec3.cross(r, d, headDir);\r\n            glMatrix.vec3.normalize(r, r);\r\n\r\n            const u = [0, 0, 0];\r\n\r\n            glMatrix.vec3.cross(u, d, r);\r\n            glMatrix.vec3.normalize(u, u);\r\n\r\n            __m[0] = r[0]; __m[1] = -r[1]; __m[ 2] = -r[2];\r\n            __m[4] = u[0]; __m[5] = -u[1]; __m[ 6] = -u[2];\r\n            __m[8] = d[0]; __m[9] = -d[1]; __m[10] = -d[2];\r\n\r\n            this._basis[i].identity();\r\n            this._basis[i].translate(this._joints[i].pos);\r\n\r\n            const q: Quaternion = [0, 0, 0, 1];\r\n\r\n            glMatrix.mat4.getRotation(q, __m);\r\n\r\n            this._basis[i].rotate(q);\r\n\r\n            this._modelSkeleton.bones[i].setPosition(this._basis[i].pos);\r\n            this._modelSkeleton.bones[i].setQuaternion([this._basis[i].rot[0], -this._basis[i].rot[1], -this._basis[i].rot[2], this._basis[i].rot[3]]);\r\n            this._modelSkeleton.bones[i].updateMatrixWorld();\r\n        }\r\n\r\n        if (this._fixToHead) {\r\n            const headBasis = this.getBasis();\r\n            const q = glMatrix.quat.create();\r\n\r\n            glMatrix.quat.setAxisAngle(q, [1, 0, 0], Math.PI);\r\n\r\n            headBasis.rotate(q);\r\n\r\n            this._modelSkeleton.bones[0].setPosition(headBasis.pos);\r\n            this._modelSkeleton.bones[0].setQuaternion(headBasis.rot);\r\n            this._modelSkeleton.bones[0].updateMatrixWorld();\r\n        }\r\n\r\n        this._modelSkeleton.setBoneMatrices();\r\n\r\n        if (this._gameData.sceneData.objects[this._model.name].roomIndex != this._gameData.sceneData.objects[this._lara.name].roomIndex) {\r\n            this._gameData.objMgr.changeRoomMembership(\r\n                this._model,\r\n                this._gameData.sceneData.objects[this._model.name].roomIndex,\r\n                this._gameData.sceneData.objects[this._lara.name].roomIndex\r\n            );\r\n        }\r\n\r\n    }\r\n\r\n}\r\n","import { IMesh } from \"../Proxy/IMesh\";\r\nimport { IMeshBuilder, indexList } from \"../Proxy/IMeshBuilder\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { MaterialManager } from \"./MaterialManager\";\r\nimport Engine from \"../Proxy/Engine\";\r\nimport { Skeleton, MASK } from \"../Player/Skeleton\";\r\n\r\nexport enum LAYER {\r\n    MAIN            = 0,\r\n    WEAPON          = 1,\r\n    HOLSTER_EMPTY   = 2,\r\n    HOLSTER_FULL    = 3,\r\n    MESHSWAP        = 4,\r\n}\r\n\r\ninterface ALayer {\r\n    meshb: IMeshBuilder;\r\n    mask:  number;\r\n}\r\n\r\nexport class Layer {\r\n\r\n    protected sceneData:    any;\r\n    protected matMgr:       MaterialManager;\r\n    protected layers:       Map<number, ALayer>;\r\n\r\n    constructor(mainMesh: IMesh, gameData: IGameData) {\r\n        this.sceneData = gameData.sceneData;\r\n        this.matMgr = gameData.matMgr;\r\n\r\n        this.layers = new Map();\r\n\r\n        this.setMesh(LAYER.MAIN, mainMesh);\r\n    }\r\n\r\n    public isEmpty(layerIndex: number): boolean {\r\n        return this.layers.get(layerIndex) === undefined;\r\n    }\r\n\r\n    public getMesh(layerIndex: number): IMesh | null {\r\n        const layer = this.layers.get(layerIndex);\r\n\r\n        return layer ? layer.meshb.mesh : null;\r\n    }\r\n\r\n    public getMeshBuilder(layerIndex: number): IMeshBuilder | null {\r\n        const layer = this.layers.get(layerIndex);\r\n\r\n        return layer ? layer.meshb : null;\r\n    }\r\n\r\n    public setMesh(layerIndex: number, mesh: IMesh, mask?: number): void {\r\n        return this.setMeshBuilder(layerIndex, Engine.makeMeshBuilder(mesh), mask);\r\n    }\r\n\r\n    public setMeshBuilder(layerIndex: number, meshb: IMeshBuilder, mask?: number): void {\r\n        if (mask === undefined) {\r\n            mask = MASK.ALL;\r\n        }\r\n\r\n        this.layers.set(layerIndex, { \"meshb\": meshb, \"mask\": mask });\r\n\r\n        meshb.makeSkinIndicesList();\r\n\r\n        if (layerIndex !== LAYER.MAIN) {\r\n            const mainMesh = this.layers.get(LAYER.MAIN)!.meshb.mesh;\r\n\r\n            this._setSkeleton(meshb.mesh, this.sceneData.objects[mainMesh.name].skeleton);\r\n            this.setRoom(this.sceneData.objects[mainMesh.name].roomIndex, meshb.mesh);\r\n        }\r\n\r\n        this.setMask(meshb, mask);\r\n\r\n        meshb.mesh.visible = true;\r\n    }\r\n\r\n    public updateMask(layerIndex: number, mask: number): void {\r\n        const layer = this.layers.get(layerIndex);\r\n\r\n        if (!layer) {\r\n            return;\r\n        }\r\n\r\n        layer.mask = layer.mask ^ mask;\r\n\r\n        this.setMask(layer.meshb, layer.mask);\r\n    }\r\n\r\n    public setMask(meshb: IMeshBuilder, mask: number): void {\r\n        let idx = 0,\r\n            indices: indexList = [],\r\n            skinIndices = meshb.skinIndicesList,\r\n            numMaxBones = skinIndices.length;\r\n\r\n        while (mask && idx < numMaxBones) {\r\n            const bit = mask & 1;\r\n\r\n            if (bit && skinIndices[idx] !== undefined) {\r\n                indices = indices.concat(skinIndices[idx]);\r\n            }\r\n\r\n            mask = mask >> 1;\r\n\r\n            idx++;\r\n        }\r\n\r\n        meshb.setIndex(indices);\r\n    }\r\n\r\n    public update(): void {\r\n        const position = this.layers.get(LAYER.MAIN)!.meshb.mesh.position,\r\n              quaternion = this.layers.get(LAYER.MAIN)!.meshb.mesh.quaternion,\r\n              it = this.layers.entries();\r\n\r\n        for (const [i, layer] of it) {\r\n            if (i != LAYER.MAIN) {\r\n                layer.meshb.mesh.setPosition(position);\r\n                layer.meshb.mesh.setQuaternion(quaternion);\r\n            }\r\n        }\r\n    }\r\n\r\n    public setBoundingObjects(): void {\r\n        const mainBbox = this.layers.get(LAYER.MAIN)!.meshb.mesh.getBoundingBox(),\r\n              it = this.layers.entries();\r\n\r\n        for (let [i, layer] of it) {\r\n            const mesh = layer.meshb.mesh;\r\n            if (i != LAYER.MAIN) {\r\n                mesh.setBoundingBox(mainBbox);\r\n            }\r\n        }\r\n    }\r\n\r\n    public setRoom(roomIndex: number, mesh?: IMesh): void {\r\n        if (mesh) {\r\n            this.sceneData.objects[mesh.name].roomIndex = roomIndex;\r\n            this.matMgr.setUniformsFromRoom(mesh, roomIndex);\r\n        } else {\r\n            const it = this.layers.entries();\r\n            for (let [i, layer] of it) {\r\n                const mesh = layer.meshb.mesh;\r\n                if (i != LAYER.MAIN) {\r\n                    this.sceneData.objects[mesh.name].roomIndex = roomIndex;\r\n                    this.matMgr.setUniformsFromRoom(mesh, roomIndex);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _setSkeleton(mesh: IMesh, skeleton: Skeleton) {\r\n        for (let m = 0; m < mesh.materials.length; ++m) {\r\n            const material = mesh.materials[m];\r\n\r\n            material.uniforms.boneMatrices.value = skeleton.boneMatrices;\r\n\r\n            material.uniformsUpdated([\"boneMatrices\"]);\r\n        }\r\n\r\n        this.sceneData.objects[mesh.name].skeleton = skeleton;\r\n    }\r\n\r\n}\r\n","import IGameData from \"../Player/IGameData\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { IMaterial } from \"../Proxy/IMaterial\";\r\nimport { MeshList } from \"./ObjectManager\";\r\nimport { SystemLight } from \"./SystemLight\";\r\n\r\nexport class MaterialManager {\r\n\r\n    protected _useAdditionalLights: boolean;\r\n    protected sceneData: any;\r\n    protected _sysLight: SystemLight;\r\n\r\n    constructor() {\r\n        this._useAdditionalLights = false;\r\n        this._sysLight = <any>null;\r\n    }\r\n\r\n    get useAdditionalLights(): boolean {\r\n        return this._useAdditionalLights;\r\n    }\r\n\r\n    set useAdditionalLights(u: boolean) {\r\n        this._useAdditionalLights = u;\r\n    }\r\n\r\n    public initialize(gameData: IGameData): void {\r\n        this.sceneData = gameData.sceneData;\r\n        this._sysLight = gameData.sysLight;\r\n    }\r\n\r\n    public createLightUniformsForObject(obj: IMesh, onlyGlobalLights: boolean): void {\r\n        const materials = obj.materials;\r\n        for (let m = 0; m < materials.length; ++m) {\r\n            this.createLightUniformsForMaterial(materials[m], onlyGlobalLights);\r\n        }\r\n    }\r\n\r\n    protected createLightUniformsForMaterial(material: IMaterial, onlyGlobalLights: boolean): void {\r\n        const u = material.uniforms;\r\n\r\n        u.numSystemLight                = { type: \"i\",   value: 0 };\r\n        u.systemLight_position          = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.systemLight_color             = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.systemLight_distance          = { type: \"fv1\", value: [0] };\r\n\r\n        this._sysLight.bindToUniforms(u);\r\n\r\n        u.numGlobalLight                = { type: \"i\",   value: 0 };\r\n        u.globalLight_position          = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.globalLight_color             = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.globalLight_distance          = { type: \"fv1\", value: [0] };\r\n\r\n        if (onlyGlobalLights) {\r\n            return;\r\n        }\r\n\r\n        u.numDirectionalLight           = { type: \"i\",   value: 0 };\r\n        u.directionalLight_direction    = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.directionalLight_color        = { type: \"fv\",  value: [0, 0, 0]  };\r\n\r\n        u.numPointLight                 = { type: \"i\",   value: -1 }; // -1 here means the object is internally lit\r\n        u.pointLight_position           = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.pointLight_color              = { type: \"fv\",  value: [0, 0, 0]  };\r\n        u.pointLight_distance           = { type: \"fv1\", value: [0] };\r\n\r\n        u.numSpotLight                  = { type: \"i\",   value: 0 };\r\n        u.spotLight_position            = { type: \"fv\",  value: [0 , 0, 0]  };\r\n        u.spotLight_color               = { type: \"fv\",  value: [0 , 0, 0]  };\r\n        u.spotLight_distance            = { type: \"fv1\", value: [0] };\r\n        u.spotLight_direction           = { type: \"fv\",  value: [0 , 0, 0]  };\r\n        u.spotLight_coneCos             = { type: \"fv1\", value: [0] };\r\n        u.spotLight_penumbraCos         = { type: \"fv1\", value: [0] };\r\n    }\r\n\r\n    public setUniformsFromRoom(obj: IMesh, roomIndex: number): void {\r\n        const materials = obj.materials,\r\n              roomData = this.sceneData.objects['room' + roomIndex],\r\n              data = this.sceneData.objects[obj.name];\r\n\r\n        for (let mat = 0; mat < materials.length; ++mat) {\r\n            const material = materials[mat];\r\n\r\n            if (data.type != 'moveable' || !data.internallyLit) {\r\n                material.uniforms.ambientColor.value = roomData.ambientColor;\r\n            }\r\n\r\n            this.setLightUniformsForMaterial(roomData, material, false, data.type != 'moveable' || data.internallyLit);\r\n\r\n            if (!roomData.flickering) {      material.uniforms.flickerColor.value = [1, 1, 1]; }\r\n            if (roomData.filledWithWater) {  material.uniforms.tintColor.value = [this.sceneData.waterColor.in.r, this.sceneData.waterColor.in.g, this.sceneData.waterColor.in.b]; }\r\n\r\n            material.uniformsUpdated();\r\n        }\r\n    }\r\n\r\n    protected setLightUniformsForMaterial(room: any, material: IMaterial, noreset: boolean = false, onlyGlobalLights: boolean = false) {\r\n        const u = material.uniforms;\r\n\r\n        // global lights created by the Light behaviour\r\n        if (!noreset) {\r\n            u.numGlobalLight.value = 0;\r\n        }\r\n\r\n        let lights: Array<any> = room.globalLights;\r\n\r\n        if (lights && lights.length > 0) {\r\n            for (let l = 0; l < lights.length; ++l) {\r\n                const light = lights[l];\r\n\r\n                if (u.globalLight_position.value === undefined || (!noreset && u.numGlobalLight.value == 0))  { u.globalLight_position.value = []; }\r\n                if (u.globalLight_color.value === undefined || (!noreset && u.numGlobalLight.value == 0))     { u.globalLight_color.value = []; }\r\n                if (u.globalLight_distance.value === undefined || (!noreset && u.numGlobalLight.value == 0))  { u.globalLight_distance.value = []; }\r\n\r\n                u.globalLight_position.value = u.globalLight_position.value.concat([light.x, light.y, light.z]);\r\n                u.globalLight_color.value    = u.globalLight_color.value.concat(light.color);\r\n                u.globalLight_distance.value.push(light.fadeOut);\r\n\r\n                u.numGlobalLight.value++;\r\n            }\r\n        }\r\n\r\n        if (onlyGlobalLights) {\r\n            return;\r\n        }\r\n\r\n        // regular room lights\r\n        if (!noreset) {\r\n            u.numDirectionalLight.value = 0;\r\n            u.numPointLight.value       = 0;\r\n            u.numSpotLight.value        = 0;\r\n        }\r\n\r\n        lights = this._useAdditionalLights ? room.lightsExt : room.lights;\r\n        if (lights.length == 0) {\r\n            material.uniformsUpdated();\r\n            return;\r\n        }\r\n\r\n        for (let l = 0; l < lights.length; ++l) {\r\n            const light = lights[l];\r\n\r\n            switch (light.type) {\r\n                case 'directional':\r\n                    if (u.directionalLight_direction.value === undefined || (!noreset && u.numDirectionalLight.value == 0)) { u.directionalLight_direction.value = []; }\r\n                    if (u.directionalLight_color.value === undefined || (!noreset && u.numDirectionalLight.value == 0))     { u.directionalLight_color.value = []; }\r\n\r\n                    u.directionalLight_direction.value  = u.directionalLight_direction.value.concat([light.dx, light.dy, light.dz]);\r\n                    u.directionalLight_color.value      = u.directionalLight_color.value.concat(light.color);\r\n\r\n                    u.numDirectionalLight.value++;\r\n                    break;\r\n                case 'point':\r\n                    if (u.pointLight_position.value === undefined || (!noreset && u.numPointLight.value == 0))  { u.pointLight_position.value = []; }\r\n                    if (u.pointLight_color.value === undefined || (!noreset && u.numPointLight.value == 0))     { u.pointLight_color.value = []; }\r\n                    if (u.pointLight_distance.value === undefined || (!noreset && u.numPointLight.value == 0))  { u.pointLight_distance.value = []; }\r\n\r\n                    u.pointLight_position.value = u.pointLight_position.value.concat([light.x, light.y, light.z]);\r\n                    u.pointLight_color.value    = u.pointLight_color.value.concat(light.color);\r\n                    u.pointLight_distance.value.push(light.fadeOut);\r\n\r\n                    u.numPointLight.value++;\r\n                    break;\r\n                case 'spot':\r\n                    if (u.spotLight_position.value === undefined || (!noreset && u.numSpotLight.value == 0))    { u.spotLight_position.value = []; }\r\n                    if (u.spotLight_color.value === undefined || (!noreset && u.numSpotLight.value == 0))       { u.spotLight_color.value = []; }\r\n                    if (u.spotLight_direction.value === undefined || (!noreset && u.numSpotLight.value == 0))   { u.spotLight_direction.value = []; }\r\n                    if (u.spotLight_distance.value === undefined || (!noreset && u.numSpotLight.value == 0))    { u.spotLight_distance.value = []; }\r\n                    if (u.spotLight_coneCos.value === undefined || (!noreset && u.numSpotLight.value == 0))     { u.spotLight_coneCos.value = []; }\r\n                    if (u.spotLight_penumbraCos.value === undefined || (!noreset && u.numSpotLight.value == 0)) { u.spotLight_penumbraCos.value = []; }\r\n\r\n                    u.spotLight_position.value  = u.spotLight_position.value.concat([light.x, light.y, light.z]);\r\n                    u.spotLight_color.value     = u.spotLight_color.value.concat(light.color);\r\n                    u.spotLight_direction.value = u.spotLight_direction.value.concat([light.dx, light.dy, light.dz]);\r\n                    u.spotLight_distance.value.push(light.fadeOut);\r\n                    u.spotLight_coneCos.value.push(light.coneCos);\r\n                    u.spotLight_penumbraCos.value.push(light.penumbraCos);\r\n\r\n                    u.numSpotLight.value++;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        material.uniformsUpdated();\r\n    }\r\n\r\n    public setLightUniformsForObject(obj: IMesh): void {\r\n        const data = this.sceneData.objects[obj.name];\r\n        if (data && data.roomIndex >= 0) {\r\n            const materials = obj.materials;\r\n\r\n            for (let m = 0; m < materials.length; ++m) {\r\n                const material = materials[m],\r\n                      onlyGlobalLights = !material.uniforms || material.uniforms.numPointLight === undefined || material.uniforms.numPointLight < 0;\r\n\r\n                this.setLightUniformsForMaterial(this.sceneData.objects['room' + data.roomIndex], material, false, onlyGlobalLights);\r\n            }\r\n        }\r\n    }\r\n\r\n    // update material light uniforms for all `objects`, depending on the room they are in (should be a list of moveables only!)\r\n    public setLightUniformsForObjects(objects: MeshList): void {\r\n        for (const objID in objects) {\r\n            const o = objects[objID],\r\n                  lstObj = Array.isArray(o) ? o : [o];\r\n\r\n            for (var i = 0; i < lstObj.length; ++i) {\r\n                this.setLightUniformsForObject(lstObj[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    public getFirstDirectionalLight(lights: Array<any>) {\r\n        for (let i = 0; i < lights.length; ++i) {\r\n            if (lights[i].type == 'directional') {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n}\r\n","import { ICamera } from \"../Proxy/ICamera\";\r\nimport { IMaterial } from \"../Proxy/IMaterial\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\nimport { Position } from \"../Proxy/INode\";\r\n\r\nimport { AnimationManager } from \"../Animation/AnimationManager\";\r\nimport { BehaviourManager } from \"../Behaviour/BehaviourManager\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { MaterialManager } from \"./MaterialManager\";\r\nimport { Skeleton } from \"../Player/Skeleton\";\r\n\r\nexport interface MeshList {\r\n    [id: number]: IMesh | Array<IMesh>;\r\n}\r\n\r\ninterface Meshes {\r\n    [name: string]: MeshList;\r\n}\r\n\r\nexport class ObjectManager {\r\n\r\n    public objectList: Meshes;\r\n\r\n    private count: number;\r\n    private gameData: IGameData;\r\n    private sceneRender: IScene;\r\n    private sceneData: any;\r\n    private bhvMgr: BehaviourManager;\r\n    private matMgr: MaterialManager;\r\n    private anmMgr: AnimationManager;\r\n    private camera: ICamera;\r\n\r\n    constructor() {\r\n        this.objectList = <any>null;\r\n        this.count = 0;\r\n        this.sceneRender = <any>null;\r\n        this.bhvMgr = <any>null;\r\n        this.matMgr = <any>null;\r\n        this.anmMgr = <any>null;\r\n        this.gameData = <any>null;\r\n        this.camera = <any>null;\r\n    }\r\n\r\n    public initialize(gameData: IGameData): void {\r\n        this.gameData = gameData;\r\n        this.sceneRender = gameData.sceneRender;\r\n        this.sceneData = gameData.sceneData;\r\n        this.matMgr = gameData.matMgr;\r\n        this.bhvMgr = gameData.bhvMgr;\r\n        this.anmMgr = gameData.anmMgr;\r\n        this.camera = gameData.camera;\r\n\r\n        this.buildLists();\r\n    }\r\n\r\n    public buildLists(): void {\r\n        this.objectList = {\r\n            \"moveable\":     {},\r\n            \"room\":         {},\r\n            \"staticmesh\":   {},\r\n            \"sprite\":       {},\r\n            \"spriteseq\":    {}\r\n        };\r\n\r\n        this.sceneRender.traverse((obj: IMesh) => {\r\n            const data = this.sceneData.objects[obj.name];\r\n\r\n            if (!data) { return; }\r\n\r\n            const id: number = data.objectid,\r\n                  type: string = data.type;\r\n\r\n            let objs: MeshList = this.objectList[type];\r\n            if (!objs) {\r\n                objs = {};\r\n                this.objectList[type] = objs;\r\n            }\r\n\r\n            if (type === 'room') {\r\n                objs[id] = obj;\r\n            } else {\r\n                let objsForId = objs[id];\r\n                if (!objsForId) {\r\n                    objsForId = [];\r\n                    objs[id] = objsForId;\r\n                } else if (!Array.isArray(objsForId)) {\r\n                    throw \"Bug!!\";\r\n                }\r\n                objsForId.push(obj);\r\n            }\r\n        });\r\n    }\r\n\r\n    public createSprite(spriteID: number, roomIndex: number, color: Array<number>, addToScene: boolean = true): IMesh | null {\r\n        const data = this.sceneData.objects[spriteID < 0 ? 'spriteseq' + (-spriteID) : 'sprite' + spriteID];\r\n\r\n        if (spriteID < 0) {\r\n            spriteID = -spriteID;\r\n        }\r\n\r\n        if (!data || !data.liveObj) {\r\n            return null;\r\n        }\r\n\r\n        let obj = (data.liveObj as IMesh).clone();\r\n\r\n        // copy material\r\n        const newMaterial: Array<IMaterial> = [];\r\n\r\n        for (let m = 0; m < obj.materials.length; ++m) {\r\n            const material = obj.materials[m];\r\n\r\n            newMaterial[m] = material.clone();\r\n            newMaterial[m].uniforms.lighting.value = color;\r\n            newMaterial[m].uniforms.map.value = material.uniforms.map.value;\r\n            newMaterial[m].uniforms.mapBump.value = material.uniforms.mapBump.value;\r\n\r\n            newMaterial[m].uniformsUpdated();\r\n        }\r\n\r\n        obj.materials = newMaterial;\r\n        obj.name = data.type + spriteID + '_room' + roomIndex + '_dyncreate_' + (this.count++);\r\n        obj.visible = true;\r\n\r\n        const newData = {\r\n            \"type\"   \t            : data.type,\r\n            \"roomIndex\"             : roomIndex,\r\n            \"has_anims\"\t\t\t\t: false,\r\n            \"objectid\"              : data.objectid,\r\n            \"visible\"  \t\t\t\t: true\r\n        };\r\n\r\n        this.sceneData.objects[obj.name] = newData;\r\n\r\n        let lst = this.objectList[data.type][spriteID];\r\n        if (!lst) {\r\n            lst = [];\r\n            this.objectList[data.type][spriteID] = lst;\r\n        }\r\n\r\n        (lst as Array<IMesh>).push(obj);\r\n\r\n        this.matMgr.createLightUniformsForObject(obj, true);\r\n\r\n        if (addToScene) {\r\n            this.sceneRender.add(obj);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    public createStaticMesh(staticmeshID: number, roomIndex: number, color: Array<number>, addToScene: boolean = true): IMesh | null {\r\n        const data = this.sceneData.objects['staticmesh' + staticmeshID];\r\n\r\n        if (!data || !data.liveObj) {\r\n            return null;\r\n        }\r\n\r\n        let obj = (data.liveObj as IMesh).clone();\r\n\r\n        // copy material\r\n        const newMaterial: Array<IMaterial> = [];\r\n\r\n        for (let m = 0; m < obj.materials.length; ++m) {\r\n            const material = obj.materials[m];\r\n\r\n            newMaterial[m] = material.clone();\r\n            newMaterial[m].uniforms.lighting.value = color;\r\n            newMaterial[m].uniforms.map.value = material.uniforms.map.value;\r\n            newMaterial[m].uniforms.mapBump.value = material.uniforms.mapBump.value;\r\n\r\n            newMaterial[m].uniformsUpdated();\r\n        }\r\n\r\n        obj.materials = newMaterial;\r\n        obj.name = 'staticmesh' + staticmeshID + '_room' + roomIndex + '_dyncreate_' + (this.count++);\r\n        obj.visible = true;\r\n\r\n        const newData = {\r\n            \"type\"   \t            : 'staticmesh',\r\n            \"roomIndex\"             : roomIndex,\r\n            \"has_anims\"\t\t\t\t: false,\r\n            \"objectid\"              : data.objectid,\r\n            \"visible\"  \t\t\t\t: true\r\n        };\r\n\r\n        this.sceneData.objects[obj.name] = newData;\r\n\r\n        let lst = this.objectList[data.type][staticmeshID];\r\n        if (!lst) {\r\n            lst = [];\r\n            this.objectList[data.type][staticmeshID] = lst;\r\n        }\r\n\r\n        (lst as Array<IMesh>).push(obj);\r\n\r\n        this.matMgr.createLightUniformsForObject(obj, true);\r\n\r\n        if (addToScene) {\r\n            this.sceneRender.add(obj);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    public createMoveable(moveableID: number, roomIndex: number, extrnColor?: Array<number>, addToScene: boolean = true, setAnimation: boolean | Skeleton = true): IMesh | null {\r\n        const data = this.sceneData.objects['moveable' + moveableID];\r\n\r\n        if (!data || !data.liveObj) {\r\n            return null;\r\n        }\r\n\r\n        let obj = (data.liveObj as IMesh).clone();\r\n\r\n        // copy material\r\n        const newMaterial: Array<IMaterial> = [];\r\n\r\n        const skeleton = typeof(setAnimation) == 'boolean' ? new Skeleton(data.bonesStartingPos) : setAnimation;\r\n\r\n        for (let m = 0; m < obj.materials.length; ++m) {\r\n            const material = obj.materials[m];\r\n\r\n            newMaterial[m] = material.clone();\r\n            newMaterial[m].uniforms.map.value = material.uniforms.map.value;\r\n            newMaterial[m].uniforms.mapBump.value = material.uniforms.mapBump.value;\r\n            newMaterial[m].uniforms.boneMatrices = { \"type\": \"m4v\", \"value\": null };\r\n            if (skeleton) {\r\n                newMaterial[m].uniforms.boneMatrices.value = skeleton.boneMatrices;\r\n            }\r\n\r\n            if (extrnColor) {\r\n                newMaterial[m].uniforms.ambientColor.value = extrnColor;\r\n            }\r\n\r\n            newMaterial[m].uniformsUpdated();\r\n        }\r\n\r\n        obj.materials = newMaterial;\r\n        obj.name = 'moveable' + moveableID + '_room' + roomIndex + '_dyncreate_' + (this.count++);\r\n        obj.visible = true;\r\n        obj.matrixAutoUpdate = true;\r\n\r\n        const newData: any = {\r\n            \"type\"   \t            : 'moveable',\r\n            \"roomIndex\"             : roomIndex,\r\n            \"has_anims\"\t\t\t\t: data.has_anims && typeof(setAnimation) == 'boolean',\r\n            \"objectid\"              : data.objectid,\r\n            \"visible\"  \t\t\t\t: true,\r\n            \"internallyLit\"         : extrnColor != undefined,\r\n            \"skeleton\"              : skeleton\r\n        };\r\n\r\n        this.sceneData.objects[obj.name] = newData;\r\n\r\n        if (newData.has_anims) {\r\n            newData.animationStartIndex = data.animationStartIndex;\r\n            newData.numAnimations = data.numAnimations;\r\n        }\r\n\r\n        let lst = this.objectList['moveable'][moveableID];\r\n        if (!lst) {\r\n            lst = [];\r\n            this.objectList['moveable'][moveableID] = lst;\r\n        }\r\n\r\n        (lst as Array<IMesh>).push(obj);\r\n\r\n        this.matMgr.createLightUniformsForObject(obj, false);\r\n\r\n        if (addToScene) {\r\n            this.sceneRender.add(obj);\r\n        }\r\n\r\n        if (typeof(setAnimation) == 'boolean' && setAnimation && data.has_anims) {\r\n            this.anmMgr.setAnimation(obj, 0, false);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    public removeObjectFromScene(obj: IMesh, removeBehaviours?: boolean) {\r\n        if (removeBehaviours === undefined) {\r\n            removeBehaviours = true;\r\n        }\r\n\r\n        if (removeBehaviours) {\r\n            this.bhvMgr.removeBehaviours(obj);\r\n        }\r\n\r\n        this.sceneRender.remove(obj);\r\n    }\r\n\r\n    protected _collectObjectsWithAnimatedTextures(lst: MeshList): Array<IMesh> {\r\n        const objs: Array<IMesh> = [];\r\n\r\n        for (const objID in lst) {\r\n            let lstObjs = lst[objID];\r\n\r\n            if (!Array.isArray(lstObjs)) {\r\n                lstObjs = [lstObjs];\r\n            }\r\n\r\n            for (let i = 0; i < lstObjs.length; ++i) {\r\n                const obj = lstObjs[i],\r\n                      materials = obj.materials;\r\n\r\n                for (let m = 0; m < materials.length; ++m) {\r\n                    const material = materials[m],\r\n                          userData = material.userData;\r\n\r\n                    if (!userData || !userData.animatedTexture) {\r\n                        continue;\r\n                    }\r\n\r\n                    const animTexture = this.sceneData.animatedTextures[userData.animatedTexture.idxAnimatedTexture];\r\n\r\n                    if (!animTexture.scrolltexture) {\r\n                        objs.push(obj);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return objs;\r\n    }\r\n\r\n    public collectObjectsWithAnimatedTextures(): Array<IMesh> {\r\n        let objs = this._collectObjectsWithAnimatedTextures(this.objectList['room']);\r\n\r\n        objs = objs.concat(this._collectObjectsWithAnimatedTextures(this.objectList['sprite']));\r\n\r\n        objs = objs.concat(this._collectObjectsWithAnimatedTextures(this.objectList['spriteseq']));\r\n\r\n        return objs;\r\n    }\r\n\r\n    public updateObjects(curTime: number): void {\r\n        this.gameData.curRoom = -1;\r\n\r\n        const camPos = this.camera.position;\r\n\r\n        this.sceneRender.traverse((obj) => {\r\n            const data = this.sceneData.objects[obj.name];\r\n\r\n            if (!data) {\r\n                return;\r\n            }\r\n\r\n            // Test camera room membership\r\n            if (data.type == 'room') {\r\n                if (obj.containsPoint(this.gameData.camera.position) && !data.isAlternateRoom) {\r\n                //if (!data.isAlternateRoom && this.gameData.trlvl.isPointInRoom(this.gameData.camera.position, data.roomIndex)) {\r\n                    this.gameData.curRoom = data.roomIndex;\r\n                }\r\n            }\r\n\r\n            // Set the visibility for the object\r\n            if (this.gameData.singleRoomMode) {\r\n                obj.visible = data.roomIndex == this.gameData.curRoom && !data.isAlternateRoom;\r\n            } else {\r\n                obj.visible = data.visible;\r\n            }\r\n\r\n            // Update material uniforms\r\n            const materials = obj.materials,\r\n                  room = this.sceneData.objects['room' + data.roomIndex];\r\n\r\n            if (room < 0) {\r\n                return;\r\n            }\r\n\r\n            for (let i = 0; i < materials.length; ++i) {\r\n                const material = materials[i];\r\n\r\n                if (this.gameData.globalTintColor != null) {\r\n                    material.uniforms.tintColor.value = this.gameData.globalTintColor;\r\n                }\r\n\r\n                material.uniforms.numSystemLight.value = this.gameData.sysLight.numLights;\r\n                material.uniforms.curTime.value = curTime;\r\n                material.uniforms.rnd.value = this.gameData.quantumRnd;\r\n                material.uniforms.flickerColor.value = room && room.flickering ? this.gameData.flickerColor : this.gameData.unitVec3;\r\n                material.uniforms.camPosition.value = camPos;\r\n\r\n                material.uniformsUpdated([\"tintColor\", \"numSystemLight\", \"curTime\", \"rnd\", \"flickerColor\", \"camPosition\"]);\r\n            }\r\n        });\r\n    }\r\n\r\n    public getRoomByPos(pos: Position): number {\r\n        const roomList = this.objectList['room'];\r\n        for (const r in roomList) {\r\n            const obj = roomList[r], data = this.sceneData.objects[(obj as IMesh).name];\r\n            if (data.isAlternateRoom) {\r\n                continue;\r\n            }\r\n            if (!Array.isArray(obj) && obj.containsPoint(pos)) {\r\n                return parseInt(r);\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    public changeRoomMembership(obj: IMesh, oldRoomIndex: number, newRoomIndex: number): void {\r\n        const data = this.sceneData.objects[obj.name];\r\n\r\n        const dataCurRoom = this.sceneData.objects['room' + oldRoomIndex],\r\n              curRoomLights = this.matMgr.useAdditionalLights ? dataCurRoom.lightsExt : dataCurRoom.lights,\r\n              curLIdx = this.matMgr.getFirstDirectionalLight(curRoomLights);\r\n\r\n        const dataNewRoom = this.sceneData.objects['room' + newRoomIndex],\r\n              newRoomLights = this.matMgr.useAdditionalLights ? dataNewRoom.lightsExt : dataNewRoom.lights,\r\n              newLIdx = this.matMgr.getFirstDirectionalLight(newRoomLights);\r\n\r\n        data.roomIndex = newRoomIndex;\r\n\r\n        this.matMgr.setUniformsFromRoom(obj, newRoomIndex);\r\n\r\n        if (data.layer) {\r\n            data.layer.setRoom(newRoomIndex);\r\n        }\r\n\r\n        if (curLIdx >= 0 && newLIdx >= 0) {\r\n            const uniforms = [];\r\n            for (let i = 0; i < obj.materials.length; ++i) {\r\n                const material = obj.materials[i];\r\n                uniforms.push({ a: material.uniforms.directionalLight_color.value, i: 0 });\r\n            }\r\n            this.bhvMgr.addBehaviour('FadeUniformColor',\r\n                {\r\n                    \"colorStart\":   curRoomLights[curLIdx].color,\r\n                    \"colorEnd\":     newRoomLights[newLIdx].color,\r\n                    \"duration\":     1.0,\r\n                    \"uniforms\":     uniforms\r\n                }\r\n            );\r\n        }\r\n    }\r\n\r\n}\r\n","import Engine from \"../Proxy/Engine\";\r\n\r\nimport { Position } from \"../Proxy/INode\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\nimport { IRenderer } from \"../Proxy/IRenderer\";\r\n\r\nimport Browser from \"../Utils/Browser\";\r\nimport IGameData from \"./IGameData\";\r\nimport { baseFrameRate, ObjectID } from \"../Constants\";\r\nimport { RawLevel } from \"../Loading/LevelLoader\";\r\nimport { AnimationManager } from \"../Animation/AnimationManager\";\r\nimport { BasicControl } from \"../Behaviour/BasicControl\";\r\nimport { Behaviour } from \"../Behaviour/Behaviour\";\r\nimport { BehaviourManager } from \"../Behaviour/BehaviourManager\";\r\nimport { ObjectManager } from \"./ObjectManager\";\r\nimport { MaterialManager } from \"./MaterialManager\";\r\nimport { TRLevel } from \"./TRLevel\";\r\nimport { Panel } from \"../Utils/Panel\";\r\nimport { SystemLight } from \"./SystemLight\";\r\n\r\ndeclare var Stats: any;\r\n\r\nexport default class Play {\r\n\r\n    public  gameData: IGameData;\r\n\r\n    private renderer: IRenderer;\r\n    private stats: any;\r\n    private ofstTime: number;\r\n    private freezeTime: number;\r\n    private initsDone: boolean;\r\n\r\n    constructor(container: Element) {\r\n        this.gameData = {\r\n            \"relpath\": Browser.QueryString.relpath || \"/\",\r\n            \"play\": this,\r\n\r\n            \"curFrame\": 0,\r\n            \"container\": container,\r\n\r\n            \"curRoom\": -1,\r\n            \"camera\": <any>null,\r\n\r\n            \"sceneRender\": <any>null,\r\n            \"sceneBackground\": <any>null,\r\n            \"sceneData\": null,\r\n\r\n            \"singleRoomMode\": false,\r\n\r\n            \"panel\": <any>null,\r\n\r\n            \"bhvMgr\": <any>null,\r\n            \"objMgr\": <any>null,\r\n            \"matMgr\": <any>null,\r\n            \"confMgr\": <any>null,\r\n            \"trlvl\":  <any>null,\r\n            \"anmMgr\": <any>null,\r\n            \"shdMgr\": <any>null,\r\n            \"sysLight\": <any>null,\r\n\r\n            \"startTime\": -1,\r\n            \"lastTime\": -1,\r\n            \"quantum\": 1 / baseFrameRate,\r\n            \"quantumTime\": -1,\r\n            \"quantumRnd\": 0,\r\n\r\n            \"flickerColor\" : [1.2, 1.2, 1.2],\r\n            \"unitVec3\" : [1.0, 1.0, 1.0],\r\n            \"globalTintColor\":  null,\r\n\r\n            \"isCutscene\": false,\r\n            \"singleFrame\": false,\r\n            \"update\": true,\r\n\r\n            \"fps\": 0\r\n        };\r\n\r\n        this.renderer = Engine.createRenderer(this.gameData.container);\r\n        this.renderer.setSize(jQuery(this.gameData.container).width() as number, jQuery(this.gameData.container).height() as number);\r\n\r\n        this.gameData.panel = new Panel(this.gameData.container, this.gameData, this.renderer);\r\n        this.gameData.panel.hide();\r\n\r\n        this.stats = new Stats();\r\n        this.stats.domElement.style.position = 'absolute';\r\n        this.stats.domElement.style.top = '0px';\r\n        this.stats.domElement.style.right = '0px';\r\n        this.stats.domElement.style.zIndex = 100;\r\n\r\n        this.ofstTime = 0;\r\n        this.freezeTime = 0;\r\n        this.initsDone = false;\r\n\r\n        this.gameData.container.append(this.stats.domElement);\r\n\r\n        Browser.bindRequestPointerLock(document.body);\r\n        Browser.bindRequestFullscreen(document.body);\r\n    }\r\n\r\n    public async initialize(sceneJSON: RawLevel, scene: IScene) {\r\n        this.gameData.sceneData = sceneJSON.data;\r\n        this.gameData.sceneRender = scene;\r\n        this.gameData.sceneBackground = this.renderer.createScene();\r\n\r\n        Engine.activeScene = scene;\r\n\r\n        const camera = this.gameData.sceneRender.getCamera();\r\n\r\n        if (camera !== undefined) {\r\n            this.gameData.camera = camera;\r\n        } else {\r\n            console.log(\"Can't find camera!\");\r\n        }\r\n\r\n        /*camera.setPosition([26686, 472, -67788]);\r\n        camera.setQuaternion([0.00564, 0.99346, 0.05650, -0.09910]);\r\n        camera.updateMatrixWorld();\r\n        camera.updateProjectionMatrix();*/\r\n\r\n        this.gameData.confMgr   = this.gameData.sceneData.trlevel.confMgr;\r\n        this.gameData.bhvMgr    = new BehaviourManager();\r\n        this.gameData.matMgr    = new MaterialManager();\r\n        this.gameData.objMgr    = new ObjectManager();\r\n        this.gameData.trlvl     = new TRLevel();\r\n        this.gameData.anmMgr    = new AnimationManager();\r\n        this.gameData.shdMgr    = Engine.getShaderMgr();\r\n        this.gameData.sysLight  = new SystemLight();\r\n\r\n        this.gameData.bhvMgr.initialize(this.gameData);\r\n        this.gameData.matMgr.initialize(this.gameData);\r\n        this.gameData.objMgr.initialize(this.gameData);\r\n        this.gameData.trlvl.initialize(this.gameData);\r\n        this.gameData.anmMgr.initialize(this.gameData);\r\n\r\n        delete this.gameData.sceneData.trlevel.confMgr;\r\n        delete this.gameData.sceneData.trlevel;\r\n\r\n        const isCutScene = this.gameData.confMgr.param('', false, true).attr('type') == 'cutscene',\r\n              cutsceneIndex = this.gameData.sceneData.rversion == 'TR4' && Browser.QueryString.cutscene != undefined ? parseInt(Browser.QueryString.cutscene) : -1;\r\n\r\n        this.gameData.isCutscene = isCutScene || cutsceneIndex > 0;\r\n\r\n        const tintColor = this.gameData.confMgr.color('globaltintcolor', true);\r\n\r\n        if (tintColor != null) {\r\n            this.gameData.globalTintColor = [tintColor.r, tintColor.g, tintColor.b];\r\n        }\r\n\r\n        if (this.gameData.sceneData.rversion != 'TR4') {\r\n            jQuery('#nobumpmapping').prop('disabled', 'disabled');\r\n        }\r\n\r\n        if (Browser.QueryString.pos) {\r\n            const vals = Browser.QueryString.pos.split(',');\r\n            this.gameData.camera.setPosition([parseFloat(vals[0]), parseFloat(vals[1]), parseFloat(vals[2])]);\r\n        }\r\n\r\n        if (Browser.QueryString.rot) {\r\n            const vals = Browser.QueryString.rot.split(',');\r\n            this.gameData.camera.setQuaternion([parseFloat(vals[0]), parseFloat(vals[1]), parseFloat(vals[2]), parseFloat(vals[3])]);\r\n        }\r\n\r\n        this.gameData.trlvl.createObjectsInLevel();\r\n\r\n        // create behaviours\r\n        let allPromises: Array<Promise<void>> = this.gameData.bhvMgr.loadBehaviours() || [];\r\n\r\n        allPromises = allPromises.concat(this.gameData.bhvMgr.addBehaviour('Sprite') || []);\r\n        allPromises = allPromises.concat(this.gameData.bhvMgr.addBehaviour('AnimatedTexture', undefined, undefined, undefined, this.gameData.objMgr.collectObjectsWithAnimatedTextures()) || []);\r\n\r\n        if (cutsceneIndex >= 0) {\r\n            allPromises = allPromises.concat(this.gameData.bhvMgr.addBehaviour('CutScene', { \"index\": cutsceneIndex, \"useadditionallights\": true }) || []);\r\n        }\r\n\r\n        await Promise.all(allPromises);\r\n\r\n        // set uniforms on objects\r\n        this.gameData.sceneRender.traverse((obj) => {\r\n            const data = this.gameData.sceneData.objects[obj.name];\r\n\r\n            if (!data || data.roomIndex < 0) { return; }\r\n\r\n            this.gameData.matMgr.setUniformsFromRoom(obj, data.roomIndex);\r\n        });\r\n\r\n        const otherPromises = BehaviourManager.onEngineInitialized(this.gameData);\r\n\r\n        if (Array.isArray(otherPromises) && otherPromises.length > 0) {\r\n            await Promise.all(otherPromises);\r\n        }\r\n\r\n        return Promise.resolve();\r\n    }\r\n\r\n    public play(onceOnly: boolean = false, update: boolean = true): void {\r\n        this.gameData.singleFrame = onceOnly;\r\n        this.gameData.update = update;\r\n\r\n        if (!this.initsDone) {\r\n            this.initsDone = true;\r\n\r\n            this.gameData.panel.show();\r\n            this.gameData.panel.updateFromParent();\r\n\r\n            window.addEventListener('resize', this.onWindowResize.bind(this), false);\r\n\r\n            this.gameData.bhvMgr.onBeforeRenderLoop();\r\n\r\n            this.gameData.startTime = this.gameData.lastTime = this.gameData.quantumTime = (new Date()).getTime() / 1000.0;\r\n        }\r\n\r\n        this.setSizes(true);\r\n\r\n        if (onceOnly) {\r\n            this.render();\r\n        } else {\r\n            this.renderLoop();\r\n        }\r\n    }\r\n\r\n    public goto(name: string, type?: string): void {\r\n        let objTypeList = [];\r\n        if (type !== undefined) {\r\n            objTypeList = [type];\r\n        } else {\r\n            objTypeList = [\"moveable\", \"room\", \"staticmesh\", \"sprite\", \"spriteseq\"];\r\n        }\r\n\r\n        let choice1: Position | null = null, choice2: Position | null = null;\r\n        objTypeList.forEach((tp) => {\r\n            const list = this.gameData.objMgr.objectList[tp];\r\n            for (const id in list) {\r\n                const lstObjs_ = list[id];\r\n                (Array.isArray(lstObjs_) ? lstObjs_ : [lstObjs_]).forEach((obj) => {\r\n                    const data = this.gameData.sceneData.objects[obj.name];\r\n                    if (obj.name === name || obj.name.indexOf(name) >= 0) {\r\n                        let pos: Position = [0, 0, 0];\r\n                        if (data.type == 'room') {\r\n                            const bb = obj.getBoundingBox();\r\n                            pos = [(bb.min[0] + bb.max[0]) / 2, (bb.min[1] + bb.max[1]) / 2, (bb.min[2] + bb.max[2]) / 2];\r\n                        } else {\r\n                            pos = obj.position;\r\n                        }\r\n                        if (obj.name === name) {\r\n                            choice1 = pos;\r\n                        } else {\r\n                            choice2 = pos;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        if (!choice1 && !choice2) {\r\n            const partsys: any = (this.gameData.sceneRender as any)._scene;\r\n            if (partsys && partsys.particleSystems) {\r\n                (<Array<any>>partsys.particleSystems).forEach((psys) => {\r\n                    if (<string>psys.name === name) {\r\n                        choice1 = [psys.worldOffset.x, psys.worldOffset.y, psys.worldOffset.z];\r\n                    } else if ((<string>psys.name).indexOf(name) >= 0) {\r\n                        choice2 = [psys.worldOffset.x, psys.worldOffset.y, psys.worldOffset.z];\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if (choice1) {\r\n            this.gameData.camera.setPosition(choice1);\r\n        } else if (choice2) {\r\n            this.gameData.camera.setPosition(choice2);\r\n        }\r\n    }\r\n\r\n    private renderLoop(): void {\r\n        requestAnimationFrame(this.renderLoop.bind(this));\r\n\r\n        if (!this.gameData.singleFrame) {\r\n            if (this.freezeTime > 0) {\r\n                this.ofstTime += (new Date()).getTime() / 1000.0 - this.freezeTime;\r\n                this.freezeTime = 0;\r\n            }\r\n        }\r\n\r\n        this.render();\r\n    }\r\n\r\n    public render(forceUpdate: boolean = false): void {\r\n        if (this.gameData.singleFrame) {\r\n            if (this.freezeTime > 0) {\r\n                this.ofstTime += (new Date()).getTime() / 1000.0 - this.freezeTime;\r\n                this.freezeTime = 0;\r\n            }\r\n        }\r\n\r\n        let curTime = (new Date()).getTime() / 1000.0 - this.ofstTime,\r\n            delta = curTime - this.gameData.lastTime;\r\n\r\n        this.gameData.lastTime = curTime;\r\n\r\n        if (curTime - this.gameData.quantumTime > this.gameData.quantum) {\r\n            this.gameData.quantumRnd = Math.random();\r\n            this.gameData.quantumTime = curTime;\r\n        }\r\n\r\n        curTime = curTime - this.gameData.startTime;\r\n\r\n        if (delta > 0.1) { delta = 0.1; }\r\n\r\n        this.gameData.fps = delta ? 1 / delta : 60;\r\n\r\n        if (this.gameData.update || forceUpdate) {\r\n            this.gameData.bhvMgr.onFrameStarted(curTime, delta);\r\n\r\n            this.gameData.anmMgr.animateObjects(delta);\r\n        } else {\r\n            // we still want to be able to move the camera in the \"no update\" mode\r\n            const bhvCtrl = (this.gameData.bhvMgr.getBehaviour(\"BasicControl\") as Array<Behaviour>)[0] as BasicControl;\r\n\r\n            bhvCtrl.onFrameStarted(curTime, delta);\r\n        }\r\n\r\n        this.gameData.camera.updateMatrixWorld();\r\n\r\n        this.gameData.objMgr.updateObjects(curTime);\r\n\r\n        if (this.gameData.update || forceUpdate) {\r\n\r\n            this.gameData.bhvMgr.onFrameEnded(curTime, delta);\r\n        }\r\n\r\n        this.renderer.clear();\r\n\r\n        this.renderer.render(this.gameData.sceneBackground, this.gameData.camera);\r\n\r\n        this.renderer.render(this.gameData.sceneRender, this.gameData.camera);\r\n\r\n        this.stats.update();\r\n\r\n        this.gameData.panel.showInfo();\r\n\r\n        this.gameData.curFrame++;\r\n\r\n        if (this.gameData.singleFrame) {\r\n            this.freezeTime = (new Date()).getTime() / 1000.0;\r\n        }\r\n    }\r\n\r\n    private setSizes(noRendering: boolean): void {\r\n        const w = jQuery(this.gameData.container).width() as number,\r\n              h = jQuery(this.gameData.container).height() as number;\r\n\r\n        this.gameData.camera.aspect = w / h;\r\n        this.gameData.camera.updateProjectionMatrix();\r\n\r\n        this.renderer.setSize(w, h);\r\n\r\n        if (!noRendering) {\r\n            this.render();\r\n        }\r\n    }\r\n\r\n    private onWindowResize(): void {\r\n        this.setSizes(false);\r\n    }\r\n\r\n}\r\n","export default class Sequence {\n\n    protected numberOfTiles: number;\n    protected tileDisplayDuration: number;\n    protected currentDisplayTime: number;\n    protected currentTile: number;\n\n    constructor(numTiles: number, tileDispDuration: number) {\n        this.numberOfTiles = numTiles;\n        this.tileDisplayDuration = tileDispDuration;\n\n        // how long has the current image been displayed?\n        this.currentDisplayTime = 0;\n\n        // which image is currently being displayed?\n        this.currentTile = 0;\n    }\n\n    public update(milliSec: number) {\n        this.currentDisplayTime += milliSec;\n        while (this.currentDisplayTime > this.tileDisplayDuration) {\n            this.currentDisplayTime -= this.tileDisplayDuration;\n            this.currentTile++;\n            if (this.currentTile == this.numberOfTiles) {\n                this.currentTile = 0;\n            }\n        }\n    }\n}\n","import Engine from \"../Proxy/Engine\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { INode, Position, Quaternion } from \"../Proxy/INode\";\r\nimport { Basis } from \"./Basis\";\r\n\r\nexport enum BONE {\r\n    HIPS    = 0,\r\n    LEG_L1  = 1,\r\n    LEG_L2  = 2,\r\n    LEG_L3  = 3,\r\n    LEG_R1  = 4,\r\n    LEG_R2  = 5,\r\n    LEG_R3  = 6,\r\n    CHEST   = 7,\r\n    ARM_R1  = 8,\r\n    ARM_R2  = 9,\r\n    ARM_R3  = 10,\r\n    ARM_L1  = 11,\r\n    ARM_L2  = 12,\r\n    ARM_L3  = 13,\r\n    HEAD    =  14,\r\n}\r\n\r\nexport enum MASK {\r\n    HIPS    =  1 << BONE.HIPS,\r\n    LEG_L1  =  1 << BONE.LEG_L1,\r\n    LEG_L2  =  1 << BONE.LEG_L2,\r\n    LEG_L3  =  1 << BONE.LEG_L3,\r\n    LEG_R1  =  1 << BONE.LEG_R1,\r\n    LEG_R2  =  1 << BONE.LEG_R2,\r\n    LEG_R3  =  1 << BONE.LEG_R3,\r\n    CHEST   =  1 << BONE.CHEST,\r\n    ARM_R1  =  1 << BONE.ARM_R1,\r\n    ARM_R2  =  1 << BONE.ARM_R2,\r\n    ARM_R3  =  1 << BONE.ARM_R3,\r\n    ARM_L1  =  1 << BONE.ARM_L1,\r\n    ARM_L2  =  1 << BONE.ARM_L2,\r\n    ARM_L3  =  1 << BONE.ARM_L3,\r\n    HEAD    =  1 << BONE.HEAD,\r\n\r\n    ARM_L   =   ARM_L1 | ARM_L2 | ARM_L3,\r\n    ARM_R   =   ARM_R1 | ARM_R2 | ARM_R3,\r\n    LEG_L   =   LEG_L1 | LEG_L2 | LEG_L3,\r\n    LEG_R   =   LEG_R1 | LEG_R2 | LEG_R3,\r\n    BRAID   =   HEAD   | CHEST  | ARM_L1 | ARM_L2 | ARM_R1 | ARM_R2,\r\n\r\n    UPPER   =   CHEST  | ARM_L  | ARM_R,       // without head\r\n    LOWER   =   HIPS   | LEG_L  | LEG_R,\r\n\r\n    ALL     =   0xFFFFFFFF,\r\n}\r\n\r\nexport class Skeleton {\r\n\r\n    private _bones:             Array<INode>;\r\n    private _bonesStartingPos:  Array<any>;\r\n    private _boneMatrices:      Float32Array;\r\n\r\n    constructor(bonesStartingPos: any) {\r\n        this._bones = [];\r\n        this._bonesStartingPos = bonesStartingPos;\r\n\r\n        this._boneMatrices = new Float32Array(64 * 16);\r\n\r\n        for (let i = 0; i < 64; ++i) {\r\n            this._boneMatrices.set([1], 0 + 16 * i);\r\n            this._boneMatrices.set([1], 5 + 16 * i);\r\n            this._boneMatrices.set([1], 10 + 16 * i);\r\n            this._boneMatrices.set([1], 15 + 16 * i);\r\n        }\r\n\r\n        for (let b = 0; b < bonesStartingPos.length; ++b) {\r\n            const parent = bonesStartingPos[b].parent,\r\n                  bone = Engine.makeNode(\"Skeleton bone node\", Engine.activeScene);\r\n\r\n            this.bones.push(bone);\r\n\r\n            if (parent >= 0) {\r\n                this.bones[parent].add(bone);\r\n            }\r\n        }\r\n    }\r\n\r\n    get bones(): Array<INode> {\r\n        return this._bones;\r\n    }\r\n\r\n    get bonesStartingPos(): Array<any> {\r\n        return this._bonesStartingPos;\r\n    }\r\n\r\n    get boneMatrices(): Float32Array {\r\n        return this._boneMatrices;\r\n    }\r\n\r\n    public getBoneDecomposition(bone: number, parentMesh?: IMesh): Basis {\r\n        const _pos: Position = [0, 0, 0], _quat: Quaternion = [0, 0, 0, 0];\r\n\r\n        this.bones[bone].decomposeMatrixWorld(_pos, _quat);\r\n\r\n        if (parentMesh === undefined) {\r\n            return new Basis(_pos, _quat);\r\n        }\r\n\r\n        const meshBasis = new Basis(parentMesh.position, parentMesh.quaternion),\r\n              boneBasis = new Basis(_pos, _quat);\r\n\r\n        return meshBasis.multBasis(boneBasis);\r\n    }\r\n\r\n    public updateBoneMatrices(): void {\r\n        this._bones[0].updateMatrixWorld(); // will triger updateMatrixWorld for all descendants of bone #0\r\n        this.setBoneMatrices();\r\n    }\r\n\r\n    public setBoneMatrices() {\r\n        for (let b = 0; b < this._bones.length; b ++) {\r\n            const bone = this._bones[b];\r\n\r\n            bone.matrixWorldToArray(this._boneMatrices, b * 16);\r\n        }\r\n    }\r\n\r\n}\r\n","export class SystemLight {\r\n\r\n    private static __id: number = 0;\r\n\r\n    protected _positions:   Array<number>;\r\n    protected _colors:      Array<number>;\r\n    protected _fadeouts:    Array<number>;\r\n    protected _lightIds:    Array<number>;\r\n\r\n    constructor() {\r\n        this._positions = [0, 0, 0];\r\n        this._colors = [0, 0, 0];\r\n        this._fadeouts = [0];\r\n        this._lightIds = [];\r\n    }\r\n\r\n    get numLights(): number {\r\n        return this._lightIds.length;\r\n    }\r\n\r\n    public add(): number {\r\n        const id = SystemLight.__id++;\r\n\r\n        this._lightIds.push(id);\r\n\r\n        if (this._lightIds.length > 1) {\r\n            this._positions.push(0, 0, 0);\r\n            this._colors.push(0, 0, 0);\r\n            this._fadeouts.push(0);\r\n        }\r\n\r\n        return id;\r\n    }\r\n\r\n    public remove(id: number): void {\r\n        const idx = this.findIndexFromId(id);\r\n\r\n        if (idx < 0) { return; }\r\n\r\n        if (this._lightIds.length > 1) {\r\n            this._positions.splice(idx * 3, 3);\r\n            this._colors.splice(idx * 3, 3);\r\n            this._fadeouts.splice(idx, 1);\r\n        }\r\n\r\n        this._lightIds.splice(idx, 1);\r\n    }\r\n\r\n    public setPosition(id: number, position: Array<number>): void {\r\n        const idx = this.findIndexFromId(id);\r\n\r\n        this._positions[idx * 3 + 0] = position[0];\r\n        this._positions[idx * 3 + 1] = position[1];\r\n        this._positions[idx * 3 + 2] = position[2];\r\n    }\r\n\r\n    public setColor(id: number, color: Array<number>): void {\r\n        const idx = this.findIndexFromId(id);\r\n\r\n        this._colors[idx * 3 + 0] = color[0];\r\n        this._colors[idx * 3 + 1] = color[1];\r\n        this._colors[idx * 3 + 2] = color[2];\r\n    }\r\n\r\n    public setFadeout(id: number, distance: number): void {\r\n        const idx = this.findIndexFromId(id);\r\n\r\n        this._fadeouts[idx] = distance;\r\n    }\r\n\r\n    public bindToUniforms(uniforms: any): void {\r\n        uniforms.numSystemLight.value       = this._lightIds.length;\r\n        uniforms.systemLight_position.value = this._positions;\r\n        uniforms.systemLight_color.value    = this._colors;\r\n        uniforms.systemLight_distance.value = this._fadeouts;\r\n    }\r\n\r\n    protected findIndexFromId(id: number): number {\r\n        for (let i = 0; i < this._lightIds.length; ++i) {\r\n            if (this._lightIds[i] == id) {\r\n                return i;\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n}\r\n","import Engine from \"../Proxy/Engine\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { IMesh } from \"../Proxy/IMesh\";\r\nimport { IScene } from \"../Proxy/IScene\";\r\nimport { ObjectManager } from \"./ObjectManager\";\r\nimport { ConfigManager } from \"../ConfigManager\";\r\nimport { ShaderManager } from \"../ShaderManager\";\r\nimport { Position } from \"../Proxy/INode\";\r\nimport { RawLevel } from \"../Loading/LevelLoader\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nexport class TRLevel {\r\n\r\n    public trlevel: RawLevel;\r\n\r\n    private movObjID2Index: Map<number, number>;\r\n    private sceneRender: IScene;\r\n    private sceneData: any;\r\n    private objMgr: ObjectManager;\r\n    private confMgr: ConfigManager;\r\n    private shdMgr: ShaderManager;\r\n    private gameData: IGameData;\r\n\r\n    constructor() {\r\n        this.movObjID2Index = new Map();\r\n        this.sceneRender = <any>null;\r\n        this.objMgr = <any>null;\r\n        this.confMgr = <any>null;\r\n        this.shdMgr = <any>null;\r\n        this.trlevel = <any>null;\r\n        this.gameData = <any>null;\r\n    }\r\n\r\n    public initialize(gameData: IGameData): void {\r\n        this.gameData = gameData;\r\n        this.trlevel = gameData.sceneData.trlevel;\r\n        this.sceneRender = gameData.sceneRender;\r\n        this.sceneData = gameData.sceneData;\r\n        this.objMgr = gameData.objMgr;\r\n        this.confMgr = gameData.confMgr;\r\n        this.shdMgr = gameData.shdMgr;\r\n\r\n        for (let m = 0; m < this.trlevel.moveables.length; ++m) {\r\n            const moveable = this.trlevel.moveables[m];\r\n            this.movObjID2Index.set(moveable.objectID, m);\r\n        }\r\n    }\r\n\r\n    public getMoveableIndex(objectID: number): number | undefined {\r\n        return this.movObjID2Index.get(objectID);\r\n    }\r\n\r\n    public getRoomByPos(pos: Position): number {\r\n        const trlevel = this.trlevel,\r\n              x = Math.floor(pos[0]),\r\n              y = -Math.floor(pos[1]),\r\n              z = -Math.floor(pos[2]);\r\n\r\n        for (let r = 0; r < trlevel.rooms.length; ++r) {\r\n            const room = trlevel.rooms[r];\r\n            if (room.isAlternate) {\r\n                continue;\r\n            }\r\n            const mx = room.info.x + room.numXsectors * 1024;\r\n            const mz = room.info.z + room.numZsectors * 1024;\r\n            if (x >= room.info.x && x < mx && z >= room.info.z && z < mz && y >= room.info.yTop && y < room.info.yBottom) {\r\n                return r;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    public isPointInRoom(pos: Position, roomIndex: number): boolean {\r\n        const room = this.trlevel.rooms[roomIndex];\r\n\r\n        const x = Math.floor(pos[0]),\r\n              y = -Math.floor(pos[1]),\r\n              z = -Math.floor(pos[2]);\r\n\r\n        const mx = room.info.x + room.numXsectors * 1024;\r\n        const mz = room.info.z + room.numZsectors * 1024;\r\n\r\n        if (x >= room.info.x && x < mx && z >= room.info.z && z < mz && y >= room.info.yTop && y < room.info.yBottom) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    public getItemsWithObjID(objID: number): Array<any> {\r\n        const items = [];\r\n        for (let i = 0; i < this.trlevel.items.length; ++i) {\r\n            const item = this.trlevel.items[i];\r\n\r\n            if (item.objectID == objID) {\r\n                items.push(item);\r\n            }\r\n        }\r\n        return items;\r\n    }\r\n\r\n    public convertIntensity(intensity: number): Array<number> {\r\n        let l = [intensity / 8192.0, intensity / 8192.0, intensity / 8192.0];\r\n\r\n        if (this.trlevel.rversion == 'TR3' || this.trlevel.rversion == 'TR4') {\r\n            const b = ((intensity & 0x7C00) >> 10) << 3,\r\n                  g = ((intensity & 0x03E0) >> 5) << 3,\r\n                  r = (intensity & 0x001F) << 3;\r\n\r\n            l = [r / 255, g / 255, b / 255];\r\n        }\r\n\r\n        return l;\r\n    }\r\n\r\n    public convertLighting(lighting1: number): Array<number> {\r\n        let color = [0, 0, 0];\r\n\r\n        switch (this.trlevel.rversion) {\r\n            case 'TR1':\r\n            case 'TR2': {\r\n                let lighting = Math.floor((1.0 - lighting1 / 8192.) * 2 * 256);\r\n                if (lighting > 255) { lighting = 255; }\r\n                color = [lighting / 255.0, lighting / 255.0, lighting / 255.0];\r\n                break;\r\n            }\r\n            case 'TR3': {\r\n                let lighting = lighting1;\r\n                const r = (lighting & 0x7C00) >> 10, g = (lighting & 0x03E0) >> 5, b = (lighting & 0x001F);\r\n                color = [((r << 3) + 0x7) / 255.0, ((g << 3) + 0x7) / 255.0, ((b << 3) + 0x7) / 255.0];\r\n                break;\r\n            }\r\n            case 'TR4': {\r\n                let lighting = lighting1;\r\n                let r = (((lighting & 0x7C00) >> 7) + 7) << 1, g = (((lighting & 0x03E0) >> 2) + 7) << 1, b = (((lighting & 0x001F) << 3) + 7) << 1;\r\n                if (r > 255) { r = 255; }\r\n                if (g > 255) { g = 255; }\r\n                if (b > 255) { b = 255; }\r\n                color = [r / 255.0, g / 255.0, b / 255.0];\r\n                break;\r\n            }\r\n        }\r\n\r\n        return color;\r\n    }\r\n\r\n    public createObjectsInLevel(): void {\r\n        for (let i = 0; i < this.trlevel.items.length; ++i) {\r\n            const item = this.trlevel.items[i];\r\n\r\n            const roomIndex = item.room, lighting = item.intensity1, q = glMatrix.quat.create();\r\n\r\n            glMatrix.quat.setAxisAngle(q, [0, 1, 0], glMatrix.glMatrix.toRadian(-(item.angle >> 14) * 90));\r\n\r\n            const m = this.movObjID2Index.get(item.objectID);\r\n            if (m == null) {\r\n                const obj = this.objMgr.createSprite(-item.objectID, roomIndex, this.convertLighting(lighting), true);\r\n                if (obj != null) {\r\n                    obj.setPosition([item.x, -item.y, -item.z]);\r\n                    obj.matrixAutoUpdate = true;\r\n                }\r\n            } else {\r\n                let obj: IMesh | null = this.objMgr.createMoveable(item.objectID, roomIndex, lighting != -1 ? this.convertIntensity(lighting) : undefined);\r\n\r\n                if (obj != null) {\r\n                    obj.setPosition([item.x, -item.y, -item.z]);\r\n                    obj.setQuaternion(q);\r\n                    obj.matrixAutoUpdate = true;\r\n                } else {\r\n                    // moveable is a placeholder with no geometry\r\n                    const spriteSeqObjID = this.confMgr.number('moveable[id=\"' + item.objectID + '\"] > spritesequence', true, -1);\r\n\r\n                    if (spriteSeqObjID >= 0) {\r\n                        obj = this.objMgr.createSprite(-spriteSeqObjID, roomIndex, [1, 1, 1], true);\r\n                        if (obj != null) {\r\n                            obj.setPosition([item.x, -item.y, -item.z]);\r\n                            obj.matrixAutoUpdate = true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let m = 0; m < this.trlevel.rooms.length; ++m) {\r\n            const room = this.trlevel.rooms[m],\r\n                  info = room.info,\r\n                  rdata = room.roomData,\r\n                  data = this.sceneData.objects['room' + m];\r\n\r\n            this.gameData.matMgr.createLightUniformsForObject(this.gameData.objMgr.objectList['room'][m] as IMesh, true);\r\n\r\n            // create portals\r\n            const portals = data.portals, meshPortals: Array<IMesh> = [];\r\n            data.meshPortals = meshPortals;\r\n            for (let p = 0; p < portals.length; ++p) {\r\n                const portal = portals[p];\r\n                const vertices = [\r\n                    portal.vertices[0].x, portal.vertices[0].y, portal.vertices[0].z,\r\n                    portal.vertices[1].x, portal.vertices[1].y, portal.vertices[1].z,\r\n                    portal.vertices[2].x, portal.vertices[2].y, portal.vertices[2].z,\r\n                    portal.vertices[3].x, portal.vertices[3].y, portal.vertices[3].z\r\n                ];\r\n\r\n                const colors = [\r\n                    1, 0, 0,\r\n                    0, 1, 0,\r\n                    0, 0, 1,\r\n                    1, 1, 1\r\n                ];\r\n\r\n                const faces = [\r\n                    0, 1, 2,\r\n                    0, 2, 3\r\n                ];\r\n\r\n                Promise.all([this.shdMgr.getVertexShader('TR_portal'), this.shdMgr.getFragmentShader('TR_portal')]).then((shd) => {\r\n                    const meshb = Engine.makeMeshBuilder(),\r\n                          mesh = meshb.createMesh('room' + m + '_portal' + p, this.gameData.sceneRender, shd[0], shd[1], undefined, vertices, faces, undefined, colors);\r\n\r\n                    mesh.materials.forEach((m) => (m.transparent = true, m.depthWrite = false));\r\n                    mesh.setPosition([0, 0, 0]);\r\n                    mesh.matrixAutoUpdate = false;\r\n                    mesh.visible = false;\r\n                    meshPortals.push(mesh);\r\n                });\r\n            }\r\n\r\n            // static meshes in the room\r\n            for (let s = 0; s < room.staticMeshes.length; ++s) {\r\n                const staticMesh = room.staticMeshes[s],\r\n                      x = staticMesh.x, y = -staticMesh.y, z = -staticMesh.z, rot = ((staticMesh.rotation & 0xC000) >> 14) * 90,\r\n                      objectID = staticMesh.objectID;\r\n\r\n                const mflags = this.sceneData.objects['staticmesh' + objectID].flags,\r\n                      nonCollisionable = (mflags & 1) != 0, visible = (mflags & 2) != 0;\r\n\r\n                if (!visible) {\r\n                    continue;\r\n                }\r\n\r\n                const q = glMatrix.quat.create();\r\n\r\n                glMatrix.quat.setAxisAngle(q, [0, 1, 0], glMatrix.glMatrix.toRadian(-rot));\r\n\r\n                const obj = this.objMgr.createStaticMesh(objectID, m, this.convertIntensity(staticMesh.intensity1), true);\r\n\r\n                if (obj != null) {\r\n                    obj.visible = !data.isAlternateRoom;\r\n                    obj.setPosition([x, y, z]);\r\n                    obj.setQuaternion(q);\r\n                    obj.matrixAutoUpdate = false;\r\n                }\r\n            }\r\n\r\n            // sprites in the room\r\n            for (let s = 0; s < rdata.sprites.length; ++s) {\r\n                const sprite = rdata.sprites[s],\r\n                      spriteIndex = sprite.texture,\r\n                      rvertex = rdata.vertices[sprite.vertex],\r\n                      lighting = this.trlevel.rversion == 'TR1' ? rvertex.lighting1 : rvertex.lighting2;\r\n\r\n                const obj = this.objMgr.createSprite(spriteIndex, m, this.convertLighting(lighting), true);\r\n\r\n                if (obj != null) {\r\n                    obj.visible = !data.isAlternateRoom;\r\n                    obj.setPosition([rvertex.vertex.x + info.x, -rvertex.vertex.y, -rvertex.vertex.z - info.z]);\r\n                    obj.matrixAutoUpdate = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n","import { ShaderManager } from \"../ShaderManager\";\r\nimport { IMesh } from \"./IMesh\";\r\nimport { IMeshBuilder } from \"./IMeshBuilder\";\r\nimport { INode } from \"./INode\";\r\nimport { IRenderer } from \"./IRenderer\";\r\nimport { IScene } from \"./IScene\";\r\n\r\nexport interface funcPointers {\r\n    \"makeNode\":         (name?: string, scene?: IScene) => INode;\r\n    \"makeMeshBuilder\":  (mesh?: IMesh) => IMeshBuilder;\r\n    \"parseScene\":       (sceneJSON: any) => Promise<IScene>;\r\n    \"createRenderer\":   (container: Element) => IRenderer;\r\n    \"getShaderMgr\":     ShaderManager;\r\n}\r\n\r\nexport default class Engine {\r\n\r\n    private static pointers: funcPointers;\r\n    private static _activeScene: IScene;\r\n\r\n    public static registerFunctions(pointers: funcPointers): void {\r\n        Engine.pointers = pointers;\r\n    }\r\n\r\n    public static makeNode(name?: string, scene?: IScene): INode {\r\n        return Engine.pointers.makeNode(name, scene);\r\n    }\r\n\r\n    public static makeMeshBuilder(mesh?: IMesh): IMeshBuilder {\r\n        return Engine.pointers.makeMeshBuilder(mesh);\r\n    }\r\n\r\n    public static parseScene(sceneJSON: any): Promise<any> {\r\n        return Engine.pointers.parseScene(sceneJSON);\r\n    }\r\n\r\n    public static createRenderer(container: Element): IRenderer {\r\n        return Engine.pointers.createRenderer(container);\r\n    }\r\n\r\n    public static getShaderMgr(): ShaderManager {\r\n        return Engine.pointers.getShaderMgr;\r\n    }\r\n\r\n    public static get activeScene(): IScene {\r\n        return Engine._activeScene;\r\n    }\r\n\r\n    public static set activeScene(as: IScene) {\r\n        Engine._activeScene = as;\r\n    }\r\n}\r\n","import { Behaviour } from \"../Behaviour/Behaviour\";\r\nimport { Box3 } from \"../Utils/Box3\";\r\n\r\nimport { IMaterial } from \"./IMaterial\";\r\nimport { Position, Quaternion } from \"./INode\";\r\n\r\nexport function isMesh(obj: any): obj is IMesh {\r\n\r\n        return obj.materials !== undefined;\r\n\r\n}\r\n\r\nexport interface IMesh {\r\n\r\n    behaviours: Array<Behaviour>;\r\n    materials: Array<IMaterial>;\r\n\r\n    readonly position: Position;\r\n    setPosition(pos: Position): void;\r\n\r\n    readonly quaternion: Quaternion;\r\n    setQuaternion(quat: Quaternion): void;\r\n\r\n    matrixAutoUpdate: boolean; // the setter should update the local model matrix each time it is called\r\n    name: string;\r\n    visible: boolean;\r\n    renderOrder: number;\r\n    frustumCulled: boolean;\r\n\r\n    updateMatrixWorld(): void;\r\n\r\n    containsPoint(pos: Position): boolean;\r\n\r\n    showBoundingBox(show: boolean): void;\r\n\r\n    clone(): IMesh;\r\n\r\n    getBoundingBox(): Box3;\r\n\r\n    setBoundingBox(box: Box3): void;\r\n}\r\n","import { RawLevel } from \"./Loading/LevelLoader\";\r\n\r\nexport enum shaderType {\r\n    vertex = \"vertex\",\r\n    fragment = \"fragment\",\r\n}\r\n\r\ninterface FileCache {\r\n    [name: string] : Promise<string>;\r\n}\r\n\r\nexport class ShaderManager {\r\n\r\n    protected _fpath: string;\r\n    protected _fileCache: FileCache;\r\n    protected _level: RawLevel;\r\n    protected _globalLightsInFragment: boolean;\r\n\r\n    constructor(dirPath?: string) {\r\n        this._fpath = dirPath || 'resources/shader/';\r\n        this._fileCache = {};\r\n        this._level = <any>null;\r\n        this._globalLightsInFragment = true;\r\n    }\r\n\r\n    public get globalLightsInFragment(): boolean {\r\n        return this._globalLightsInFragment;\r\n    }\r\n\r\n    public set globalLightsInFragment(glif: boolean) {\r\n        this._globalLightsInFragment = glif;\r\n    }\r\n\r\n    public getShader(ptype: shaderType, name: string, forceReload: boolean = false): Promise<string> {\r\n        return this._getFile(name + (ptype == shaderType.vertex ? '.vs' : '.fs'), forceReload);\r\n    }\r\n\r\n    public getVertexShader(name: string, forceReload: boolean = false): Promise<string> {\r\n        return this.getShader(shaderType.vertex, name, forceReload);\r\n    }\r\n\r\n    public getFragmentShader(name: string, forceReload: boolean = false): Promise<string> {\r\n        return this.getShader(shaderType.fragment, name, forceReload);\r\n    }\r\n\r\n    public setTRLevel(level: RawLevel): void {\r\n        this._level = level;\r\n    }\r\n\r\n    protected preprocess(code: string): string {\r\n        return code\r\n            .replace(/##tr_version##/g, this._level.rversion.substr(2))\r\n            .replace(/##global_lights_in_vertex##/g, this._globalLightsInFragment ? \"0\" : \"1\")\r\n            .replace(/##global_lights_in_fragment##/g, this._globalLightsInFragment ? \"1\" : \"0\");\r\n    }\r\n\r\n    protected _getFile(fname: string, forceReload: boolean = false) {\r\n        if (!forceReload && typeof this._fileCache[fname] != 'undefined') {\r\n            return this._fileCache[fname];\r\n        }\r\n        this._fileCache[fname] = this._loadFile(fname);\r\n        return this._fileCache[fname];\r\n    }\r\n\r\n    protected _loadFile(fname: string): Promise<string> {\r\n        return fetch(this._fpath + fname).then((response) => {\r\n            return response.text().then((txt) => {\r\n                return this.preprocess(txt);\r\n            });\r\n        });\r\n    }\r\n\r\n}\r\n","export default class BinaryBuffer {\n\n    protected urlList: Array<string>;\n    protected bufferList: Array<any>;\n    protected loadCount: number;\n\n    constructor(urlList: Array<string>) {\n        this.urlList = urlList;\n        this.bufferList = new Array();\n        this.loadCount = 0;\n    }\n\n    protected _loadBuffer(url: string, index: number, resolve: any): void {\n        const request = new XMLHttpRequest();\n\n        request.open(\"GET\", url, true);\n        request.responseType = \"arraybuffer\";\n\n        request.onerror = () => {\n            console.log('BinaryBuffer: XHR error', request.status, request.statusText);\n            if (++this.loadCount == this.urlList.length) {\n                resolve(this.bufferList);\n            }\n        };\n\n        request.onreadystatechange = () => {\n            if (request.readyState != 4) { return; }\n\n            if (request.status != 200) {\n                   console.log('Could not read a binary file. ', request.status, request.statusText);\n                if (++this.loadCount == this.urlList.length) {\n                    resolve(this.bufferList);\n                }\n            } else {\n                this.bufferList[index] = request.response;\n                if (++this.loadCount == this.urlList.length) {\n                    resolve(this.bufferList);\n                }\n            }\n        };\n\n        request.send();\n    }\n\n    public load(): Promise<Array<any>> {\n        return new Promise((resolve, reject) => {\n            for (let i = 0; i < this.urlList.length; ++i) {\n                this._loadBuffer(this.urlList[i], i, resolve);\n            }\n        });\n    }\n}\n","import { Position } from \"../Proxy/INode\";\r\n\r\nexport class Box3 {\r\n\r\n    protected _min: Position;\r\n    protected _max: Position;\r\n\r\n    constructor(min?: Position, max?: Position) {\r\n        if (min !== undefined) {\r\n            this._min = min;\r\n        } else {\r\n            this._min = [+Infinity, +Infinity, +Infinity];\r\n        }\r\n\r\n        if (max !== undefined) {\r\n            this._max = max;\r\n        } else {\r\n            this._max = [-Infinity, -Infinity, -Infinity];\r\n        }\r\n    }\r\n\r\n    get min(): Position {\r\n        return this._min;\r\n    }\r\n\r\n    get max(): Position {\r\n        return this._max;\r\n    }\r\n\r\n    public union(box: Box3): void {\r\n        this._min[0] = Math.min(this._min[0], box._min[0]);\r\n        this._min[1] = Math.min(this._min[1], box._min[1]);\r\n        this._min[2] = Math.min(this._min[2], box._min[2]);\r\n\r\n        this._max[0] = Math.max(this._max[0], box._max[0]);\r\n        this._max[1] = Math.max(this._max[1], box._max[1]);\r\n        this._max[2] = Math.max(this._max[2], box._max[2]);\r\n    }\r\n}\r\n","if (!(\"pointerLockElement\" in document)) {\n    const getter = (function() {\n        // These are the functions that match the spec, and should be preferred\n        if (\"webkitPointerLockElement\" in document) {\n            return function() { return (document as any).webkitPointerLockElement; };\n        }\n        if (\"mozPointerLockElement\" in document) {\n            return function() { return (document as any).mozPointerLockElement; };\n        }\n\n        return function() { return null; }; // not supported\n    })();\n\n    Object.defineProperty(document, \"pointerLockElement\", {\n        enumerable: true, configurable: false, writable: false,\n        get: getter\n    });\n}\n\nif (!(\"fullscreenElement\" in document)) {\n    const getter = (function() {\n        if (\"webkitFullscreenElement\" in document) {\n            return function() { return (document as any).webkitFullscreenElement; };\n        }\n        if (\"mozFullScreenElement\" in document) {\n            return function() { return (document as any).mozFullScreenElement; };\n        }\n\n        return function() { return null; }; // not supported\n    })();\n\n    Object.defineProperty(document, \"fullscreenElement\", {\n        enumerable: true, configurable: false, writable: false,\n        get: getter\n    });\n}\n\nif (!document.exitPointerLock) {\n    document.exitPointerLock = (function() {\n        return  (document as any).webkitExitPointerLock ||\n                (document as any).mozExitPointerLock ||\n                function() {\n                    if ((navigator as any).pointer) {\n                        (navigator as any).pointer.unlock();\n                    }\n                };\n    })();\n}\n\nif (!document.exitFullscreen) {\n    document.exitFullscreen = (function() {\n        return  (document as any).webkitCancelFullScreen ||\n                (document as any).mozCancelFullScreen ||\n                function() {};\n    })();\n}\n\nexport default class Browser {\n\n    public static _qs: any = null;\n\n    protected static _AudioContext: any = null;\n\n    public static get AudioContext(): any {\n        if (Browser._AudioContext === null) {\n            Browser._AudioContext =\n                typeof(AudioContext) != 'undefined' ? new AudioContext() :\n                typeof((window as any).webkitAudioContext) != 'undefined' ? new (window as any).webkitAudioContext() :\n                typeof((window as any).mozAudioContext) != 'undefined' ? new (window as any).mozAudioContext() : null;\n        }\n        return Browser._AudioContext;\n    }\n\n    public static bindRequestPointerLock(domElement: Element): void {\n        domElement.requestPointerLock =\n            domElement.requestPointerLock    ||\n            (domElement as any).mozRequestPointerLock ||\n            (domElement as any).webkitRequestPointerLock;\n    }\n\n    public static bindRequestFullscreen(domElement: Element): void {\n        domElement.requestFullscreen =\n            domElement.requestFullscreen    ||\n            (domElement as any).mozRequestFullScreen ||\n            (domElement as any).webkitRequestFullscreen ||\n            (domElement as any).webkitRequestFullScreen;\n    }\n\n    public static get QueryString(): any {\n        if (!Browser._qs) {\n        }\n\n        const query_string: any = {},\n              query = window.location.search.substring(1),\n              vars = query.split(\"&\");\n\n        for (let i = 0; i < vars.length; i++) {\n            const pair = vars[i].split(\"=\");\n\n            // If first entry with this name\n            if (typeof query_string[decodeURIComponent(pair[0])] === \"undefined\") {\n                query_string[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n            // If second entry with this name\n            } else if (typeof query_string[decodeURIComponent(pair[0])] === \"string\") {\n                var arr = [ query_string[decodeURIComponent(pair[0])], decodeURIComponent(pair[1]) ];\n                query_string[decodeURIComponent(pair[0])] = arr;\n            // If third or later entry with this name\n            } else {\n                query_string[decodeURIComponent(pair[0])].push(decodeURIComponent(pair[1]));\n            }\n        }\n\n        Browser._qs = query_string;\n\n        return Browser._qs;\n    }\n}\n","import Browser from \"./Browser\";\r\nimport BinaryBuffer from \"./BinaryBuffer\";\r\n\r\nexport default class Utils {\r\n\r\n    public static toHexString32(n: number) {\r\n        if (n < 0) {\r\n            n = 0xFFFFFFFF + n + 1;\r\n        }\r\n\r\n        return \"0x\" + (\"00000000\" + n.toString(16).toUpperCase()).substr(-8);\r\n    }\r\n\r\n    public static toHexString16(n: number) {\r\n        if (n < 0) {\r\n            n = 0xFFFF + n + 1;\r\n        }\r\n\r\n        return \"0x\" + (\"0000\" + n.toString(16).toUpperCase()).substr(-4);\r\n    }\r\n\r\n    public static toHexString8(n: number) {\r\n        if (n < 0) {\r\n            n = 0xFF + n + 1;\r\n        }\r\n\r\n        return \"0x\" + (\"00\" + n.toString(16).toUpperCase()).substr(-2);\r\n    }\r\n\r\n    public static flattenArray(a: Array<any> | null) {\r\n        if (!a) { return; }\r\n        let res = [];\r\n        for (let i = 0; i < a.length; ++i) {\r\n            res.push(a[i]);\r\n        }\r\n        return res;\r\n    }\r\n\r\n    public static flatten(obj: any, fpath: string) {\r\n\r\n        function flatten_sub(o: any, parts: Array<string>, p: number) {\r\n            if (!o) { return; }\r\n            for (; p < parts.length - 1; ++p) {\r\n                o = o[parts[p]];\r\n                if (Array.isArray(o)) {\r\n                    for (let i = 0; i < o.length; ++i) {\r\n                        flatten_sub(o[i], parts, p + 1);\r\n                    }\r\n                    return;\r\n                }\r\n            }\r\n            if (!o) { return; }\r\n            if (Array.isArray(o[parts[p]])) {\r\n                for (let i = 0; i < o[parts[p]].length; ++i) {\r\n                    o[parts[p]][i] = Utils.flattenArray(o[parts[p]][i]);\r\n                }\r\n            } else {\r\n                o[parts[p]] = Utils.flattenArray(o[parts[p]]);\r\n            }\r\n        }\r\n\r\n        flatten_sub(obj, fpath.split('.'), 0);\r\n    }\r\n\r\n    public static objSize(o: object) {\r\n        return Object.keys(o).length;\r\n    }\r\n\r\n    public static async saveData(filename: string, data: any): Promise<void> {\r\n        const blob = await (await fetch(data)).blob();\r\n        const url = URL.createObjectURL(blob);\r\n        let a = document.createElement('a');\r\n        a.href = url;\r\n        a.target = '_blank';\r\n        a.download = filename + '.png';\r\n        a.click();\r\n        setTimeout(function() { URL.revokeObjectURL(url); }, 4E4); // 40s\r\n    }\r\n\r\n    public static convertToPng(imgData: ImageData) {\r\n        let canvas = document.createElement(\"canvas\");\r\n\r\n        canvas.width = imgData.width;\r\n        canvas.height = imgData.height;\r\n\r\n        const context: any = canvas.getContext('2d');\r\n\r\n        context.putImageData(imgData, 0, 0);\r\n\r\n        return canvas.toDataURL('image/png');\r\n    }\r\n\r\n    public static domNodeToJSon(node: Node): any {\r\n        let children: any = {};\r\n\r\n        const attrs = (node as any).attributes;\r\n        if (attrs && attrs.length > 0) {\r\n            const attr: any = {};\r\n            children.__attributes = attr;\r\n            for (let i = 0; i < attrs.length; i++) {\r\n                const at = attrs[i];\r\n                attr[at.nodeName] = at.nodeValue;\r\n            }\r\n        }\r\n\r\n        const childNodes = node.childNodes;\r\n        if (childNodes) {\r\n            let textVal = '', hasRealChild = false;\r\n            for (let i = 0; i < childNodes.length; i++) {\r\n                const child = childNodes[i],\r\n                      cname = child.nodeName;\r\n                switch (child.nodeType) {\r\n                    case 1:\r\n                        hasRealChild = true;\r\n                        if (children[cname]) {\r\n                            if (!Array.isArray(children[cname])) {\r\n                                children[cname] = [children[cname]];\r\n                            }\r\n                            children[cname].push(Utils.domNodeToJSon(child));\r\n                        } else {\r\n                            children[cname] = Utils.domNodeToJSon(child);\r\n                        }\r\n                        break;\r\n                    case 3:\r\n                        if (child.nodeValue) {\r\n                            textVal += child.nodeValue;\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            textVal = textVal.replace(/[ \\r\\n\\t]/g, '').replace(' ', '');\r\n            if (textVal !== '') {\r\n                if (children.__attributes == undefined && !hasRealChild) {\r\n                    children = textVal;\r\n                } else {\r\n                    children.__value = textVal;\r\n                }\r\n            } else if (children.__attributes == undefined && !hasRealChild) {\r\n                children = null;\r\n            }\r\n        }\r\n\r\n        return children;\r\n    }\r\n\r\n    public static startSound(sound: any): void {\r\n        if (sound == null) { return; }\r\n\r\n        sound.start ? sound.start(0) : sound.noteOn ? sound.noteOn(0) : '';\r\n    }\r\n\r\n    public static async loadSoundAsync(filepath: string) {\r\n        if (!filepath || !Browser.AudioContext) {\r\n            return Promise.resolve(null);\r\n        }\r\n\r\n        const binaryBuffer = new BinaryBuffer([filepath]),\r\n              pbinBuff = binaryBuffer.load();\r\n\r\n        return pbinBuff.then((bufferList) => {\r\n            if (bufferList != null && bufferList.length > 0) {\r\n                return (new Promise((resolve, reject) =>\r\n                    Browser.AudioContext.decodeAudioData(\r\n                        bufferList[0],\r\n                        (buffer: any) => {\r\n                            const ret: any = {\r\n                                code: 0\r\n                            };\r\n                            if (!buffer) {\r\n                                ret.code = -1;\r\n                            } else {\r\n                                ret.soundbuffer = buffer;\r\n                                ret.sound = Browser.AudioContext.createBufferSource();\r\n                                ret.sound.buffer = buffer;\r\n                            }\r\n                            resolve(ret);\r\n                        }\r\n                    )\r\n                ));\r\n            } else {\r\n                console.log('Error when loading sound async. path=', filepath);\r\n                return Promise.resolve(null);\r\n            }\r\n        });\r\n    }\r\n\r\n    public static lerp(a: number, b: number, t: number): number {\r\n        if (t <= 0.0) { return a; }\r\n        if (t >= 1.0) { return b; }\r\n\r\n        return a + (b - a) * t;\r\n    }\r\n\r\n}\r\n","import { IRenderer } from \"../Proxy/IRenderer\";\r\nimport IGameData from \"../Player/IGameData\";\r\nimport { CutScene } from \"../Behaviour/CutScene\";\r\n\r\nexport class Panel {\r\n\r\n    protected _parent:      IGameData;\r\n    protected _renderer:    IRenderer;\r\n    protected _elem:        JQuery<any>;\r\n    protected _show:        boolean;\r\n\r\n    constructor(domElement: Element, gameData: IGameData, renderer: IRenderer) {\r\n        this._elem = jQuery('');\r\n        this._parent = gameData;\r\n        this._renderer = renderer;\r\n        this._show = false;\r\n\r\n        jQuery(`<style type=\"text/css\" media=\"all\">@import \"${gameData.relpath}resources/css/panel.css?ver=3\";</style>`).appendTo(domElement);\r\n        fetch(gameData.relpath + 'resources/template/panel.html').then((response) => {\r\n            response.text().then((html) => {\r\n                this._elem = jQuery(html);\r\n                this._elem.appendTo(domElement);\r\n                this.bindEvents(this);\r\n                this._setState();\r\n            });\r\n        });\r\n    }\r\n\r\n    public show(): void {\r\n        this._show = true;\r\n        this._setState();\r\n    }\r\n\r\n    public hide(): void {\r\n        this._show = false;\r\n        this._setState();\r\n    }\r\n\r\n    public showInfo(): void {\r\n        const sceneData = this._parent.sceneData, camera = this._parent.camera, perfData = this._renderer.getPerfData([this._parent.sceneRender, this._parent.sceneBackground]);\r\n        const regularLights = this._parent.curRoom == -1 ? 0 : (this._parent.matMgr.useAdditionalLights ? sceneData.objects['room' + this._parent.curRoom].lightsExt.length : sceneData.objects['room' + this._parent.curRoom].lights.length);\r\n        const globalLights = this._parent.curRoom == -1 || !sceneData.objects['room' + this._parent.curRoom].globalLights ? 0 : sceneData.objects['room' + this._parent.curRoom].globalLights.length;\r\n\r\n        this._elem.find('#currentroom').html(this._parent.curRoom.toString());\r\n        this._elem.find('#numlights').html('' + regularLights + \" - \" + globalLights);\r\n        this._elem.find('#camerapos').html(camera.position[0].toFixed(5) + ',' + camera.position[1].toFixed(5) + ',' + camera.position[2].toFixed(5));\r\n        this._elem.find('#camerarot').html(camera.quaternion[0].toFixed(5) + ',' + camera.quaternion[1].toFixed(5) + ',' + camera.quaternion[2].toFixed(5) + ',' + camera.quaternion[3].toFixed(5));\r\n        if (perfData) {\r\n            this._elem.find('#renderinfo').html(perfData.numDrawCalls + ' / ' + perfData.numFaces + ' / ' + perfData.numObjects + ' / ' + perfData.numParticles);\r\n            this._elem.find('#memoryinfo').html(perfData.numGeometries + ' / ' + perfData.numPrograms + ' / ' + perfData.numTextures);\r\n        }\r\n    }\r\n\r\n    public updateFromParent(): void {\r\n        this._elem.find('#singleroommode').prop('checked', this._parent.singleRoomMode);\r\n        this._elem.find('#useaddlights').prop('checked', this._parent.matMgr.useAdditionalLights);\r\n    }\r\n\r\n    public bindEvents(This: Panel) {\r\n        this._elem.on('click', function(e) { e.stopPropagation(); return false; });\r\n\r\n        this._elem.find('#singleroommode').on('click', function(e) {\r\n            e.stopPropagation();\r\n            This._parent.singleRoomMode = this.checked;\r\n        });\r\n\r\n        this._elem.find('#wireframemode').on('click', function(e) {\r\n            e.stopPropagation();\r\n            var scene = This._parent.sceneRender;\r\n            scene.traverse((obj) => {\r\n                const materials = obj.materials;\r\n                for (let i = 0; i < materials.length; ++i) {\r\n                    const material = materials[i];\r\n                    ((material as any).material).wireframe = this.checked;\r\n                }\r\n            });\r\n        });\r\n\r\n        this._elem.find('#usefog').on('click', function(e) {\r\n            e.stopPropagation();\r\n            var scene = This._parent.sceneRender;\r\n            scene.traverse((obj) => {\r\n                const materials = obj.materials;\r\n                for (let i = 0; i < materials.length; ++i) {\r\n                    const material = materials[i];\r\n                    if (material.uniforms && material.uniforms.useFog) {\r\n                        material.uniforms.useFog.value = this.checked ? 1 : 0;\r\n                        material.uniformsUpdated([\"useFog\"]);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        this._elem.find('#nolights').on('click', function(e) {\r\n            e.stopPropagation();\r\n            const scene = This._parent.sceneRender,\r\n                  white = [1, 1, 1];\r\n            scene.traverse((obj) => {\r\n                const materials = obj.materials;\r\n                for (let i = 0; i < materials.length; ++i) {\r\n                    const material = materials[i];\r\n                    if (!material.uniforms || material.uniforms.numPointLight === undefined) { return; }\r\n                    if ((material as any).__savenum === undefined) {\r\n                        (material as any).__savenum = material.uniforms.numPointLight.value;\r\n                        (material as any).__saveambient = material.uniforms.ambientColor.value;\r\n                    }\r\n                    material.uniforms.numPointLight.value = this.checked ? 0 : (material as any).__savenum;\r\n                    material.uniforms.ambientColor.value = this.checked ? white : (material as any).__saveambient;\r\n\r\n                    material.uniformsUpdated([\"numPointLight\", \"ambientColor\"]);\r\n                }\r\n            });\r\n        });\r\n\r\n        this._elem.find('#showboundingboxes').on('click', function(e) {\r\n            e.stopPropagation();\r\n            const scene = This._parent.sceneRender;\r\n\r\n            scene.traverse((obj) => {\r\n                if (obj.materials.length == 0) { return; }\r\n\r\n                obj.showBoundingBox(this.checked);\r\n            });\r\n        });\r\n\r\n        this._elem.find('#showportals').on('click', function(e) {\r\n            e.stopPropagation();\r\n            const scene = This._parent.sceneRender,\r\n                  sceneData = This._parent.sceneData;\r\n            scene.traverse((obj) => {\r\n                const data = sceneData.objects[obj.name];\r\n\r\n                if (!data || data.type != 'room' && data.meshPortals) { return; }\r\n\r\n                const portals = data.meshPortals;\r\n\r\n                if (!portals) { return; }\r\n\r\n                for (let i = 0; i < portals.length; ++i) {\r\n                    portals[i].visible = this.checked;\r\n                }\r\n            });\r\n        });\r\n\r\n        this._elem.find('#fullscreen').on('click', function(e) {\r\n            e.stopPropagation();\r\n            if (document.fullscreenElement != null) {\r\n                if (document.exitFullscreen) {\r\n                    document.exitFullscreen();\r\n                }\r\n            } else if (document.body.requestFullscreen) {\r\n                document.body.requestFullscreen();\r\n            }\r\n        });\r\n\r\n        this._elem.find('#useqwerty').on('click', function(e) {\r\n            e.stopPropagation();\r\n            const bc = This._parent.bhvMgr.getBehaviour(\"BasicControl\");\r\n            if (bc === undefined) { return; }\r\n            const states = (bc[0] as any).states,\r\n                  STATES = (bc[0] as any).STATES;\r\n            if (this.checked) {\r\n                states[87] = {state: STATES.FORWARD, on: false}; // W\r\n                states[65] = {state: STATES.LEFT,    on: false}; // A\r\n                delete states[90]; // Z\r\n                delete states[81]; // Q\r\n            } else {\r\n                states[90] = {state: STATES.FORWARD, on: false}; // W\r\n                states[81] = {state: STATES.LEFT,    on: false}; // A\r\n                delete states[87]; // W\r\n                delete states[65]; // A\r\n            }\r\n        });\r\n\r\n        this._elem.find('#noobjecttexture').on('click', function(e) {\r\n            e.stopPropagation();\r\n            const shaderMgr = This._parent.shdMgr,\r\n                  scene = This._parent.sceneRender,\r\n                  shader = shaderMgr.getFragmentShader('TR_uniformcolor');\r\n            shader.then((code: string) => {\r\n                scene.traverse((obj) => {\r\n                    if (obj.name.match(/moveable|sprite|staticmesh/) == null) { return; }\r\n\r\n                    const materials = obj.materials;\r\n                    for (let i = 0; i < materials.length; ++i) {\r\n                        const material = materials[i], origFragmentShader = (material as any).origFragmentShader;\r\n                        if (!origFragmentShader) {\r\n                            (material as any).origFragmentShader = material.fragmentShader;\r\n                        }\r\n\r\n                        material.fragmentShader = this.checked ? code : (material as any).origFragmentShader;\r\n                    }\r\n                });\r\n            });\r\n        });\r\n\r\n        this._elem.find('#lowlightsquality').on('click', async function(e) {\r\n            e.stopPropagation();\r\n            const shaderMgr = This._parent.shdMgr,\r\n                  scene = This._parent.sceneRender;\r\n\r\n            shaderMgr.globalLightsInFragment = !this.checked;\r\n\r\n            const shaders = [await shaderMgr.getFragmentShader('TR_standard', true), await shaderMgr.getVertexShader('TR_room', true), await shaderMgr.getVertexShader('TR_moveable', true), await shaderMgr.getVertexShader('TR_mesh', true)];\r\n\r\n            await Promise.all(shaders);\r\n\r\n            scene.traverse((obj) => {\r\n                const vshader =\r\n                        obj.name.startsWith(\"moveable\")     ? shaders[2] :\r\n                        obj.name.startsWith(\"room\")         ? shaders[1] :\r\n                        obj.name.startsWith(\"staticmesh\")   ? shaders[3] : '';\r\n\r\n                if (vshader === '') { return; }\r\n\r\n                const materials = obj.materials;\r\n                for (let i = 0; i < materials.length; ++i) {\r\n                    const material = materials[i], origFragmentShader = (material as any).origFragmentShader, origVertexShader = (material as any).origVertexShader;\r\n                    if (!origFragmentShader) {\r\n                        (material as any).origFragmentShader = material.fragmentShader;\r\n                    }\r\n                    if (!origVertexShader) {\r\n                        (material as any).origVertexShader = material.vertexShader;\r\n                    }\r\n\r\n                    material.vertexShader = this.checked ? vshader : (material as any).origVertexShader;\r\n                    material.fragmentShader = this.checked ? shaders[0] : (material as any).origFragmentShader;\r\n                }\r\n            });\r\n        });\r\n\r\n        this._elem.find('#nobumpmapping').on('click', function(e) {\r\n            e.stopPropagation();\r\n            const scene = This._parent.sceneRender;\r\n            scene.traverse((obj) => {\r\n                const data = This._parent.sceneData.objects[obj.name];\r\n\r\n                if (!data || data.type != \"room\") { return; }\r\n\r\n                const materials = obj.materials;\r\n                for (let i = 0; i < materials.length; ++i) {\r\n                    const material = materials[i],\r\n                          s = material.uniforms.offsetBump.value[2];\r\n\r\n                    material.uniforms.offsetBump.value[2] = material.uniforms.offsetBump.value[3];\r\n                    material.uniforms.offsetBump.value[3] = s;\r\n\r\n                    material.uniformsUpdated(['offsetBump']);\r\n                }\r\n            });\r\n        });\r\n\r\n        this._elem.find('#useaddlights').on('click', function(e) {\r\n            e.stopPropagation();\r\n            This._parent.matMgr.useAdditionalLights = this.checked;\r\n            This._parent.matMgr.setLightUniformsForObjects(This._parent.objMgr.objectList['moveable']);\r\n        });\r\n\r\n        const prefix = ['', 'webkit', 'moz'];\r\n        for (let i = 0; i < prefix.length; ++i) {\r\n            document.addEventListener(prefix[i] + \"fullscreenchange\", function() {\r\n                This._elem.find('#fullscreen').prop('checked', document.fullscreenElement != null);\r\n            }, false);\r\n        }\r\n    }\r\n\r\n    protected _setState(): void {\r\n        this._elem.css('display', this._show ? 'block' : 'none');\r\n        jQuery(\"#stats\").css('display', this._show ? 'block' : 'none');\r\n    }\r\n\r\n}\r\n","export class ProgressBar {\n\n    protected _elem:        JQuery<any>;\n    protected _show:        boolean;\n    protected _showStart:   boolean;\n    protected _callback:    any;\n\n    constructor(domElement: Element, relpath: string = \"\") {\n        this._elem = jQuery('');\n        this._show = false;\n        this._showStart = false;\n\n        jQuery(`<style type=\"text/css\" media=\"all\">@import \"${relpath}resources/css/progressbar.css\";</style>`).appendTo(domElement);\n        fetch(relpath + 'resources/template/progressbar.html').then((response) => {\n            response.text().then((html) => {\n                this._elem = jQuery(html);\n                this._elem.appendTo(domElement);\n                this._setState();\n            });\n        });\n    }\n\n    public show(): void {\n        this._show = true;\n        this._elem.css('display', 'block');\n    }\n\n    public hide(): void {\n        this._show = false;\n        this._elem.css('display', 'none');\n    }\n\n    public showStart(callback: any): void {\n        this._showStart = true;\n        this._callback = callback;\n\n        this._elem.find('.message').css('display', 'none');\n        this._elem.find('.progressbar').css('display', 'none');\n\n        this._elem.find('.start').css('display', 'block');\n        this._elem.find('.start').attr('class', 'start enabled');\n\n        this._elem.find('.start').on('click', callback);\n    }\n\n    protected _setState(): void {\n        this._elem.css('display', this._show ? 'block' : 'none');\n        if (this._showStart) {\n            this.showStart(this._callback);\n        }\n    }\n\n}\n","declare var glMatrix: any;\r\n\r\n/*\r\n\tPorted from the SceneManager::setSkyDome method of Ogre3D engine (https://www.ogre3d.org/docs/api/1.9/class_ogre_1_1_scene_manager.html#add758e3fa5df1291df9ff98b2594d35b)\r\n*/\r\nexport default class SkyDome {\r\n\r\n    public static create(\r\n       /*Real*/ curvature: number,\r\n       /*Real*/ tiling: number,\r\n       /*Real*/ distance: number,\r\n       /*const Quaternion&*/ orientation: [number, number, number, number],\r\n       /*int*/ xsegments: number, /*int*/ ysegments: number, /*int*/ ySegmentsToKeep: number\r\n    ): any\r\n    {\r\n        var res = { vertices : [], textures : [], faces : Array<number>() };\r\n\r\n        for (var i = 0; i < 5; ++i) {\r\n            var data = SkyDome.createPlane(i, curvature, tiling, distance, orientation, xsegments, ysegments, i != 4 /*BP_UP*/ ? ySegmentsToKeep : -1);\r\n\r\n            var numVertices = res.vertices.length / 3;\r\n            for (var f = 0; f < data.faces.length; ++f) { res.faces.push(data.faces[f] + numVertices); }\r\n\r\n            res.vertices = res.vertices.concat(data.vertices);\r\n            res.textures = res.textures.concat(data.textures);\r\n        }\r\n\r\n        return res;\r\n    }\r\n\r\n    private static createPlane(\r\n       /*BoxPlane*/ bp: any,\r\n       /*Real*/ curvature: number,\r\n       /*Real*/ tiling: number,\r\n       /*Real*/ distance: number,\r\n       /*const Quaternion&*/ orientation: [number, number, number, number],\r\n       /*int*/ xsegments: number, /*int*/ ysegments: number, /*int*/ ysegments_keep: number): any\r\n    {\r\n        var BP_FRONT = 0,\r\n            BP_BACK = 1,\r\n            BP_LEFT = 2,\r\n            BP_RIGHT = 3,\r\n            BP_UP = 4,\r\n            BP_DOWN = 5;\r\n\r\n        var plane = { constant: distance, normal: [0, 0, 0] };\r\n        var up: [number, number, number] = [0, 1, 0];\r\n\r\n        // Set up plane equation\r\n        switch (bp) {\r\n            case BP_FRONT:\r\n                plane.normal = [0, 0, 1];\r\n                break;\r\n            case BP_BACK:\r\n                plane.normal = [0, 0, -1];\r\n                break;\r\n            case BP_LEFT:\r\n                plane.normal = [1, 0, 0];\r\n                break;\r\n            case BP_RIGHT:\r\n                plane.normal = [-1, 0, 0];\r\n                break;\r\n            case BP_UP:\r\n                plane.normal = [0, -1, 0];\r\n                up = [0, 0, 1];\r\n                break;\r\n            case BP_DOWN:\r\n                // no down\r\n                return null;\r\n        }\r\n\r\n        // Modify by orientation\r\n        glMatrix.vec3.transformQuat(plane.normal, plane.normal, orientation);\r\n        glMatrix.vec3.transformQuat(up, up, orientation);\r\n\r\n        // Create new\r\n        var planeSize = distance * 2;\r\n\r\n        return SkyDome.createCurvedIllusionPlane(plane,\r\n            planeSize, planeSize, curvature,\r\n            xsegments, ysegments, tiling, tiling, up,\r\n            orientation, ysegments_keep);\r\n    }\r\n\r\n    private static createCurvedIllusionPlane(\r\n        plane: any,\r\n        /*Real*/ width: number, /*Real*/ height: number, /*Real*/ curvature: number,\r\n        /*int*/ xsegments: number, /*int*/ ysegments: number,\r\n        /*Real*/ uTile: number, /*Real*/ vTile: number, /*Const Vector3&*/ upVector: [number, number, number],\r\n        /*const Quaternion&*/ orientation: [number, number, number, number],\r\n        /*int*/ ySegmentsToKeep: number): any\r\n    {\r\n        var params = {\r\n            plane : plane,\r\n            width : width,\r\n            height : height,\r\n            curvature : curvature,\r\n            xsegments : xsegments,\r\n            ysegments : ysegments,\r\n            xTile : uTile,\r\n            yTile : vTile,\r\n            upVector : upVector,\r\n            orientation : orientation,\r\n            ySegmentsToKeep : ySegmentsToKeep\r\n        };\r\n        return SkyDome.loadManualCurvedIllusionPlane(params);\r\n    }\r\n\r\n    private static loadManualCurvedIllusionPlane(params: any): any {\r\n        var vertCoords = [], textCoords = [];\r\n\r\n        if (params.ySegmentsToKeep == -1) { params.ySegmentsToKeep = params.ysegments; }\r\n\r\n        if ((params.xsegments + 1) * (params.ySegmentsToKeep + 1) > 65536) {\r\n            throw \"Plane tessellation is too high, must generate max 65536 vertices\";\r\n        }\r\n\r\n        // Work out the transform required\r\n        // Default orientation of plane is normal along +z, distance 0\r\n\r\n        // Determine axes\r\n        var zAxis = glMatrix.vec3.clone(params.plane.normal);\r\n        glMatrix.vec3.normalize(zAxis, zAxis);\r\n        var yAxis = glMatrix.vec3.clone(params.upVector);\r\n        glMatrix.vec3.normalize(yAxis, yAxis);\r\n        var xAxis = glMatrix.vec3.create();\r\n        glMatrix.vec3.cross(xAxis, yAxis, zAxis);\r\n        if (glMatrix.vec3.squaredLength(xAxis) == 0) {\r\n            //upVector must be wrong\r\n            throw \"The upVector you supplied is parallel to the plane normal, so is not valid.\";\r\n        }\r\n        glMatrix.vec3.normalize(xAxis, xAxis);\r\n\r\n        var rot = glMatrix.mat4.create();\r\n        glMatrix.mat4.set(rot,\r\n            xAxis[0], xAxis[1], xAxis[2], 0,\r\n            yAxis[0], yAxis[1], yAxis[2], 0,\r\n            zAxis[0], zAxis[1], zAxis[2], 0,\r\n            0,        0,        0,        1\r\n        );\r\n\r\n        // Set up standard transform from origin\r\n        var xlate = glMatrix.mat4.create(); // create an identity matrix\r\n        var pnormal = glMatrix.vec3.clone(params.plane.normal);\r\n        glMatrix.vec3.scale(pnormal, pnormal, -params.plane.constant);\r\n        xlate[12] = pnormal[0];\r\n        xlate[13] = pnormal[1];\r\n        xlate[14] = pnormal[2];\r\n\r\n        // concatenate\r\n        var xform = glMatrix.mat4.clone(xlate);\r\n        glMatrix.mat4.multiply(xform, xform, rot);\r\n\r\n        // Generate vertex data\r\n        // Imagine a large sphere with the camera located near the top\r\n        // The lower the curvature, the larger the sphere\r\n        // Use the angle from viewer to the points on the plane\r\n        // Credit to Aftershock for the general approach\r\n\r\n        // Actual values irrelevant, it's the relation between sphere radius and camera position that's important\r\n        var SPHERE_RAD = 100.0;\r\n        var CAM_DIST = 5.0;\r\n\r\n        var sphereRadius = SPHERE_RAD - params.curvature;\r\n        var /* Real */ camPos = sphereRadius - CAM_DIST; // Camera position relative to sphere center\r\n\r\n        var xSpace = params.width / params.xsegments;\r\n        var ySpace = params.height / params.ysegments;\r\n        var halfWidth = params.width / 2;\r\n        var halfHeight = params.height / 2;\r\n        var invOrientation = glMatrix.quat.clone(params.orientation);\r\n        glMatrix.quat.invert(invOrientation, invOrientation);\r\n\r\n        for (var y = params.ysegments - params.ySegmentsToKeep; y < params.ysegments + 1; ++y) {\r\n            for (var x = 0; x < params.xsegments + 1; ++x) {\r\n                // Work out centered on origin\r\n                var vec = glMatrix.vec3.fromValues(\r\n                    (x * xSpace) - halfWidth,\r\n                    (y * ySpace) - halfHeight,\r\n                    0.0);\r\n\r\n                // Transform by orientation and distance\r\n                glMatrix.vec3.transformMat4(vec, vec, xform);\r\n\r\n                // Assign to geometry\r\n                vertCoords.push(vec[0], vec[1], vec[2]);\r\n\r\n                // Generate texture coords\r\n                // Normalise position\r\n                // modify by orientation to return +y up\r\n                glMatrix.vec3.transformQuat(vec, vec, invOrientation);\r\n                glMatrix.vec3.normalize(vec, vec);\r\n\r\n                // Find distance to sphere\r\n                var sphDist = Math.sqrt(camPos * camPos * (vec[1] * vec[1] - 1.0) + sphereRadius * sphereRadius) - camPos * vec[1]; // Distance from camera to sphere along box vertex vector\r\n\r\n                vec[0] *= sphDist;\r\n                vec[2] *= sphDist;\r\n\r\n                // Use x and y on sphere as texture coordinates, tiled\r\n                var s = vec[0] * (0.01 * params.xTile);\r\n                var t = 1.0 - (vec[2] * (0.01 * params.yTile));\r\n\r\n                textCoords.push(s, t);\r\n            } // x\r\n        } // y\r\n\r\n        var faceIndices = this.tesselate2DMesh(params.xsegments + 1, params.ySegmentsToKeep + 1, false);\r\n\r\n        return { vertices : vertCoords, textures : textCoords, faces : faceIndices };\r\n    }\r\n\r\n    private static tesselate2DMesh(/*unsigned short*/ meshWidth: number, /*unsigned short*/ meshHeight: number, /*bool*/ doubleSided: boolean): any {\r\n        // Make a list of indexes to spit out the triangles\r\n        var vInc = 1, v = 0, iterations = doubleSided ? 2 : 1;\r\n        var indices = [];\r\n\r\n        while (iterations--) {\r\n            // Make tris in a zigzag pattern (compatible with strips)\r\n            var u = 0;\r\n            var uInc = 1; // Start with moving +u\r\n            var vCount = meshHeight - 1;\r\n\r\n            while (vCount--) {\r\n                var uCount = meshWidth - 1;\r\n                while (uCount--) {\r\n                    // First Tri in cell\r\n                    indices.push(\r\n                        ((v + vInc) * meshWidth) + u,\r\n                        (v * meshWidth) + u,\r\n                        ((v + vInc) * meshWidth) + (u + uInc)\r\n                    );\r\n\r\n                    // Second Tri in cell\r\n                    indices.push(\r\n                        ((v + vInc) * meshWidth) + (u + uInc),\r\n                        (v * meshWidth) + u,\r\n                        (v * meshWidth) + (u + uInc)\r\n                    );\r\n\r\n                    // Next column\r\n                    u += uInc;\r\n                }\r\n\r\n                // Next row\r\n                v += vInc;\r\n                u = 0;\r\n            }\r\n\r\n            // Reverse vInc for double sided\r\n            v = meshHeight - 1;\r\n            vInc = -vInc;\r\n        }\r\n        return indices;\r\n    }\r\n}\r\n","import { Scene as BScene, PointerEventTypes } from \"babylonjs\";\r\n\r\nimport { BasicControl as BasicControlBase } from \"../../../src/Behaviour/BasicControl\";\r\nimport { BehaviourManager } from \"../../../src/Behaviour/BehaviourManager\";\r\nimport IGameData from \"../../../src/Player/IGameData\";\r\n\r\nimport Scene from \"../Scene\";\r\n\r\nexport class BasicControl extends BasicControlBase {\r\n\r\n    public name: string = BasicControl.name;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n\r\n        const sceneRender: BScene = (gameData.sceneRender as Scene).object;\r\n\r\n        sceneRender.onPointerObservable.add((pointerInfo) => {\r\n\r\n            switch (pointerInfo.type) {\r\n\r\n                case PointerEventTypes.POINTERDOWN:\r\n                    this.mousedown (pointerInfo as unknown as MouseEvent);\r\n                    break;\r\n\r\n                case PointerEventTypes.POINTERMOVE:\r\n                    this.mousemove (pointerInfo as unknown as MouseEvent);\r\n                    break;\r\n\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n}\r\n\r\nBehaviourManager.registerFactory(BasicControl);\r\n","import {\r\n    ParticleSystem as BParticleSystem,\r\n    Quaternion,\r\n    Vector3\r\n} from \"babylonjs\";\r\n\r\nimport { ICamera } from \"../../../src/Proxy/ICamera\";\r\nimport { IMesh, isMesh } from \"../../../src/Proxy/IMesh\";\r\nimport { Position } from \"../../../src/Proxy/INode\";\r\nimport { Behaviour, BehaviourRetCode } from \"../../../src/Behaviour/Behaviour\";\r\nimport { BehaviourManager } from \"../../../src/Behaviour/BehaviourManager\";\r\nimport IGameData from \"../../../src/Player/IGameData\";\r\n\r\nimport Scene from \"../Scene\";\r\n\r\nexport class ParticleSystem extends Behaviour {\r\n\r\n    public name: string = ParticleSystem.name;\r\n\r\n    constructor(nbhv: any, gameData: IGameData, objectid?: number, objecttype?: string) {\r\n        super(nbhv, gameData, objectid, objecttype);\r\n    }\r\n\r\n    public init(lstObjs: Array<IMesh | ICamera> | null): [BehaviourRetCode, Array<Promise<void>> | null] {\r\n        let itemID = this.nbhv.itemid, pname = this.nbhv.name, ofst = { \"x\": \"0\", \"y\": \"0\", \"z\": \"0\", ...this.nbhv.offset };\r\n\r\n        if (lstObjs == null && itemID === undefined) {\r\n            return [BehaviourRetCode.dontKeepBehaviour, null];\r\n        }\r\n\r\n        const positions: Array<{ \"pos\": Position, \"obj\": IMesh | null }> = [];\r\n\r\n        (lstObjs || []).forEach((obj) => {\r\n            if (isMesh(obj)) {\r\n                let q = new Quaternion(...obj.quaternion),\r\n                    v = new Vector3(parseInt(ofst.x), parseInt(ofst.y), parseInt(ofst.z));\r\n\r\n                let vrot = new Vector3();\r\n\r\n                v.rotateByQuaternionToRef(q, vrot);\r\n\r\n                positions.push({ \"pos\": [obj.position[0] + vrot.x, obj.position[1] + vrot.y, obj.position[2] + vrot.z], \"obj\": obj });\r\n\r\n                this.gameData.objMgr.removeObjectFromScene(obj, true);\r\n            }\r\n        });\r\n\r\n        if (itemID !== undefined) {\r\n            itemID = parseInt(itemID);\r\n            for (let i = 0; i < this.gameData.trlvl.trlevel.items.length; ++i) {\r\n                const item = this.gameData.trlvl.trlevel.items[i];\r\n\r\n                if (item.objectID == itemID) {\r\n                    positions.push({ \"pos\": [item.x + parseInt(ofst.x), -item.y + parseInt(ofst.y), -item.z + parseInt(ofst.z)], \"obj\": null });\r\n                }\r\n            }\r\n        }\r\n\r\n        const promise = fetch(`${this.gameData.relpath}resources/particle/${pname}.json`).then((response) => {\r\n            if (response.ok) {\r\n                response.json().then((json) => {\r\n                    json = JSON.parse(JSON.stringify(json).replace(/\\/resources/g, this.gameData.relpath + 'resources'));\r\n                    positions.forEach((obj, idx) => {\r\n                        const psys = BParticleSystem.Parse(json, (this.gameData.sceneRender as Scene).object, \"\"),\r\n                              id: number = this.objectid ? this.objectid : parseInt(itemID),\r\n                              pos = obj.pos;\r\n\r\n                        psys.name = `particle${id}_${idx}`;\r\n\r\n                        psys.worldOffset.x = pos[0];\r\n                        psys.worldOffset.y = pos[1];\r\n                        psys.worldOffset.z = pos[2];\r\n\r\n                        psys.preWarmCycles = 80;\r\n                        psys.start();\r\n                    });\r\n                });\r\n            }\r\n        });\r\n\r\n        return [BehaviourRetCode.dontKeepBehaviour, [promise]];\r\n    }\r\n\r\n}\r\n\r\nBehaviourManager.registerFactory(ParticleSystem);\r\n","import \"../../src/Behaviour/AnimatedTexture\";\r\nimport \"./Behaviour/BasicControl\";\r\nimport \"../../src/Behaviour/CutScene\";\r\nimport \"../../src/Behaviour/DynamicLight\";\r\nimport \"../../src/Behaviour/Fade\";\r\nimport \"../../src/Behaviour/FadeUniformColor\";\r\nimport \"../../src/Behaviour/Lara\";\r\nimport \"../../src/Behaviour/Light\";\r\nimport \"../../src/Behaviour/MakeLayeredMesh\";\r\nimport \"../../src/Behaviour/MuzzleFlash\";\r\nimport \"./Behaviour/ParticleSystem\";\r\nimport \"../../src/Behaviour/Ponytail\";\r\nimport \"../../src/Behaviour/PulsingLight\";\r\nimport \"../../src/Behaviour/RemoveObject\";\r\nimport \"../../src/Behaviour/ScrollTexture\";\r\nimport \"../../src/Behaviour/SetAnimation\";\r\nimport \"../../src/Behaviour/Sky\";\r\nimport \"../../src/Behaviour/Skydome\";\r\nimport \"../../src/Behaviour/Sprite\";\r\nimport \"../../src/Behaviour/UVRotate\";\r\nimport \"../../src/Behaviour/Zbias\";\r\n","import {\r\n    Quaternion as BQuaternion,\r\n    TargetCamera,\r\n    Vector3\r\n} from \"babylonjs\";\r\n\r\nimport { Behaviour } from \"../../src/Behaviour/Behaviour\";\r\nimport { ICamera } from \"../../src/Proxy/ICamera\";\r\nimport { Position, Quaternion } from \"../../src/Proxy/INode\";\r\n\r\nconst rotY180 = BQuaternion.RotationAxis(new Vector3(0, 1, 0), Math.PI); // x <=> -x\r\nconst cstConvert = Math.PI / 180.0;\r\n\r\nexport default class Camera implements ICamera {\r\n\r\n    public behaviours: Array<Behaviour>;\r\n\r\n    protected _camera: TargetCamera;\r\n\r\n    constructor(camera: TargetCamera) {\r\n        this._camera = camera;\r\n        this.behaviours = [];\r\n    }\r\n\r\n    get object(): TargetCamera {\r\n        return this._camera;\r\n    }\r\n\r\n    public get position(): Position {\r\n        return [this._camera.position.x, this._camera.position.y, this._camera.position.z];\r\n    }\r\n\r\n    public setPosition(pos: Position): void {\r\n        this._camera.position.set(...pos);\r\n    }\r\n\r\n    public get quaternion(): Quaternion {\r\n        let q = this._camera.rotationQuaternion.multiply(rotY180);\r\n        return [q.x, q.y, q.z, q.w];\r\n        //return [this.camera.rotationQuaternion.x, this.camera.rotationQuaternion.y, this.camera.rotationQuaternion.z, this.camera.rotationQuaternion.w];\r\n    }\r\n    public setQuaternion(quat: Quaternion): void {\r\n        this._camera.rotationQuaternion = new BQuaternion(...quat).multiply(rotY180);\r\n        //this.camera.rotationQuaternion.set(...quat);\r\n    }\r\n\r\n    get aspect(): number {\r\n        return 1;\r\n    }\r\n\r\n    set aspect(a: number) {\r\n    }\r\n\r\n    get fov(): number {\r\n        return this._camera.fov / cstConvert;\r\n    }\r\n\r\n    set fov(f: number) {\r\n        this._camera.fov = f * cstConvert;\r\n    }\r\n\r\n    public updateMatrixWorld(): void {\r\n        this._camera.computeWorldMatrix();\r\n    }\r\n\r\n    public updateProjectionMatrix(): void {\r\n        this._camera.getProjectionMatrix(true);\r\n    }\r\n\r\n    public lookAt(pos: Position): void {\r\n        this._camera.setTarget(new Vector3(...pos));\r\n    }\r\n}\r\n","import {\n    Engine as BEngine,\n    ShaderMaterial,\n    Vector3,\n    Vector4\n} from \"babylonjs\";\n\nimport Engine from \"../../src/Proxy/Engine\";\nimport { IMaterial } from \"../../src/Proxy/IMaterial\";\n\nexport default class Material implements IMaterial {\n\n    public userData:    any;\n    public uniforms:    any;\n\n    private _material:  ShaderMaterial;\n\n    private static count: number = 0;\n\n    constructor(mat: ShaderMaterial) {\n        this._material = mat;\n        this.userData = mat.metadata.userData;\n        this.uniforms = mat.metadata.uniforms;\n    }\n\n    get material(): ShaderMaterial {\n        return this._material;\n    }\n\n    get depthWrite(): boolean {\n        return !this._material.disableDepthWrite;\n    }\n\n    set depthWrite(dw: boolean) {\n        this._material.disableDepthWrite = !dw;\n    }\n\n    get transparent(): boolean {\n        return this._material.options.needAlphaBlending;\n    }\n\n    set transparent(t: boolean) {\n        this._material.options.needAlphaBlending = t;\n        this._material.alphaMode = BEngine.ALPHA_SCREENMODE;\n    }\n\n    get vertexShader(): string {\n        const mat = this._material;\n\n        return (mat as any)._shaderPath.vertex;  //! todo better\n    }\n\n    set vertexShader(vs: string) {\n        const mat = this._material;\n\n        mat.options.defines = [\"#define __ \" + Engine.getShaderMgr().globalLightsInFragment];\n\n        (mat as any)._shaderPath.vertex = vs;  //! todo better\n    }\n\n    get fragmentShader(): string {\n        const mat = this._material;\n\n        return (mat as any)._shaderPath.fragment;  //! todo better\n    }\n\n    set fragmentShader(fs: string) {\n        const mat = this._material;\n\n        mat.options.defines = [\"#define __ \" + Engine.getShaderMgr().globalLightsInFragment];\n\n        (mat as any)._shaderPath.fragment = fs;  //! todo better\n    }\n\n    public uniformsUpdated(names?: Array<string>): void {\n        if (names !== undefined) {\n            for (let i = 0; i < names.length; ++i) {\n                const uval = this.uniforms[names[i]];\n                if (uval) {\n                    this._setUniformValue(names[i], uval);\n                }\n            }\n        } else {\n            for (const uname in this.uniforms) {\n                const uval = this.uniforms[uname];\n                this._setUniformValue(uname, uval);\n            }\n        }\n    }\n\n    protected _setUniformValue(uname: string, uval: any): void {\n        switch (uval.type) {\n            case 't':\n                this._material.setTexture(uname, uval.value);\n                break;\n            case 'i':\n                this._material.setInt(uname, uval.value);\n                break;\n            case 'f':\n                this._material.setFloat(uname, uval.value);\n                break;\n            case 'f3':\n                if (!uval._value) {\n                    uval._value = new Vector3(0, 0, 0);\n                }\n                uval._value.copyFromFloats(uval.value[0], uval.value[1], uval.value[2]);\n                this._material.setVector3(uname, uval._value);\n                break;\n            case 'f4':\n                if (!uval._value) {\n                    uval._value = new Vector4(0, 0, 0, 0);\n                }\n                uval._value.copyFromFloats(uval.value[0], uval.value[1], uval.value[2], uval.value[3]);\n                this._material.setVector4(uname, uval._value);\n                break;\n            case 'fv1':\n                this._material.setFloats(uname, uval.value);\n                break;\n            case 'fv':\n                this._material.setArray3(uname, uval.value);\n                break;\n            case 'm4v':\n                (this._material as any).setMatrices(uname, uval.value); //! todo better\n                break;\n        }\n    }\n\n    public clone(): Material {\n        const shd = this._material.clone(this._material.name + '_copy' + (Material.count++));\n\n        (shd as any)._shaderPath = Object.assign({}, (shd as any)._shaderPath); //! todo better\n\n        shd.alphaMode = this._material.alphaMode; //! todo: remove when using updated babylon\n\n        shd.metadata = {\n            \"userData\": this.userData,\n            \"uniforms\": this.cloneUniforms(this.uniforms),\n        };\n\n        return new Material(shd);\n    }\n\n    protected cloneUniforms(src: any): any {\n        const dst: any = {};\n\n        for (const u in src) {\n            dst[u] = {};\n\n            for (const p in src[u]) {\n                const property = src[u][p];\n\n                if (p === \"_value\") {\n                    continue;\n                }\n\n                if (Array.isArray(property)) {\n                    dst[u][p] = property.slice();\n                } else {\n                    dst[u][p] = property;\n                }\n            }\n        }\n\n        return dst;\n    }\n\n    public setZBias(factor: number, unit: number): void {\n        this._material.zOffset = factor;\n    }\n\n}\n","import {\r\n    AbstractMesh,\r\n    BoundingInfo,\r\n    MultiMaterial,\r\n    ShaderMaterial,\r\n    Vector3,\r\n    Quaternion as BQuaternion\r\n} from \"babylonjs\";\r\n\r\nimport { IMesh } from \"../../src/Proxy/IMesh\";\r\nimport { Position, Quaternion } from \"../../src/Proxy/INode\";\r\nimport { Box3 } from \"../../src/Utils/Box3\";\r\nimport { Behaviour } from \"../../src/Behaviour/Behaviour\";\r\n\r\nimport Material from \"./Material\";\r\n\r\n//const  rotY180 = new BQuaternion(0, -1, 0, 0); // x <=> -x\r\n\r\nexport default class Mesh implements IMesh {\r\n\r\n    public behaviours:      Array<Behaviour>;\r\n\r\n    protected _materials:   Array<Material>;\r\n    protected _mesh:        AbstractMesh;\r\n    protected _visible:     boolean;\r\n\r\n    constructor(obj: AbstractMesh) {\r\n        this._mesh = obj;\r\n        this.behaviours = [];\r\n        this._materials = [];\r\n        this._visible = true;\r\n\r\n        if (obj.material instanceof MultiMaterial) {\r\n            for (let m = 0; m < obj.material.subMaterials.length; ++m) {\r\n                this._materials.push(new Material(obj.material.subMaterials[m] as ShaderMaterial));\r\n            }\r\n        }\r\n    }\r\n\r\n    get object(): AbstractMesh {\r\n        return this._mesh;\r\n    }\r\n\r\n    get materials(): Array<Material> {\r\n        return this._materials;\r\n    }\r\n\r\n    set materials(mat: Array<Material>) {\r\n        this._materials = mat;\r\n\r\n        const objmat = this._mesh.material = new MultiMaterial(this._mesh.name, this._mesh.getScene());\r\n\r\n        objmat.subMaterials = [];\r\n\r\n        mat.forEach((m) => objmat.subMaterials.push(m.material));\r\n    }\r\n\r\n    public get position(): Position {\r\n        return [this._mesh.position.x, this._mesh.position.y, this._mesh.position.z];\r\n    }\r\n\r\n    public setPosition(pos: Position): void {\r\n        this._mesh.position.set(...pos);\r\n    }\r\n\r\n    public get quaternion(): Quaternion {\r\n        //let q = this.obj.rotationQuaternion!.multiply(rotY180);\r\n        //return [q.x, q.y, q.z, q.w];\r\n        return [this._mesh.rotationQuaternion!.x, this._mesh.rotationQuaternion!.y, this._mesh.rotationQuaternion!.z, this._mesh.rotationQuaternion!.w];\r\n    }\r\n\r\n    public setQuaternion(quat: Quaternion): void {\r\n        //this.obj.rotationQuaternion = new BQuaternion(...quat).multiply(rotY180);\r\n        this._mesh.rotationQuaternion!.set(...quat);\r\n    }\r\n\r\n    get matrixAutoUpdate(): boolean {\r\n        return true;\r\n    }\r\n\r\n    set matrixAutoUpdate(b: boolean) {\r\n    }\r\n\r\n    get name(): string {\r\n        return this._mesh.name;\r\n    }\r\n\r\n    set name(n: string) {\r\n        this._mesh.name = n;\r\n    }\r\n\r\n    get visible(): boolean {\r\n        return this._visible;\r\n    }\r\n\r\n    set visible(v: boolean) {\r\n        this._mesh.setEnabled(v);\r\n        this._visible = v;\r\n    }\r\n\r\n    get renderOrder(): number {\r\n        return this._mesh.renderingGroupId;\r\n    }\r\n\r\n    set renderOrder(ro: number) {\r\n        this._mesh.renderingGroupId = ro;\r\n    }\r\n\r\n    get frustumCulled(): boolean {\r\n        return !this._mesh.alwaysSelectAsActiveMesh;\r\n    }\r\n\r\n    set frustumCulled(fc: boolean) {\r\n        this._mesh.alwaysSelectAsActiveMesh = !fc;\r\n    }\r\n\r\n    public updateMatrixWorld(): void {\r\n        this._mesh.computeWorldMatrix();\r\n    }\r\n\r\n    public containsPoint(pos: Position): boolean {\r\n        return this._mesh.getBoundingInfo().boundingBox.intersectsPoint(new Vector3(pos[0], pos[1], pos[2]));\r\n    }\r\n\r\n    public showBoundingBox(show: boolean): void {\r\n        this._mesh.showBoundingBox = show;\r\n    }\r\n\r\n    public clone(): Mesh {\r\n        return new Mesh(this._mesh.clone(this._mesh.name, null as any) as AbstractMesh);\r\n    }\r\n\r\n    public setBoundingBox(box: Box3): void {\r\n        const boundingInfo = new BoundingInfo(new Vector3(box.min[0], box.min[1], box.min[2]), new Vector3(box.max[0], box.max[1], box.max[2]), this._mesh.getWorldMatrix());\r\n        this._mesh.setBoundingInfo(boundingInfo);\r\n    }\r\n\r\n    public getBoundingBox(): Box3 {\r\n        const boundingInfo = this._mesh.getBoundingInfo(),\r\n              boundingBox = boundingInfo.boundingBox;\r\n\r\n        return new Box3([boundingBox.minimum.x, boundingBox.minimum.y, boundingBox.minimum.z], [boundingInfo.maximum.x, boundingInfo.maximum.y, boundingInfo.maximum.z]);\r\n    }\r\n\r\n}\r\n","import {\r\n    DataArray,\r\n    Geometry,\r\n    IndicesArray,\r\n    Mesh as BMesh,\r\n    MultiMaterial,\r\n    ShaderMaterial,\r\n    SubMesh,\r\n    VertexBuffer\r\n} from \"babylonjs\";\r\n\r\nimport Engine from \"../../src/Proxy/Engine\";\r\nimport { IMesh } from \"../../src/Proxy/IMesh\";\r\nimport { IMeshBuilder, indexList } from \"../../src/Proxy/IMeshBuilder\";\r\n\r\nimport Mesh from \"./Mesh\";\r\nimport Scene from \"./Scene\";\r\nimport { ShaderManager } from \"./ShaderManager\";\r\n\r\nexport default class MeshBuilder implements IMeshBuilder {\r\n\r\n    protected _mesh:        BMesh;\r\n    protected _tmesh:       Mesh;\r\n    protected _skinIndices: Array<indexList>;\r\n\r\n    constructor(mesh?: Mesh) {\r\n        this._tmesh = mesh as any;\r\n        this._mesh = mesh ? mesh.object as BMesh : <any>null;\r\n        this._skinIndices = [];\r\n    }\r\n\r\n    get mesh(): IMesh {\r\n        return this._tmesh;\r\n    }\r\n\r\n    get skinIndicesList(): Array<indexList> {\r\n        return this._skinIndices;\r\n    }\r\n\r\n    get vertices(): Array<number> {\r\n        const geometry = this._mesh.geometry as Geometry,\r\n              vertices = geometry.getVerticesData(\"position\", false, false);\r\n\r\n        return Array.isArray(vertices) ? vertices : Array.from(vertices as Float32Array);\r\n    }\r\n\r\n    public setIndex(index: indexList, dontUpdateSubMeshes?: boolean): void {\r\n        const geometry = this._mesh.geometry as Geometry;\r\n\r\n        const subMeshes = this._mesh.subMeshes.slice();\r\n\r\n        geometry.setIndices(index, null, false); // this call remove the sub meshes and recreate a single new one, hence the lines before and after\r\n\r\n        this._mesh.subMeshes = subMeshes;\r\n\r\n        if (!dontUpdateSubMeshes) {\r\n            if (subMeshes.length != 1) {\r\n                //throw \"Works only for meshes with a single sub mesh!\";\r\n                // we should stop, but the case arises only in ang_race cutscenes for Von Croy character, and it's safe to set indexStart / indexCount to 0 / 0 for subMeshes >= 1\r\n            }\r\n\r\n            const subm = this._mesh.subMeshes[0];\r\n\r\n            subm.indexStart = 0;\r\n            subm.indexCount = index.length;\r\n\r\n            for (let m = 1; m < this._mesh.subMeshes.length; ++m) {\r\n                this._mesh.subMeshes[m].indexStart = 0;\r\n                this._mesh.subMeshes[m].indexCount = 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    public makeSkinIndicesList(): void {\r\n        if (this._skinIndices.length > 0) {\r\n            return;\r\n        }\r\n\r\n        const geometry = this._mesh.geometry as Geometry,\r\n              vbSkinIndex = geometry.getVertexBuffer(\"skinIndex\");\r\n\r\n        if (!vbSkinIndex) {\r\n            return;\r\n        }\r\n\r\n        let index = geometry.getIndices(false) as IndicesArray,\r\n            arSkinIndex = this.getArrayFromDataArray(vbSkinIndex);\r\n\r\n        for (let i = 0; i < index!.length / 3; ++i) {\r\n            const skinIndex = arSkinIndex[index[i * 3 + 0 ] * 4 + 0];\r\n\r\n            let lst: indexList = this._skinIndices[skinIndex];\r\n            if (!lst) {\r\n                lst = [];\r\n                this._skinIndices[skinIndex] = lst;\r\n            }\r\n\r\n            lst.push(index[i * 3 + 0], index[i * 3 + 1], index[i * 3 + 2]);\r\n        }\r\n    }\r\n\r\n    public createFaces(faces: Array<any>, matIndex: number): void {\r\n        const geometry = this._mesh.geometry as Geometry,\r\n              index = Array.from(geometry.getIndices(false) as IndicesArray),\r\n              positions = this.getArrayFromDataArray(geometry.getVertexBuffer(\"position\")!),\r\n              colors = this.getArrayFromDataArray(geometry.getVertexBuffer(\"vertColor\")!),\r\n              normals = this.getArrayFromDataArray(geometry.getVertexBuffer(\"normal\")!),\r\n              uvs = this.getArrayFromDataArray(geometry.getVertexBuffer(\"uv\")!),\r\n              _flags = this.getArrayFromDataArray(geometry.getVertexBuffer(\"_flags\")!);\r\n\r\n        let addIndex = [],\r\n            ofstIdx = positions.length / 3;\r\n\r\n        for (let f = 0; f < faces.length; ++f, ofstIdx += 3) {\r\n            const face = faces[f];\r\n\r\n            positions.push(...face.v1, ...face.v2, ...face.v3);\r\n            colors.push(...face.c1, ...face.c2, ...face.c3);\r\n            normals.push(...face.n1, ...face.n2, ...face.n3);\r\n            uvs.push(...face.uv1, ...face.uv2, ...face.uv3);\r\n            _flags.push(...face.f1, ...face.f2, ...face.f3);\r\n\r\n            addIndex.push(ofstIdx + 2, ofstIdx + 1, ofstIdx);\r\n        }\r\n\r\n        index.splice(this._mesh.subMeshes[matIndex].indexStart, 0, ...addIndex);\r\n\r\n        const subMeshes = this._mesh.subMeshes.slice();\r\n\r\n        subMeshes[matIndex].indexCount += addIndex.length;\r\n\r\n        for (let g = matIndex + 1; g < subMeshes.length; ++g) {\r\n            subMeshes[g].indexStart += addIndex.length;\r\n        }\r\n\r\n        geometry.setIndices(index);\r\n\r\n        this._mesh.setVerticesData(\"position\", positions, false, 3);\r\n        this._mesh.setVerticesData(\"vertColor\", colors, false, 3);\r\n        this._mesh.setVerticesData(\"normal\", normals, false, 3);\r\n        this._mesh.setVerticesData(\"uv\", uvs, false, 2);\r\n        this._mesh.setVerticesData(\"_flags\", _flags, false, 4);\r\n\r\n        this._mesh.releaseSubMeshes();\r\n\r\n        for (let submeshIndex = 0; submeshIndex < subMeshes.length; submeshIndex++) {\r\n            const previousOne = subMeshes[submeshIndex];\r\n            SubMesh.AddToMesh(previousOne.materialIndex, previousOne.indexStart, previousOne.indexCount, previousOne.indexStart, previousOne.indexCount, this._mesh);\r\n        }\r\n    }\r\n\r\n    public copyFace(faceIdx: number): any {\r\n        const geometry = this._mesh.geometry as Geometry,\r\n              index = Array.from(geometry.getIndices(false) as IndicesArray),\r\n              positions = this.getArrayFromDataArray(geometry.getVertexBuffer(\"position\")!),\r\n              colors = this.getArrayFromDataArray(geometry.getVertexBuffer(\"vertColor\")!),\r\n              normals = this.getArrayFromDataArray(geometry.getVertexBuffer(\"normal\")!),\r\n              uvs = this.getArrayFromDataArray(geometry.getVertexBuffer(\"uv\")!),\r\n              _flags = this.getArrayFromDataArray(geometry.getVertexBuffer(\"_flags\")!);\r\n\r\n        const newFace = {\r\n                v3: [positions[index[faceIdx * 3 + 0] * 3 + 0], positions[index[faceIdx * 3 + 0] * 3 + 1], positions[index[faceIdx * 3 + 0] * 3 + 2]],\r\n                v2: [positions[index[faceIdx * 3 + 1] * 3 + 0], positions[index[faceIdx * 3 + 1] * 3 + 1], positions[index[faceIdx * 3 + 1] * 3 + 2]],\r\n                v1: [positions[index[faceIdx * 3 + 2] * 3 + 0], positions[index[faceIdx * 3 + 2] * 3 + 1], positions[index[faceIdx * 3 + 2] * 3 + 2]],\r\n\r\n                c3: [colors[index[faceIdx * 3 + 0] * 3 + 0], colors[index[faceIdx * 3 + 0] * 3 + 1], colors[index[faceIdx * 3 + 0] * 3 + 2]],\r\n                c2: [colors[index[faceIdx * 3 + 1] * 3 + 0], colors[index[faceIdx * 3 + 1] * 3 + 1], colors[index[faceIdx * 3 + 1] * 3 + 2]],\r\n                c1: [colors[index[faceIdx * 3 + 2] * 3 + 0], colors[index[faceIdx * 3 + 2] * 3 + 1], colors[index[faceIdx * 3 + 2] * 3 + 2]],\r\n\r\n                n3: [normals[index[faceIdx * 3 + 0] * 3 + 0], normals[index[faceIdx * 3 + 0] * 3 + 1], normals[index[faceIdx * 3 + 0] * 3 + 2]],\r\n                n2: [normals[index[faceIdx * 3 + 1] * 3 + 0], normals[index[faceIdx * 3 + 1] * 3 + 1], normals[index[faceIdx * 3 + 1] * 3 + 2]],\r\n                n1: [normals[index[faceIdx * 3 + 2] * 3 + 0], normals[index[faceIdx * 3 + 2] * 3 + 1], normals[index[faceIdx * 3 + 2] * 3 + 2]],\r\n\r\n                uv3: [uvs[index[faceIdx * 3 + 0] * 2 + 0], uvs[index[faceIdx * 3 + 0] * 2 + 1]],\r\n                uv2: [uvs[index[faceIdx * 3 + 1] * 2 + 0], uvs[index[faceIdx * 3 + 1] * 2 + 1]],\r\n                uv1: [uvs[index[faceIdx * 3 + 2] * 2 + 0], uvs[index[faceIdx * 3 + 2] * 2 + 1]],\r\n\r\n                f3: [_flags[index[faceIdx * 3 + 0] * 4 + 0], _flags[index[faceIdx * 3 + 0] * 4 + 1], _flags[index[faceIdx * 3 + 0] * 4 + 2], _flags[index[faceIdx * 3 + 0] * 4 + 3]],\r\n                f2: [_flags[index[faceIdx * 3 + 1] * 4 + 0], _flags[index[faceIdx * 3 + 1] * 4 + 1], _flags[index[faceIdx * 3 + 1] * 4 + 2], _flags[index[faceIdx * 3 + 1] * 4 + 3]],\r\n                f1: [_flags[index[faceIdx * 3 + 2] * 4 + 0], _flags[index[faceIdx * 3 + 2] * 4 + 1], _flags[index[faceIdx * 3 + 2] * 4 + 2], _flags[index[faceIdx * 3 + 2] * 4 + 3]]\r\n            };\r\n\r\n        return newFace;\r\n    }\r\n\r\n    public removeFaces(remove: Set<number>): void {\r\n        let geom = this._mesh.geometry as Geometry,\r\n            indices = [],\r\n            index = Array.from(geom.getIndices(false) as IndicesArray);\r\n\r\n        let ofstGroups = this._mesh.subMeshes.map(() => 0);\r\n        for (let i = 0; i < index.length / 3; ++i) {\r\n            if (!remove.has(i)) {\r\n                indices.push(index[i * 3 + 0], index[i * 3 + 1], index[i * 3 + 2]);\r\n            } else {\r\n                for (let g = 0; g < this._mesh.subMeshes.length; ++g) {\r\n                    const group = this._mesh.subMeshes[g];\r\n                    if (i * 3 >= group.indexStart && i * 3 < group.indexStart + group.indexCount) {\r\n                        ofstGroups[g] += 3;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.setIndex(indices, true);\r\n\r\n        for (let g = 0, sum = 0; g < this._mesh.subMeshes.length; ++g) {\r\n            this._mesh.subMeshes[g].indexCount -= ofstGroups[g];\r\n            this._mesh.subMeshes[g].indexStart -= sum;\r\n            sum += ofstGroups[g];\r\n        }\r\n    }\r\n\r\n    public replaceSkinIndices(remap: any): void {\r\n        const geometry = this._mesh.geometry as Geometry,\r\n              vbSkinIndex = geometry.getVertexBuffer(\"skinIndex\");\r\n\r\n        if (!vbSkinIndex) {\r\n            return;\r\n        }\r\n\r\n        let skinIndices = this.getArrayFromDataArray(vbSkinIndex),\r\n            indices: Array<number> = [];\r\n        for (let i = 0; i < skinIndices.length; ++i) {\r\n            const v = remap[skinIndices[i]];\r\n            if (v !== undefined) {\r\n                indices[i] = v;\r\n            } else {\r\n                indices[i] = skinIndices[i];\r\n            }\r\n        }\r\n\r\n        this._mesh.setVerticesData(\"skinIndex\", indices, false, vbSkinIndex.byteStride / 4);\r\n    }\r\n\r\n    public copyFacesWithSkinIndex(skinidx: number, newskinidx: number): void {\r\n        const geometry = this._mesh.geometry as Geometry,\r\n              index = Array.from(geometry.getIndices(false) as IndicesArray),\r\n              positions = this.getArrayFromDataArray(geometry.getVertexBuffer(\"position\")!),\r\n              normals = this.getArrayFromDataArray(geometry.getVertexBuffer(\"normal\")!),\r\n              skinIndices = this.getArrayFromDataArray(geometry.getVertexBuffer(\"skinIndex\")!),\r\n              skinWeights = this.getArrayFromDataArray(geometry.getVertexBuffer(\"skinWeight\")!),\r\n              uvs = this.getArrayFromDataArray(geometry.getVertexBuffer(\"uv\")!),\r\n              _flags = this.getArrayFromDataArray(geometry.getVertexBuffer(\"_flags\")!);\r\n\r\n        const addIndex = [];\r\n\r\n        for (let i = 0; i < index.length / 3; ++i) {\r\n            const posIdx1 = index[i * 3 + 0], posIdx2 = index[i * 3 + 1], posIdx3 = index[i * 3 + 2];\r\n            if (skinIndices[posIdx1 * 4 + 0] == skinidx && skinIndices[posIdx1 * 4 + 1] == skinidx) {\r\n                // we assume that the 2 other vertices of the face have also skinidx has skin index\r\n                const nposIdx = positions.length / 3;\r\n\r\n                addIndex.push(nposIdx, nposIdx + 1, nposIdx + 2);\r\n\r\n                positions.push(positions[posIdx1 * 3 + 0], positions[posIdx1 * 3 + 1], positions[posIdx1 * 3 + 2]);\r\n                positions.push(positions[posIdx2 * 3 + 0], positions[posIdx2 * 3 + 1], positions[posIdx2 * 3 + 2]);\r\n                positions.push(positions[posIdx3 * 3 + 0], positions[posIdx3 * 3 + 1], positions[posIdx3 * 3 + 2]);\r\n\r\n                normals.push(normals[posIdx1 * 3 + 0], normals[posIdx1 * 3 + 1], normals[posIdx1 * 3 + 2]);\r\n                normals.push(normals[posIdx2 * 3 + 0], normals[posIdx2 * 3 + 1], normals[posIdx2 * 3 + 2]);\r\n                normals.push(normals[posIdx3 * 3 + 0], normals[posIdx3 * 3 + 1], normals[posIdx3 * 3 + 2]);\r\n\r\n                skinIndices.push(newskinidx, newskinidx, 0, 0);\r\n                skinIndices.push(newskinidx, newskinidx, 0, 0);\r\n                skinIndices.push(newskinidx, newskinidx, 0, 0);\r\n\r\n                skinWeights.push(skinWeights[posIdx1 * 4 + 0], skinWeights[posIdx1 * 4 + 1], skinWeights[posIdx1 * 4 + 2], skinWeights[posIdx1 * 4 + 3]);\r\n                skinWeights.push(skinWeights[posIdx2 * 4 + 0], skinWeights[posIdx2 * 4 + 1], skinWeights[posIdx2 * 4 + 2], skinWeights[posIdx2 * 4 + 3]);\r\n                skinWeights.push(skinWeights[posIdx3 * 4 + 0], skinWeights[posIdx3 * 4 + 1], skinWeights[posIdx3 * 4 + 2], skinWeights[posIdx3 * 4 + 3]);\r\n\r\n                uvs.push(uvs[posIdx1 * 2 + 0], uvs[posIdx1 * 2 + 1]);\r\n                uvs.push(uvs[posIdx2 * 2 + 0], uvs[posIdx2 * 2 + 1]);\r\n                uvs.push(uvs[posIdx3 * 2 + 0], uvs[posIdx3 * 2 + 1]);\r\n\r\n                _flags.push(_flags[posIdx1 * 4 + 0], _flags[posIdx1 * 4 + 1], _flags[posIdx1 * 4 + 2], _flags[posIdx1 * 4 + 3]);\r\n                _flags.push(_flags[posIdx2 * 4 + 0], _flags[posIdx2 * 4 + 1], _flags[posIdx2 * 4 + 2], _flags[posIdx2 * 4 + 3]);\r\n                _flags.push(_flags[posIdx3 * 4 + 0], _flags[posIdx3 * 4 + 1], _flags[posIdx3 * 4 + 2], _flags[posIdx3 * 4 + 3]);\r\n            }\r\n        }\r\n\r\n        index.push(...addIndex);\r\n\r\n        this.setIndex(index, true);\r\n\r\n        this._mesh.subMeshes[0].indexCount = index.length; // assume there is a single subMesh\r\n\r\n        this._mesh.setVerticesData(\"position\", positions, false, 3);\r\n        this._mesh.setVerticesData(\"normal\", normals, false, 3);\r\n        this._mesh.setVerticesData(\"skinIndex\", skinIndices, false, 4);\r\n        this._mesh.setVerticesData(\"skinWeight\", skinWeights, false, 4);\r\n        this._mesh.setVerticesData(\"uv\", uvs, false, 2);\r\n        this._mesh.setVerticesData(\"_flags\", _flags, false, 4);\r\n    }\r\n\r\n    protected getArrayFromDataArray(vb: VertexBuffer): Array<number> {\r\n        let da = vb.getData() as DataArray,\r\n            ar: Array<number> = [];\r\n\r\n        if (Array.isArray(da)) {\r\n            ar = da;\r\n        } else {\r\n            ar = Array.from(new Float32Array(<ArrayBuffer>da));\r\n        }\r\n\r\n        return ar;\r\n    }\r\n\r\n    public createMesh(name: string, scene: Scene, vshader: string, fshader: string, uniforms: any, vertices: Array<number>, indices: Array<number>, uvs?: Array<number>, colors?: Array<number>): IMesh {\r\n        const activeScene = scene.object;\r\n\r\n        const geom = new Geometry(`Geometry of ${name}`, activeScene),\r\n              attributes = ['position'];\r\n\r\n        geom.setVerticesData(\"position\", new Float32Array(vertices), false, 3);\r\n\r\n        if (uvs !== undefined) {\r\n            geom.setVerticesData(\"uv\", new Float32Array(uvs), false, 2);\r\n            attributes.push('uv');\r\n        }\r\n\r\n        if (colors !== undefined) {\r\n            geom.setVerticesData(\"vertColor\", new Float32Array(colors), false, 3);\r\n            attributes.push('vertColor');\r\n        }\r\n\r\n        const aindices = indices.slice();\r\n\r\n        for (let i = 0; i < aindices.length; i += 3) {\r\n            const i0 = aindices[i];\r\n            aindices[i] = aindices[i + 2];\r\n            aindices[i + 2] = i0;\r\n        }\r\n\r\n        geom.setIndices(aindices);\r\n\r\n        let uniformsUsed = new Set<string>();\r\n\r\n        (Engine.getShaderMgr() as ShaderManager).getVertexUniforms(vshader)!.forEach((u) => uniformsUsed.add(u));\r\n        (Engine.getShaderMgr() as ShaderManager).getFragmentUniforms(fshader)!.forEach((u) => uniformsUsed.add(u));\r\n\r\n        let samplers = [\"map\", \"mapBump\"];\r\n\r\n        if (uniforms) {\r\n            for (const uname in uniforms) {\r\n                uniformsUsed.add(uname);\r\n            }\r\n        }\r\n\r\n        const shd = new ShaderMaterial(`Shader of ${name}`, activeScene, {\r\n            \"vertex\":   vshader,\r\n            \"fragment\": fshader,\r\n        }, {\r\n            attributes: attributes,\r\n            samplers: samplers,\r\n            uniforms: Array.from(uniformsUsed)\r\n        });\r\n\r\n        shd.metadata = {\r\n            \"uniforms\": uniforms || {},\r\n            \"userData\": {}\r\n        };\r\n\r\n        const multimat = new MultiMaterial(`Material of ${name}`, activeScene);\r\n\r\n        multimat.subMaterials.push(shd);\r\n\r\n        this._mesh = new BMesh(name, activeScene);\r\n        this._mesh.subMeshes = [];\r\n        this._mesh.material = multimat;\r\n\r\n        geom.applyToMesh(this._mesh);\r\n\r\n        const tmesh = new Mesh(this._mesh),\r\n              materials = tmesh.materials;\r\n\r\n        materials.forEach((m) => m.uniformsUpdated());\r\n\r\n        scene.add(tmesh);\r\n\r\n        return tmesh;\r\n    }\r\n\r\n    public getIndexAndGroupState(): any {\r\n        let geom = this._mesh.geometry as Geometry,\r\n            index = Array.from(geom.getIndices(false) as IndicesArray);\r\n\r\n        const groups = [];\r\n\r\n        for (let g = 0; g < this._mesh.subMeshes.length; ++g) {\r\n            groups.push({\r\n                \"indexStart\": this._mesh.subMeshes[g].indexStart,\r\n                \"indexCount\": this._mesh.subMeshes[g].indexCount,\r\n            });\r\n        }\r\n\r\n        return {\r\n            \"indices\": index,\r\n            \"groups\": groups,\r\n        };\r\n    }\r\n\r\n    public setIndexAndGroupsState(state: any): void {\r\n        this.setIndex(state.indices, true);\r\n\r\n        for (let g = 0; g < this._mesh.subMeshes.length; ++g) {\r\n            this._mesh.subMeshes[g].indexCount = state.groups[g].indexCount;\r\n            this._mesh.subMeshes[g].indexStart = state.groups[g].indexStart;\r\n        }\r\n    }\r\n}\r\n","import {\r\n    Quaternion as BQuaternion,\r\n    TransformNode,\r\n    Vector3\r\n} from \"babylonjs\";\r\n\r\nimport { INode, Position, Quaternion } from \"../../src/Proxy/INode\";\r\n\r\nimport Scene from \"./Scene\";\r\n//const  rotY180 = new BQuaternion(0, -1, 0, 0); // x <=> -x\r\n\r\nexport default class Node implements INode {\r\n\r\n    protected _node:        TransformNode;\r\n    protected _children:    Array<Node>;\r\n\r\n    constructor(obj?: TransformNode, name?: string, scene?: Scene) {\r\n        this._node = obj ? obj : new TransformNode(name ? name : \"unnamed Node\", scene ? scene.object : null);\r\n        this._children = [];\r\n        this._node.rotationQuaternion = new BQuaternion();\r\n    }\r\n\r\n    get object(): TransformNode {\r\n        return this._node;\r\n    }\r\n\r\n    public get position(): Position {\r\n        return [this._node.position.x, this._node.position.y, this._node.position.z];\r\n    }\r\n\r\n    public setPosition(pos: Position): void {\r\n        this._node.position.set(...pos);\r\n    }\r\n\r\n    public get quaternion(): Quaternion {\r\n        return [this._node.rotationQuaternion!.x, this._node.rotationQuaternion!.y, this._node.rotationQuaternion!.z, this._node.rotationQuaternion!.w];\r\n    }\r\n\r\n    public setQuaternion(quat: Quaternion): void {\r\n        this._node.rotationQuaternion!.set(...quat);\r\n    }\r\n\r\n    public add(child: Node): void {\r\n        child.object.parent = this._node;\r\n        this._children.push(child);\r\n    }\r\n\r\n    public remove(child: Node): void {\r\n        const index = this._children.indexOf(child);\r\n\r\n        if (index !== - 1) {\r\n            this._children.splice(index, 1);\r\n            child.object.parent = null;\r\n        }\r\n    }\r\n\r\n    public updateMatrixWorld(): void {\r\n        this._node.computeWorldMatrix();\r\n        for (let c = 0; c < this._children.length; ++c) {\r\n            this._children[c].updateMatrixWorld();\r\n        }\r\n    }\r\n\r\n    public matrixWorldToArray(arr: Float32Array, ofst: number): void {\r\n        arr.set(this._node.getWorldMatrix().toArray(), ofst);\r\n    }\r\n\r\n    public decomposeMatrixWorld(pos: Position, quat: Quaternion): void {\r\n        const _pos = new Vector3(), _quat = new BQuaternion(), _scale = new Vector3();\r\n\r\n        this._node.getWorldMatrix().decompose(_scale, _quat, _pos);\r\n\r\n        pos[0] = _pos.x;    pos[1] = _pos.y;    pos[2] = _pos.z;\r\n        quat[0] = _quat.x;  quat[1] = _quat.y;  quat[2] = _quat.z;  quat[3] = _quat.w;\r\n    }\r\n\r\n}\r\n","import {\r\n    Color4,\r\n    Engine,\r\n    EngineInstrumentation,\r\n    PerfCounter,\r\n    Scene as BScene,\r\n    SceneInstrumentation\r\n} from \"babylonjs\";\r\n\r\nimport { IRenderer, PerfData } from \"../../src/Proxy/IRenderer\";\r\n\r\nimport Camera from \"./Camera\";\r\nimport Scene from \"./Scene\";\r\n\r\nexport default class Renderer implements IRenderer {\r\n\r\n    protected _engine: Engine;\r\n    protected _sctc: PerfCounter;\r\n\r\n    constructor(container: Element, engine: Engine, canvas: HTMLCanvasElement) {\r\n        container.appendChild(canvas);\r\n        this._engine = engine;\r\n\r\n        const ei = new EngineInstrumentation(this._engine);\r\n        ei.captureShaderCompilationTime = true;\r\n\r\n        this._sctc = ei.shaderCompilationTimeCounter;\r\n    }\r\n\r\n    get engine(): Engine {\r\n        return this._engine;\r\n    }\r\n\r\n    public setSize(width: number, height: number): void {\r\n        const scale = this._engine.getHardwareScalingLevel();\r\n        this._engine.setSize(width / scale, height / scale);\r\n    }\r\n\r\n    public createScene(): Scene {\r\n        let newScene = new BScene(this._engine);\r\n        newScene.useRightHandedSystem = true;\r\n        //newScene.autoClear = false;\r\n        newScene.clearColor = new Color4(0, 0, 0, 1);\r\n        newScene.detachControl();\r\n        return new Scene(newScene);\r\n    }\r\n\r\n    public clear(): void {\r\n    }\r\n\r\n    public render(scene: Scene, camera: Camera): void {\r\n        scene.object.activeCamera = camera.object;\r\n        scene.object.render(false, true);\r\n    }\r\n\r\n    public getPerfData(scenes: Array<Scene>): PerfData {\r\n        let numDrawCalls = 0, numObjects = 0, numGeometries = 0, numFaces = 0, numTextures = 0, numParticles = 0, numPrograms = 0;\r\n\r\n        scenes.forEach((scene) => {\r\n            numObjects += scene.object.getActiveMeshes().length;\r\n            numGeometries += scene.object.getGeometries().length;\r\n            numFaces += scene.object.getActiveIndices() / 3;\r\n            numTextures += scene.object.textures.length;\r\n            numParticles += scene.object.getActiveParticles();\r\n        });\r\n\r\n        numDrawCalls = new SceneInstrumentation(scenes[0].object).drawCallsCounter.current;\r\n        numPrograms = this._sctc.count;\r\n\r\n        return {\r\n            \"numDrawCalls\" : numDrawCalls,\r\n            \"numObjects\": numObjects,\r\n            \"numFaces\": numFaces,\r\n            \"numTextures\": numTextures,\r\n            \"numGeometries\": numGeometries,\r\n            \"numParticles\": numParticles,\r\n            \"numPrograms\": numPrograms,\r\n        };\r\n    }\r\n\r\n}\r\n","import {\r\n    Scene as BScene,\r\n    Color4\r\n} from \"babylonjs\";\r\n\r\nimport { IScene, TextureList } from \"../../src/Proxy/IScene\";\r\n\r\nimport Camera from \"./Camera\";\r\nimport Mesh from \"./Mesh\";\r\n\r\nexport default class Scene implements IScene {\r\n\r\n    public textures:        TextureList | undefined;\r\n\r\n    protected _scene:       BScene;\r\n    protected _children:    Array<Mesh>;\r\n    protected _camera:      Camera;\r\n\r\n    constructor(scene: BScene, textures?: TextureList) {\r\n        this._scene = scene;\r\n        this._children = [];\r\n        this.textures = textures;\r\n        this._scene.clearColor = new Color4(0, 0, 0, 1);\r\n        this._camera = <any>null;\r\n    }\r\n\r\n    get totalNumObjects(): number {\r\n        return this._scene.getActiveMeshes().length;\r\n    }\r\n\r\n    get object(): BScene {\r\n        return this._scene;\r\n    }\r\n\r\n    get allMeshesReady(): boolean {\r\n        for (let i = 0; i < this._scene.meshes.length; ++i) {\r\n            if (!this._scene.meshes[i].isReady(true)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public traverse(callback: (obj: Mesh) => void): void {\r\n        for (let i = 0; i < this._children.length; i ++) {\r\n            const child = this._children[i];\r\n            callback(child);\r\n        }\r\n    }\r\n\r\n    public add(obj: Mesh): void {\r\n        if (this._scene.meshes.indexOf(obj.object) < 0) {\r\n            this._scene.addMesh(obj.object);\r\n        }\r\n        this._children.push(obj);\r\n    }\r\n\r\n    public remove(obj: Mesh): void {\r\n        const index = this._children.indexOf(obj);\r\n\r\n        if (index !== - 1) {\r\n            this._children.splice(index, 1);\r\n        }\r\n        this._scene.removeMesh(obj.object);\r\n    }\r\n\r\n    public setCamera(camera: Camera): void {\r\n        this._camera = camera;\r\n    }\r\n\r\n    public getCamera(): Camera {\r\n        return this._camera;\r\n    }\r\n\r\n    public getObjectByName(name: string): Mesh | undefined {\r\n        for (let i = 0; i < this._children.length; ++i) {\r\n            const child = this._children[i];\r\n\r\n            if (child.name === name) {\r\n                return child;\r\n            }\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n\r\n}\r\n","import {\r\n    Buffer,\r\n    Camera as BCamera,\r\n    Engine,\r\n    Mesh as BMesh,\r\n    MultiMaterial,\r\n    Quaternion,\r\n    Scene as BScene,\r\n    SubMesh,\r\n    Texture,\r\n    UniversalCamera,\r\n    Vector3, Vector4,\r\n    VertexData,\r\n    ShaderMaterial,\r\n} from 'babylonjs';\r\n\r\nimport { TextureList } from \"../../src/Proxy/IScene\";\r\n\r\nimport Camera from \"./Camera\";\r\nimport Mesh from \"./Mesh\";\r\nimport Scene  from \"./Scene\";\r\nimport { ShaderManager } from \"./ShaderManager\";\r\n\r\nexport default class SceneParser {\r\n\r\n    private json: any;\r\n    private engine: Engine;\r\n    private textures: TextureList;\r\n    private textureMap: {\r\n        [name: string] : Texture\r\n    };\r\n    private shdMgr: ShaderManager;\r\n    private _numTextureLoadedNotifications: number;\r\n    private _numMeshesToHandle = 0;\r\n\r\n    private scene: BScene;\r\n    private tscene: Scene;\r\n\r\n    constructor(engine: Engine, shdMgr: ShaderManager) {\r\n        this.engine = engine;\r\n        this.shdMgr = shdMgr;\r\n\r\n        this.scene = new BScene(engine);\r\n        this.scene.useRightHandedSystem = true;\r\n        this.scene.autoClear = false;\r\n\r\n        this.textures = [];\r\n        this.tscene = new Scene(this.scene, this.textures);\r\n        this.textureMap = {};\r\n        this._numTextureLoadedNotifications = 0;\r\n        this._numMeshesToHandle = 0;\r\n    }\r\n\r\n    public parse(json: any, onLoad: any): void {\r\n        this.json = json;\r\n\r\n        this.createScene();\r\n\r\n        //this.scene.debugLayer.show({ embedMode: false, handleResize: false, overlay: true, showExplorer: true, showInspector: true });\r\n\r\n        this.scene.getBoundingBoxRenderer().showBackLines = false;\r\n\r\n        // wait all textures are loaded before going on\r\n        // we need to have the width/height properties of the texture uniforms to be set before going on, because\r\n        // we need them later on (when cloning materials - those properties must have valid values and not be undefined)\r\n        const idTimer = setInterval(() => {\r\n            if (this._numTextureLoadedNotifications == 0 && this._numMeshesToHandle == 0) {\r\n                clearInterval(idTimer);\r\n                this.scene.detachControl();\r\n                onLoad(this.tscene);\r\n            }\r\n        }, 0);\r\n    }\r\n\r\n    private createScene(): void {\r\n        this.createTextures();\r\n\r\n        const objects = this.json.object.children;\r\n        for (let o = 0; o < objects.length; ++o) {\r\n            const object = objects[o];\r\n\r\n            switch (object.type) {\r\n                case \"PerspectiveCamera\":\r\n                    this.createCamera(object);\r\n                    break;\r\n\r\n                case \"Mesh\":\r\n                    this.createMesh(object);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    private createCamera(json: any): void {\r\n        const camera = new UniversalCamera(json.name, new Vector3(...(json.position as Array<number>)), this.tscene.object);\r\n\r\n        camera.rotationQuaternion = new Quaternion(...(json.quaternion as []));\r\n        camera.fov = (json.fov * Math.PI) / 180.0;\r\n        camera.minZ = json.near;\r\n        camera.maxZ = json.far;\r\n        camera.mode = BCamera.PERSPECTIVE_CAMERA;\r\n\r\n        camera.inputs.clear();\r\n        camera.inputs.removeMouse();\r\n\r\n        this.scene.setActiveCameraByName(json.name);\r\n\r\n        this.tscene.setCamera(new Camera(camera));\r\n    }\r\n\r\n    private createTextures(): void {\r\n        const noInterpolation = document.location.href ? document.location.href.indexOf(\"nobilinear\") !== -1 : false;\r\n        for (let t = 0; t < this.json.textures.length; ++t) {\r\n            const texture = this.json.textures[t],\r\n                  image = this.getImage(texture.image),\r\n                  tex = new Texture(\r\n                    \"data:\" + texture.uuid,\r\n                    this.scene,\r\n                    noInterpolation,\r\n                    false,\r\n                    noInterpolation ? Texture.NEAREST_SAMPLINGMODE : Texture.TRILINEAR_SAMPLINGMODE,\r\n                    null, null,\r\n                    image.url\r\n                  );\r\n\r\n            tex.wrapU = tex.wrapV = Texture.CLAMP_ADDRESSMODE;\r\n            tex.hasAlpha = true;\r\n\r\n            this.textures.push(tex);\r\n            this.textureMap[texture.uuid] = tex;\r\n        }\r\n    }\r\n\r\n    private createMesh(json: any): void {\r\n        const mesh = new BMesh(json.name, this.tscene.object),\r\n              geometry = this.getGeometry(json.geometry),\r\n              attr = geometry.data.attributes,\r\n              groups = geometry.data.groups,\r\n              materials = json.material;\r\n\r\n        mesh.position.set((json.position as Array<number>)[0], (json.position as Array<number>)[1], (json.position as Array<number>)[2]);\r\n        mesh.rotationQuaternion = new Quaternion((json.quaternion as Array<number>)[0], (json.quaternion as Array<number>)[1], (json.quaternion as Array<number>)[2], (json.quaternion as Array<number>)[3]);\r\n        mesh.useVertexColors = false;\r\n        mesh.showBoundingBox = false;\r\n\r\n        const vDat = new VertexData();\r\n\r\n        vDat.positions = Array.from(attr.position.array);\r\n        vDat.normals = Array.from(attr.normal.array);\r\n        vDat.uvs = Array.from(attr.uv.array);\r\n\r\n        vDat.indices = Array.from(geometry.data.index.array);\r\n\r\n        for (let i = 0; i < vDat.indices.length; i += 3) {\r\n            const i0 = vDat.indices[i];\r\n            vDat.indices[i] = vDat.indices[i + 2];\r\n            vDat.indices[i + 2] = i0;\r\n        }\r\n\r\n        vDat.applyToMesh(mesh);\r\n\r\n        mesh.subMeshes = [];\r\n\r\n        let attributes = [\"position\", \"uv\", \"normal\"];\r\n\r\n        ['vertColor', '_flags', 'skinIndex', 'skinWeight'].forEach((attrName) => {\r\n            if (attr[attrName]) {\r\n                const buffer = new Buffer(this.engine, Array.from(attr[attrName].array), false, attr[attrName].itemSize);\r\n                mesh.setVerticesBuffer(buffer.createVertexBuffer(attrName, 0, attr[attrName].itemSize));\r\n                attributes.push(attrName);\r\n            }\r\n        });\r\n\r\n        const multimat = new MultiMaterial(json.name, this.scene),\r\n                totalVertices = mesh.getTotalVertices(),\r\n                promises: Array<Promise<void>> = [];\r\n\r\n        for (let m = 0; m < materials.length; ++m) {\r\n            const material = this.getMaterial(materials[m]);\r\n\r\n            const doShaderMat = ((mat: any) => {\r\n                const material = mat;\r\n\r\n                return (shdCode: Array<any>) => {\r\n                    let uniformsUsed = new Set<string>();\r\n\r\n                    this.shdMgr.getVertexUniforms(material.vertexShader)!.forEach((u) => uniformsUsed.add(u));\r\n                    this.shdMgr.getFragmentUniforms(material.fragmentShader)!.forEach((u) => uniformsUsed.add(u));\r\n\r\n                    let uniforms = Array.from<string>(uniformsUsed);\r\n                    let samplers = [\"map\", \"mapBump\"];\r\n\r\n                    for (const uname in material.uniforms) {\r\n                        uniforms.push(uname);\r\n                    }\r\n\r\n                    const shd = new ShaderMaterial(material.uuid, this.scene, {\r\n                        \"vertex\":   shdCode[0],\r\n                        \"fragment\": shdCode[1],\r\n                    }, {\r\n                        attributes: attributes,\r\n                        samplers: samplers,\r\n                        uniforms: uniforms,\r\n                        needAlphaBlending: material.transparent,\r\n                    });\r\n\r\n                    for (const uname in material.uniforms) {\r\n                        const uval = material.uniforms[uname];\r\n                        switch (uval.type) {\r\n                            case 't':\r\n                                shd.setTexture(uname, this.textureMap[uval.value]);\r\n                                if (!this.textureMap[uval.value].isReady()) {\r\n                                    this._numTextureLoadedNotifications++;\r\n                                    this.textureMap[uval.value].onLoadObservable.add((texture: Texture) => {\r\n                                        uval.width = texture.getSize().width;\r\n                                        uval.height = texture.getSize().height;\r\n                                        this._numTextureLoadedNotifications--;\r\n                                    });\r\n                                } else {\r\n                                    uval.width = this.textureMap[uval.value].getSize().width;\r\n                                    uval.height = this.textureMap[uval.value].getSize().height;\r\n                                }\r\n                                uval.value = this.textureMap[uval.value];\r\n                                break;\r\n                            case 'i':\r\n                                shd.setInt(uname, uval.value);\r\n                                break;\r\n                            case 'f':\r\n                                shd.setFloat(uname, uval.value);\r\n                                break;\r\n                            case 'f3':\r\n                                shd.setVector3(uname, new Vector3((uval.value as Array<number>)[0], (uval.value as Array<number>)[1], (uval.value as Array<number>)[2]));\r\n                                break;\r\n                            case 'f4':\r\n                                shd.setVector4(uname, new Vector4((uval.value as Array<number>)[0], (uval.value as Array<number>)[1], (uval.value as Array<number>)[2], (uval.value as Array<number>)[3]));\r\n                                break;\r\n                        }\r\n                    }\r\n\r\n                    shd.metadata = {\r\n                        \"uniforms\": material.uniforms,\r\n                        \"userData\": material.userData,\r\n                    };\r\n\r\n                    if (material.transparent) {\r\n                        shd.alphaMode = Engine.ALPHA_SCREENMODE;\r\n                        shd.disableDepthWrite = true;\r\n                    }\r\n\r\n                    multimat.subMaterials.push(shd);\r\n\r\n                    SubMesh.AddToMesh(multimat.subMaterials.length - 1, 0, totalVertices, groups[m].start, groups[m].count, mesh);\r\n                };\r\n            })(material);\r\n\r\n            promises.push(\r\n                Promise.all([this.shdMgr.getVertexShader(material.vertexShader), this.shdMgr.getFragmentShader(material.fragmentShader)]).then((shdCode) => doShaderMat(shdCode))\r\n            );\r\n        }\r\n\r\n        this._numMeshesToHandle++;\r\n\r\n        Promise.all(promises).then(() => {\r\n            mesh.material = multimat;\r\n\r\n            this.tscene.add(new Mesh(mesh));\r\n\r\n            this._numMeshesToHandle--;\r\n        });\r\n    }\r\n\r\n    private getImage(id: string): any {\r\n        for (let i = 0; i < this.json.images.length; ++i) {\r\n            const image = this.json.images[i];\r\n\r\n            if (image.uuid == id) { return image; }\r\n        }\r\n    }\r\n\r\n    private getGeometry(id: string): any {\r\n        for (let g = 0; g < this.json.geometries.length; ++g) {\r\n            const geometry = this.json.geometries[g];\r\n\r\n            if (geometry.uuid == id) { return geometry; }\r\n        }\r\n    }\r\n\r\n    private getMaterial(id: string): any {\r\n        for (let g = 0; g < this.json.materials.length; ++g) {\r\n            const material = this.json.materials[g];\r\n\r\n            if (material.uuid == id) { return material; }\r\n        }\r\n    }\r\n\r\n}\r\n","import {\r\n    Effect\r\n} from \"babylonjs\";\r\n\r\n/*\r\n  Stolen from GLTF v1.0 loader\r\n*/\r\nenum ETokenType {\r\n    IDENTIFIER = 1,\r\n\r\n    UNKNOWN = 2,\r\n    END_OF_INPUT = 3\r\n}\r\n\r\nclass Tokenizer {\r\n    private _toParse: string;\r\n    private _pos: number = 0;\r\n    private _maxPos: number;\r\n\r\n    public currentToken: ETokenType = ETokenType.UNKNOWN;\r\n    public currentIdentifier: string = \"\";\r\n    public currentString: string = \"\";\r\n    public isLetterOrDigitPattern: RegExp = /^[a-zA-Z0-9]+$/;\r\n\r\n    constructor(toParse: string) {\r\n        this._toParse = toParse;\r\n        this._maxPos = toParse.length;\r\n    }\r\n\r\n    public getNextToken(): ETokenType {\r\n        if (this.isEnd()) { return ETokenType.END_OF_INPUT; }\r\n\r\n        this.currentString = this.read();\r\n        this.currentToken = ETokenType.UNKNOWN;\r\n\r\n        if (this.currentString === \"_\" || this.isLetterOrDigitPattern.test(this.currentString)) {\r\n            this.currentToken = ETokenType.IDENTIFIER;\r\n            this.currentIdentifier = this.currentString;\r\n            while (!this.isEnd() && (this.isLetterOrDigitPattern.test(this.currentString = this.peek()) || this.currentString === \"_\")) {\r\n                this.currentIdentifier += this.currentString;\r\n                this.forward();\r\n            }\r\n        }\r\n\r\n        return this.currentToken;\r\n    }\r\n\r\n    public peek(): string {\r\n        return this._toParse[this._pos];\r\n    }\r\n\r\n    public read(): string {\r\n        return this._toParse[this._pos++];\r\n    }\r\n\r\n    public forward(): void {\r\n        this._pos++;\r\n    }\r\n\r\n    public isEnd(): boolean {\r\n        return this._pos >= this._maxPos;\r\n    }\r\n}\r\n\r\nconst tokenSource = [\"modelMatrix\", \"modelViewMatrix\",  \"projectionMatrix\", \"viewMatrix\",   \"normalMatrix\", \"cameraPosition\"],\r\n      tokenDest =   [\"world\",       \"worldView\",        \"projection\",       \"view\",         null,           null];\r\n\r\nexport default class Shader {\r\n\r\n    public static getShader(shaderType: string, name: string, code: string, uniformsUsed: Set<string>): string {\r\n        code = Shader.parseShader(code, uniformsUsed);\r\n\r\n        Effect.ShadersStore[`${name}${shaderType}Shader`] = code;\r\n\r\n        return name;\r\n    }\r\n\r\n    protected static parseShader(code: string, uniformsUsed: Set<string>): string {\r\n        let tokenizer = new Tokenizer(code),\r\n            newcode = \"\";\r\n\r\n        while (!tokenizer.isEnd() && tokenizer.getNextToken()) {\r\n            let tokenType = tokenizer.currentToken;\r\n\r\n            if (tokenType !== ETokenType.IDENTIFIER) {\r\n                newcode += tokenizer.currentString;\r\n                continue;\r\n            }\r\n\r\n            const [token, remapped] = Shader.parseShaderTokens(tokenizer);\r\n            if (token == null) {\r\n                console.log(code);\r\n                throw `Can't parse shader because the token \"${tokenizer.currentIdentifier}\" is used in the original shader and can't be mapped!`;\r\n            }\r\n\r\n            if (remapped) {\r\n                uniformsUsed.add(token);\r\n            }\r\n\r\n            newcode += token;\r\n        }\r\n\r\n        return newcode;\r\n    }\r\n\r\n    protected static parseShaderTokens(tokenizer: Tokenizer): [string | null, boolean] {\r\n        for (let i = 0; i < tokenSource.length; ++i) {\r\n            const tokenSrc = tokenSource[i];\r\n\r\n            if (tokenizer.currentIdentifier === tokenSrc) {\r\n                return [tokenDest[i], true];\r\n            }\r\n        }\r\n\r\n        return [tokenizer.currentIdentifier, false];\r\n    }\r\n\r\n}\r\n","import {\r\n    shaderType,\r\n    ShaderManager as ShaderManagerBase\r\n} from \"../../src/ShaderManager\";\r\n\r\nimport Shader from \"./Shader\";\r\n\r\nexport class ShaderManager extends ShaderManagerBase {\r\n\r\n    protected _uniforms: Map<string, Set<string>>;\r\n\r\n    constructor(dirPath?: string) {\r\n        super(dirPath);\r\n\r\n        this._uniforms = new Map();\r\n    }\r\n\r\n    public getShader(ptype: shaderType, name: string, forceReload: boolean = false): Promise<string> {\r\n        return this._getFile2(name, ptype, forceReload);\r\n    }\r\n\r\n    public getVertexShader(name: string, forceReload: boolean = false): Promise<string> {\r\n        return this.getShader(shaderType.vertex, name, forceReload);\r\n    }\r\n\r\n    public getFragmentShader(name: string, forceReload: boolean = false): Promise<string> {\r\n        return this.getShader(shaderType.fragment, name, forceReload);\r\n    }\r\n\r\n    public getUniforms(name: string): Set<string> | undefined {\r\n        return this._uniforms.get(name);\r\n    }\r\n\r\n    public getVertexUniforms(name: string): Set<string> | undefined {\r\n        return this.getUniforms(name + '.vs');\r\n    }\r\n\r\n    public getFragmentUniforms(name: string): Set<string> | undefined {\r\n        return this.getUniforms(name + '.fs');\r\n    }\r\n\r\n    protected _getFile2(fname: string, ptype: string, forceReload: boolean = false): Promise<string> {\r\n        const promiseCode = this._getFile(fname + (ptype == shaderType.vertex ? '.vs' : '.fs'), forceReload);\r\n\r\n        return promiseCode.then((code) => {\r\n            if (code === \"\") {\r\n                throw `Can't load shader \"${fname}\"!`;\r\n            }\r\n\r\n            const uniformsUsed = new Set<string>();\r\n\r\n            this._uniforms.set(fname + (ptype == shaderType.vertex ? '.vs' : '.fs'), uniformsUsed);\r\n\r\n            return Shader.getShader(ptype == 'vertex' ? 'Vertex' : 'Fragment', fname, code, uniformsUsed);\r\n        });\r\n    }\r\n\r\n}\r\n","import {\r\n    Engine as BEngine\r\n} from \"babylonjs\";\r\n\r\nimport Browser from \"../../src/Utils/Browser\";\r\nimport Engine from \"../../src/Proxy/Engine\";\r\nimport { IMesh } from \"../../src/Proxy/IMesh\";\r\nimport { IScene } from \"../../src/Proxy/IScene\";\r\nimport { ShaderManager } from \"./ShaderManager\";\r\nimport \"../../src/Main\";\r\n\r\nimport \"./Behaviours\";\r\nimport Mesh from \"./Mesh\";\r\nimport MeshBuilder from \"./MeshBuilder\";\r\nimport Node from \"./Node\";\r\nimport Renderer from \"./Renderer\";\r\nimport Scene from \"./Scene\";\r\nimport SceneParser from \"./SceneParser\";\r\n\r\ndeclare var glMatrix: any;\r\n\r\nconst relPath = Browser.QueryString.relpath || \"\";\r\n\r\nglMatrix.glMatrix.setMatrixArrayType(Array);\r\n\r\nconst canvas = document.createElement(\"canvas\"),\r\n      engine = new BEngine(canvas, true),\r\n      shdMgr = new ShaderManager(relPath + \"resources/shader/\");\r\n\r\nEngine.registerFunctions({\r\n    \"makeNode\":         (name?: string, scene?: IScene) => new Node(undefined, name, scene as Scene),\r\n\r\n    \"makeMeshBuilder\":  (mesh?: IMesh) => new MeshBuilder(mesh as Mesh),\r\n\r\n    \"parseScene\":       (sceneJSON: any) => {\r\n        const sceneParser = new SceneParser(engine, shdMgr);\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            sceneParser.parse(sceneJSON, resolve);\r\n        });\r\n    },\r\n\r\n    \"createRenderer\":   (container: Element) => {\r\n        return new Renderer(container, engine, canvas);\r\n    },\r\n\r\n    \"getShaderMgr\":     shdMgr,\r\n});\r\n","module.exports = BABYLON;","module.exports = jQuery;","module.exports = pako;"],"sourceRoot":""}